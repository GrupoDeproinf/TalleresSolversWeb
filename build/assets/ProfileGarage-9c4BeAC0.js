import{r as d,j as e,a8 as G,a9 as S,aa as J,ag as M,ap as qe,b2 as Io,ak as we,al as ze,am as Ke,an as ie,af as ae,ab as ve,a7 as Se,aj as Ue,a4 as Mo,u as To,ai as $o,ar as Fo}from"./index-zN_cMCXj.js";import{C as Bo,a as Uo}from"./Views-zD_Q7SBY.js";import{S as qo}from"./Switcher-4MWLvk2m.js";import{C as so}from"./Card-q0IeE3mQ.js";import{A as ro}from"./index-02QlkbFi.js";import{B as oe}from"./Button-3FDHFgBt.js";import{C as zo}from"./ConfirmDialog-m2tgk5nn.js";import{g as Ge,r as Ko,t as Go,x as Vo,y as Ho,z as Zo,d as Yo}from"./index.esm-bWNlESX5.js";import{T as Jo}from"./Tag-toDJOizo.js";import{ap as Wo,aq as Me,ar as no}from"./index.esm-Wztopsom.js";import{T as je}from"./index-8X2bHxJW.js";import"./Alert-RCS_j8Jh.js";import"./Badge-9tl8JQTX.js";import"./Calendar-OuGpzHgm.js";import{C as Qo}from"./index-WQvklOV4.js";import"./index-jkLjkv_P.js";import{D as mo}from"./Dialog-1b1ZmvQp.js";import{D as uo}from"./Drawer-smR0oFTt.js";import"./index-mBZpBLg-.js";import"./FormItem-ICPPA40p.js";import{I as ue}from"./Input-jjp4yHHW.js";import"./index-9lzrYVOC.js";import"./index-c61_IZYQ.js";import"./index-_o3pW7qI.js";import{N as j,t as N}from"./toast-p8-f9YQ7.js";import{P as io}from"./index-AkutX9-I.js";import"./Progress-HwJSJDzI.js";import"./index-zMdeW30y.js";import"./RangeCalendar-OFOPYy0W.js";import"./ScrollBar-G4G1NroS.js";import"./index-NS5azrki.js";import{d as Xo}from"./Select-4SC7uILG.js";import"./Skeleton-P-MbthP2.js";import"./index-O-xYLnH7.js";import{T as lo}from"./index-7JRp9AGt.js";import"./index-IgZFdhVY.js";import"./index-IAII7dkR.js";import"./Tooltip-TmV83Zem.js";import"./Upload-cFvKTIJX.js";import{u as Te,f as ne,g as $e,a as Fe,b as Be}from"./index-aN5JZksr.js";import{R as ea}from"./index.esm-WB-rVmQg.js";import{M as oa}from"./index.esm-5TAcd9rj.js";import{S as aa}from"./index.esm-nXIEcN5R.js";import{F as go,a as po,b as D,E as O}from"./formik.esm-hG2JlA3_.js";import{c as le,g as Ne,h as ye,a as L}from"./index.esm-vNOAKB65.js";import{G as ho,M as xo}from"./esm-OI8YY8oD.js";import"./useMergeRef-Rt_Crb27.js";import"./context-4K_It7vM.js";import"./useTimeout-8oqMHoCd.js";import"./CloseButton-thKRAv7B.js";import"./StatusIcon-a1AXeHOG.js";import"./motion-TPlYCOYk.js";import"./useControllableState-PxgKeL3k.js";import"./cloneDeep-hY89VSV4.js";import"./_getAllKeys-josaXZHF.js";import"./_MapCache-mUj7I7Ze.js";import"./_baseIsEqual-RVGWXmEX.js";import"./get-wdqsSC5n.js";import"./toString-3FE3Yt23.js";import"./floating-ui.react-NPg6DBrp.js";import"./floating-ui.dom-0rLBacrf.js";import"./TimeInput-HivJa-Be.js";import"./useUniqueId-mGBrdPHP.js";import"./useDidUpdate-o2_MgW7H.js";import"./index-tw4ez8WU.js";import"./index-Aw7A1Eb2.js";import"./useRootClose-5KdsbEvo.js";import"./isNil-MbCIHf64.js";import"./index-e95nRWq5.js";import"./chainedFunction-ltcSYACe.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./mapCloneElement-xjFPQt8o.js";import"./index.esm-qF4ozkmo.js";import"./index.esm-s1RJSjz7.js";const co=[{codigo:"0102",nombre:"BANCO DE VENEZUELA"},{codigo:"0156",nombre:"100% BANCO"},{codigo:"0172",nombre:"BANCAMIGA BANCO MICROFINANCIERO C A"},{codigo:"0114",nombre:"BANCARIBE"},{codigo:"0171",nombre:"BANCO ACTIVO"},{codigo:"0166",nombre:"BANCO AGRICOLA DE VENEZUELA"},{codigo:"0175",nombre:"BANCO BICENTENARIO DEL PUEBLO"},{codigo:"0128",nombre:"BANCO CARONI"},{codigo:"0163",nombre:"BANCO DEL TESORO"},{codigo:"0115",nombre:"BANCO EXTERIOR"},{codigo:"0151",nombre:"BANCO FONDO COMUN"},{codigo:"0173",nombre:"BANCO INTERNACIONAL DE DESARROLLO"},{codigo:"0105",nombre:"BANCO MERCANTIL"},{codigo:"0191",nombre:"BANCO NACIONAL DE CREDITO"},{codigo:"0138",nombre:"BANCO PLAZA"},{codigo:"0137",nombre:"BANCO SOFITASA"},{codigo:"0104",nombre:"BANCO VENEZOLANO DE CREDITO"},{codigo:"0168",nombre:"BANCRECER"},{codigo:"0134",nombre:"BANESCO"},{codigo:"0177",nombre:"BANFANB"},{codigo:"0146",nombre:"BANGENTE"},{codigo:"0174",nombre:"BANPLUS"},{codigo:"0108",nombre:"BBVA PROVINCIAL"},{codigo:"0157",nombre:"DELSUR BANCO UNIVERSAL"},{codigo:"0169",nombre:"MI BANCO"},{codigo:"0178",nombre:"N58 BANCO DIGITAL BANCO MICROFINANCIERO S A"}],ta=({subscriptionId:r,talleruid:v})=>{const[s,k]=d.useState("Efectivo"),[C,T]=d.useState([]),[te,E]=d.useState(!1),[U,V]=d.useState(!1),[ce,$]=d.useState(!1),[R,I]=d.useState(!1);d.useEffect(()=>{(async()=>{const p=G(S,"MetodosPago"),_=(await J(p)).docs.map(x=>x.data());T(_.filter(x=>x.status))})()},[]),d.useEffect(()=>{(async()=>{if(v)try{const p=M(S,"Usuarios",v),m=await qe(p);if(m.exists()){const x=m.data().subscripcion_actual;x&&x.pago_reportado===!0&&$(!0)}}catch(p){console.error("Error al verificar si ya se reportó el pago:",p)}})()},[v]);const W=c=>{k(c)},Q=()=>{ce?I(!0):V(!0)},u=le().shape({monto:Ne().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),fechaPago:ye().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),de=le().shape({monto:Ne().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),numReferencia:L().required("El número de referencia es obligatorio"),bancoDestino:L().required("Selecciona un banco de destino"),bancoOrigen:L().required("Selecciona un banco de origen"),fechaPago:ye().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),se=le().shape({monto:Ne().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),numReferencia:L().required("El número de referencia es obligatorio"),telefono:L().required("El teléfono es obligatorio").matches(/^[1-9]\d*$/,"El teléfono no puede comenzar con 0 y debe contener solo números"),bancoDestino:L().required("Selecciona un banco de destino"),bancoOrigen:L().required("Selecciona un banco de origen"),fechaPago:ye().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),g=le().shape({monto:Ne().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),correo:L().email("El correo no es válido").required("El correo Zelle es obligatorio"),fechaPago:ye().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),n=le().shape({...s==="Efectivo"&&u.fields,...s==="Transferencia"&&de.fields,...s==="Pago Móvil"&&se.fields,...s==="Zelle"&&g.fields}),h={metodoPago:"",monto:"",numReferencia:"",telefono:"",correo:"",cedula:"",bancoOrigen:"",bancoDestino:"",fechaPago:"",newLogoFile:null},y=async(c,p)=>{try{const m=G(S,"Subscripciones"),_=await J(m),x=new Date(c.fechaPago),q=`${x.getFullYear()}-${String(x.getMonth()+1).padStart(2,"0")}-${String(x.getDate()).padStart(2,"0")}`;for(const X of _.docs){const F=X.data().comprobante_pago;if(F&&F.fechaPago){const A=F.fechaPago.toDate();if(`${A.getFullYear()}-${String(A.getMonth()+1).padStart(2,"0")}-${String(A.getDate()).padStart(2,"0")}`===q){if((p==="Pago Móvil"||p==="Transferencia")&&F.numReferencia===c.numReferencia)return{isDuplicate:!0,message:`Ya existe un pago con el número de referencia ${c.numReferencia} en la fecha ${q}`};if(p==="Zelle"&&F.correo===c.correo)return{isDuplicate:!0,message:`Ya existe un pago con el correo ${c.correo} en la fecha ${q}`};if(p==="Efectivo"&&F.monto===parseFloat(c.monto))return{isDuplicate:!0,message:`Ya existe un pago en efectivo por el monto $${c.monto} en la fecha ${q}`}}}}return{isDuplicate:!1,message:""}}catch(m){return console.error("Error al validar duplicidad:",m),{isDuplicate:!1,message:""}}},P=async c=>{if(!r){console.error("Error: subscriptionId no está definido");return}E(!0);try{const p=await y(c,s);if(p.isDuplicate){N.push(e.jsx(j,{title:"Error",type:"danger",children:p.message})),E(!1);return}let m="";if(c.newLogoFile&&s&&v){const X=Io(),z=new Date().toISOString(),F=`${s}_${v}_${z}.jpg`,A=c.newLogoFile,K=we(X,`paymentcommitment/${F}`),Ce=await ze(K,A);m=await Ke(Ce.ref)}const _=c.fechaPago?ie.fromDate(new Date(c.fechaPago)):null,x={metodo:s,monto:c.monto,fechaPago:_,comprobante:m};s==="Transferencia"&&(x.numReferencia=c.numReferencia??"",x.cedula=c.cedula??"",x.bancoOrigen=c.bancoOrigen??"",x.bancoDestino=c.bancoDestino??""),s==="Pago Móvil"&&(x.cedula=c.cedula,x.telefono=c.telefono,x.bancoOrigen=c.bancoOrigen,x.bancoDestino=c.bancoDestino),s==="Zelle"&&(x.correo=c.correo??"",x.numReferencia=c.numReferencia),console.log(x);const q=M(S,"Subscripciones",r);if(await ae(q,{comprobante_pago:x}),v){const X=M(S,"Usuarios",v);await ae(X,{"subscripcion_actual.pago_reportado":!0}),$(!0)}console.log("Pago registrado exitosamente"),N.push(e.jsx(j,{title:"Éxito",type:"success",children:"Se ha registrado el pago correctamente."}))}catch(p){console.error("Error al registrar el pago:",p),N.push(e.jsx(j,{title:"Error",children:"Ocurrió un problema al registrar el pago."}))}finally{E(!1),V(!1)}},i=C.find(c=>c.tipo_pago===s);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:Q,className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Reportar Pago"}),e.jsx(mo,{isOpen:R,onClose:()=>I(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Pago Ya Reportado"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Ya se ha reportado un pago para esta suscripción. No se puede reportar otro pago."}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>I(!1),className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Entendido"})})]})}),e.jsx(uo,{isOpen:U,onClose:()=>V(!1),title:"Registrar Pago",children:e.jsx(go,{initialValues:h,onSubmit:P,validationSchema:n,validateOnBlur:!0,validateOnChange:!1,children:({setFieldValue:c,values:p})=>e.jsxs(po,{className:"flex flex-col gap-4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Selecciona el Método de Pago"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mb-4",children:C==null?void 0:C.map(m=>e.jsx("button",{type:"button",onClick:()=>W(m.tipo_pago),className:`text-sm py-2 px-4 rounded-md ${s===m.tipo_pago?"bg-[#1d1e56] text-white":"bg-gray-200"}`,children:m.tipo_pago},m.tipo_pago))}),s!=="Efectivo"&&i&&e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg mb-4",children:[e.jsx("h5",{className:"font-semibold text-lg",children:"Detalles de la Empresa"}),i.email&&e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",i.email]}),i.num_ref&&e.jsxs("p",{children:[e.jsx("strong",{children:"Número de Referencia:"})," ",i.num_ref]}),i.banco&&e.jsxs("p",{children:[e.jsx("strong",{children:"Banco:"})," ",i.banco]}),i.cedula_rif&&e.jsxs("p",{children:[e.jsx("strong",{children:"Cédula/RIF:"})," ",i.cedula_rif]}),i.cuenta&&e.jsxs("p",{children:[e.jsx("strong",{children:"Cuenta:"})," ",i.cuenta]}),i.status_pago!==void 0&&e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",i.status_pago?"Activo":"Inactivo"]}),i.tipo_cuenta&&e.jsxs("p",{children:[e.jsx("strong",{children:"Tipo de Cuenta:"})," ",i.tipo_cuenta]}),i.telefono&&e.jsxs("p",{children:[e.jsx("strong",{children:"Teléfono:"})," ",i.telefono]}),i.titular&&e.jsxs("p",{children:[e.jsx("strong",{children:"Titular:"})," ",i.titular]})]}),e.jsx(D,{id:"monto",name:"monto",as:ue,placeholder:"Ingresa el monto en $"}),e.jsx(O,{name:"monto",component:"div",className:"text-red-500"}),e.jsx(D,{id:"fechaPago",name:"fechaPago",as:ue,type:"date",placeholder:"Fecha de pago"}),e.jsx(O,{name:"fechaPago",component:"div",className:"text-red-500"}),s==="Pago Móvil"&&e.jsxs(e.Fragment,{children:[e.jsx(D,{id:"telefono",name:"telefono",as:ue,placeholder:"Teléfono",onKeyDown:m=>{m.currentTarget.value===""&&m.key==="0"&&m.preventDefault()},onChange:m=>{const _=m.target.value.replace(/^0+/,"");c("telefono",_)}}),e.jsx(O,{name:"telefono",component:"div",className:"text-red-500"})]}),s==="Zelle"&&e.jsx(D,{id:"correo",name:"correo",as:ue,placeholder:"Correo Zelle"}),["Transferencia","Pago Móvil"].includes(s)&&e.jsxs(e.Fragment,{children:[e.jsx(D,{id:"numReferencia",name:"numReferencia",as:ue,placeholder:"Número de referencia"}),e.jsx(O,{name:"numReferencia",component:"div",className:"text-red-500"})]}),["Transferencia","Pago Móvil"].includes(s)&&e.jsxs(e.Fragment,{children:[e.jsxs(D,{id:"bancoDestino",as:"select",name:"bancoDestino",className:"p-2 rounded-md border border-slate-300",children:[e.jsx("option",{value:"",children:"Selecciona Banco de Destino"}),co.map(m=>e.jsx("option",{value:m.nombre,children:m.nombre},m.codigo))]}),e.jsx(O,{name:"bancoDestino",component:"div",className:"text-red-500"}),e.jsxs(D,{id:"bancoOrigen",as:"select",name:"bancoOrigen",className:"p-2 rounded-md border border-slate-300",children:[e.jsx("option",{value:"",children:"Selecciona Banco de Origen"}),co.map(m=>e.jsx("option",{value:m.nombre,children:m.nombre},m.codigo))]}),e.jsx(O,{name:"bancoOrigen",component:"div",className:"text-red-500"})]}),["Transferencia","Pago Móvil","Zelle"].includes(s)&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10 gap-2",children:e.jsxs("div",{className:"text-center",children:[p.newLogoFile?e.jsx("img",{src:URL.createObjectURL(p.newLogoFile),alt:"Logo",className:"w-32 h-32 object-cover rounded-md"}):e.jsx(Ge,{className:"text-gray-500 text-center text-3xl"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"fileInput",className:"text-sm font-medium text-blue-600 cursor-pointer",children:"Subir Comprobante de Pago"}),e.jsx("input",{id:"fileInput",name:"newLogoFile",type:"file",className:"hidden",accept:"image/*",onChange:m=>{m.target.files&&m.target.files[0]&&c("newLogoFile",m.target.files[0])}})]})]})})}),e.jsx("button",{type:"submit",className:"w-full py-2 mt-4 bg-blue-900 rounded-md hover:bg-blue-700 text-white",children:"Registrar Pago"})]})})})]})},sa=({markers:r,center:v})=>{const[s,k]=d.useState([]);return d.useEffect(()=>{k(r)},[r]),e.jsx("div",{style:{height:"50%",width:"100%"},children:e.jsx(ho,{center:v,zoom:10,mapContainerStyle:{height:"400px",width:"100%",marginTop:"10px"},children:s.map((C,T)=>e.jsx(xo,{position:{lat:C.lat,lng:C.lng}},T))})})},ra=({initialLocation:r,onLocationChange:v})=>{const[s,k]=d.useState(null),[C]=d.useState(17);d.useEffect(()=>{r&&r.lat&&r.lng&&k(r)},[r]);const T=E=>{if(!E.latLng)return;const U={lat:E.latLng.lat(),lng:E.latLng.lng()};k(U),v(U)},te=E=>{if(E.latLng){const U={lat:E.latLng.lat(),lng:E.latLng.lng()};k(U),v(U)}};return e.jsx("div",{style:{height:"450px",width:"100%"},children:e.jsx(ho,{center:s||{lat:0,lng:0},zoom:C,mapContainerStyle:{height:"400px",width:"100%",marginTop:"10px"},onClick:T,children:s&&e.jsx(xo,{position:s,draggable:!0,onDragEnd:te})})})},na=le().shape({nombre_servicio:L().required("El nombre del servicio es requerido"),descripcion:L().required("La descripción es requerida"),uid_categoria:L().required("La categoría es requerida"),precio:L().required("El precio es requerido"),garantia:L().required("La garantía es requerida"),typeService:L().required("El tipo de servicio es requerido")}),ia=({isOpen:r,onClose:v,service:s,onServiceUpdated:k})=>{const[C,T]=d.useState([]),[te,E]=d.useState([]),[U,V]=d.useState([]),[ce,$]=d.useState(!1),[R,I]=d.useState(null),[W,Q]=d.useState(!1);d.useEffect(()=>{(async()=>{var n;if(!(!r||!s)){$(!0);try{const h=Se(G(S,"Categorias"),ve("estatus","==",!0)),P=(await J(h)).docs.map(p=>({id:p.id,...p.data()}));T(P);const i=await qe(M(S,"talleres","talleres"));i.exists()&&V(i.data().talleres||[]);const c={nombre_servicio:(s==null?void 0:s.nombre_servicio)||"",descripcion:(s==null?void 0:s.descripcion)||"",uid_categoria:(s==null?void 0:s.uid_categoria)||"",nombre_categoria:(s==null?void 0:s.nombre_categoria)||"",service_image:(s==null?void 0:s.service_image)||(s==null?void 0:s.imagenes)||[],service_image_files:[],uid_taller:(s==null?void 0:s.uid_taller)||"",taller:(s==null?void 0:s.taller)||"",precio:((n=s==null?void 0:s.precio)==null?void 0:n.toString())||"",garantia:(s==null?void 0:s.garantia)||"",typeService:(s==null?void 0:s.typeService)||"local",subcategoria:(s==null?void 0:s.subcategoria)||[]};I(c),s!=null&&s.uid_categoria&&await u(s.uid_categoria)}catch(h){console.error("Error loading data:",h),N.push(e.jsx(j,{title:"Error",children:"Error al cargar los datos"}))}finally{$(!1)}}})()},[r,s]),d.useEffect(()=>{R!=null&&R.uid_categoria&&C.length>0&&u(R.uid_categoria)},[R==null?void 0:R.uid_categoria,C.length]);const u=async g=>{if(!g){E([]);return}try{const n=Se(G(S,"Categorias",g,"Subcategorias"),ve("estatus","==",!0)),y=(await J(n)).docs.map(P=>({id:P.id,...P.data()}));E(y)}catch(n){console.error("Error loading subcategories:",n),E([])}},de=async(g,n)=>{const h=[];for(let y=0;y<g.length;y++){const P=g[y],i=Date.now(),c=`${n}_${i}_${y}.jpg`,p=we(Ue,`service_images/${c}`);try{await ze(p,P);const m=await Ke(p);h.push(m)}catch(m){throw console.error("Error uploading image:",m),new Error(`Error al subir la imagen ${y+1}`)}}return h},se=async g=>{try{if(!(s!=null&&s.uid_servicio)){N.push(e.jsx(j,{title:"Error",children:"No se pudo identificar el servicio a editar"}));return}Q(!0);let n=[...g.service_image||[]];if(g.service_image_files&&g.service_image_files.length>0)try{const y=await de(g.service_image_files,s.uid_servicio);n=[...n.filter(i=>!i.startsWith("blob:")),...y]}catch(y){console.error("Error uploading images:",y),N.push(e.jsx(j,{title:"Error",children:"Error al subir las imágenes"})),Q(!1);return}else n=n.filter(y=>!y.startsWith("blob:"));const h=M(S,"Servicios",s.uid_servicio);await ae(h,{nombre_servicio:g.nombre_servicio,descripcion:g.descripcion,uid_categoria:g.uid_categoria,nombre_categoria:g.nombre_categoria,precio:g.precio,garantia:g.garantia,typeService:g.typeService,subcategoria:g.subcategoria,service_image:n,uid_taller:s.uid_taller,taller:s.taller,updatedAt:new Date}),N.push(e.jsx(j,{title:"Éxito",children:"Servicio actualizado correctamente"})),k==null||k(),v()}catch(n){console.error("Error updating service:",n),N.push(e.jsx(j,{title:"Error",children:"No se pudo actualizar el servicio"}))}finally{Q(!1)}};return!s||!R?null:e.jsxs(uo,{isOpen:r,onClose:v,className:"rounded-md shadow w-full max-w-2xl",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Editar Servicio"}),ce&&e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),e.jsx(go,{initialValues:R,validationSchema:na,onSubmit:se,enableReinitialize:!0,children:({values:g,handleChange:n,setFieldValue:h,errors:y,touched:P})=>e.jsxs(po,{className:"flex flex-col space-y-6",children:[e.jsx("div",{className:"mt-2 flex flex-col items-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10",children:e.jsxs("div",{className:"text-center",children:[Array.isArray(g.service_image)&&g.service_image.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:g.service_image.map((i,c)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:i,alt:`Imagen del servicio ${c+1}`,className:"h-32 w-full object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:()=>{const p=g.service_image.filter((m,_)=>_!==c);h("service_image",p)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600",children:"×"})]},c))}):e.jsx(Ge,{className:"mx-auto h-12 w-12 text-gray-300","aria-hidden":"true"}),e.jsx("div",{className:"mt-4 flex flex-col text-sm leading-6 text-gray-600 justify-center",children:e.jsxs("label",{htmlFor:"images-upload",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500 flex justify-center items-center",children:[e.jsx("span",{children:"Agregar otra imagen"}),e.jsx("input",{id:"images-upload",name:"images-upload",type:"file",accept:"image/*",multiple:!0,className:"sr-only",onChange:i=>{const c=Array.from(i.target.files||[]),p=c.map(m=>URL.createObjectURL(m));h("service_image",[...g.service_image||[],...p]),h("service_image_files",[...g.service_image_files||[],...c])}})]})})]})}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Nombre Servicio:"}),e.jsx(D,{type:"text",name:"nombre_servicio",value:g.nombre_servicio,onChange:n,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(O,{name:"nombre_servicio",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Tipo de Servicio:"}),e.jsxs("div",{className:"flex items-center space-x-10",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(D,{type:"radio",name:"typeService",value:"local",className:"form-radio"}),e.jsx("span",{children:"En el Local"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(D,{type:"radio",name:"typeService",value:"domicilio",className:"form-radio"}),e.jsx("span",{children:"A Domicilio"})]})]}),e.jsx(O,{name:"typeService",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Categoría:"}),e.jsxs(D,{as:"select",name:"uid_categoria",value:g.uid_categoria,onChange:i=>{const c=i.target.value,p=C.find(m=>m.id===c);h("uid_categoria",c),h("nombre_categoria",(p==null?void 0:p.nombre)||""),h("subcategoria",[]),u(c)},className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"",children:"Seleccione una categoría"}),C.map(i=>e.jsx("option",{value:i.id,children:i.nombre},i.id))]}),e.jsx(O,{name:"uid_categoria",component:"div",className:"text-red-600 text-sm"})]}),e.jsx("label",{className:"font-semibold text-gray-700",children:"Subcategorías:"}),e.jsx(Xo,{isMulti:!0,placeholder:"Selecciona subcategorías",noOptionsMessage:()=>"No hay Subcategorías disponibles",options:g.uid_categoria?te.map(i=>({value:i.id,label:i.nombre})):[],value:Array.isArray(g.subcategoria)?g.subcategoria.map(i=>({value:i.uid_subcategoria||i.id,label:i.nombre_subcategoria||i.nombre})):[],onChange:i=>h("subcategoria",i.map(c=>({uid_subcategoria:c.value,nombre_subcategoria:c.label}))),className:"mt-1"}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Descripción:"}),e.jsx(D,{as:"textarea",name:"descripcion",value:g.descripcion,onChange:n,rows:1,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 resize-none overflow-hidden",style:{maxHeight:"150px",overflowY:"auto"},onInput:i=>{i.target.style.height="auto",i.target.style.height=`${i.target.scrollHeight}px`}}),e.jsx(O,{name:"descripcion",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Precio:"}),e.jsx(D,{type:"text",name:"precio",value:g.precio,onChange:n,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(O,{name:"precio",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Garantía:"}),e.jsx(D,{type:"text",name:"garantia",value:g.garantia,onChange:n,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(O,{name:"garantia",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(oe,{variant:"default",onClick:v,className:"mr-2",disabled:W,children:"Cancelar"}),e.jsx(oe,{type:"submit",style:{backgroundColor:"#000B7E"},className:"text-white hover:opacity-80",disabled:W,children:W?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Guardando..."]}):"Guardar"})]})]})})]})},Pt=()=>{var oo,ao,to;const[r,v]=d.useState(null),[s,k]=d.useState(!1);d.useState(null);const[C,T]=d.useState([]),[te,E]=d.useState([]),[U,V]=d.useState(!0);d.useState(!1);const[ce,$]=d.useState(!1),[R,I]=d.useState(!1),[W,Q]=d.useState(null),[u,de]=d.useState({fecha_fin:ie,fecha_inicio:ie,nombre:"",cantidad_servicios:0,monto:0,status:"",vigencia:"",uid:"",fechaCreacion:ie.fromDate(new Date)}),[se,g]=d.useState([]),[n,h]=d.useState({image_perfil:"",nombre:"",email:"",phone:"",rif:"",status:"",Direccion:"",ubicacion:{lat:0,lng:0},LinkFacebook:"",LinkTiktok:"",LinkInstagram:"",estado:"",whatsapp:"",newLogoFile:null});d.useState(null);const[y,P]=d.useState({pagoMovil:!1,transferencia:!1,puntoVenta:!1,zinli:!1,efectivo:!1,zelle:!1,tarjetaCreditoN:!1,tarjetaCreditoI:!1}),i=location.pathname.substring(location.pathname.lastIndexOf("/")+1),c=Mo(),p=To(o=>o.auth.user.authority),m=p==null?void 0:p.includes("Admin"),_=async()=>{V(!0);try{const o=M(S,"Usuarios",i),t=(await qe(o)).data()||null,b=(t==null?void 0:t.metodos_pago)||{};P(w=>({...w,...b}));const f=(t==null?void 0:t.subscripcion_actual)||null;k(!!f);const ee=Se(G(S,"Subscripciones"),ve("taller_uid","==",i)),fe=(await J(ee)).docs.map(w=>{const l=w.data();return{uid:w.id,nombre:l.nombre||"",monto:l.monto||"0",vigencia:l.vigencia||"",status:l.status||"",cantidad_servicios:l.cantidad_servicios||0,fecha_fin:l.fecha_fin||"no hay fecha",fecha_inicio:l.fecha_inicio||"no hay fecha",taller_uid:l.taller_uid||"",fechaCreacion:ie.fromDate(new Date)}}),Y=Se(G(S,"Servicios"),ve("uid_taller","==",i)),Ae=(await J(Y)).docs.map(w=>{const l=w.data();return{uid_servicio:w.id,nombre_servicio:(l==null?void 0:l.nombre_servicio)||"",descripcion:(l==null?void 0:l.descripcion)||"",precio:(l==null?void 0:l.precio)||"0",estatus:l==null?void 0:l.estatus,taller:(l==null?void 0:l.taller)||"",puntuacion:(l==null?void 0:l.puntuacion)||"0",uid_taller:(l==null?void 0:l.uid_taller)||"",uid_categoria:(l==null?void 0:l.uid_categoria)||"",nombre_categoria:(l==null?void 0:l.nombre_categoria)||"",subcategoria:(l==null?void 0:l.subcategoria)||[],garantia:(l==null?void 0:l.garantia)||"",typeService:(l==null?void 0:l.typeService)||"local",service_image:(l==null?void 0:l.service_image)||(l==null?void 0:l.imagenes)||[]}}),Ie=(await J(G(S,"Planes"))).docs.map(w=>({uid:w.id,nombre:w.data().nombre||"",descripcion:w.data().descripcion||"",monto:w.data().monto||0,status:w.data().status||"",vigencia:w.data().vigencia||"",cantidad_servicios:w.data().cantidad_servicios||0}));v(t),T(Ae),E(Ie),de(f),g(fe);const be=f==null?void 0:f.fecha_fin;if(be){const w=x(be);console.log("aqui la vigencia w",w),Q(w)}h({nombre:(t==null?void 0:t.nombre)??"",image_perfil:(t==null?void 0:t.image_perfil)??"",email:(t==null?void 0:t.email)??"",phone:(t==null?void 0:t.phone)??"",rif:(t==null?void 0:t.rif)??"",status:(t==null?void 0:t.status)??"",Direccion:(t==null?void 0:t.Direccion)??"",LinkFacebook:(t==null?void 0:t.LinkFacebook)??"",LinkInstagram:(t==null?void 0:t.LinkInstagram)??"",LinkTiktok:(t==null?void 0:t.LinkTiktok)??"",whatsapp:(t==null?void 0:t.whatsapp)??"",estado:(t==null?void 0:t.estado)??"",ubicacion:t!=null&&t.ubicacion?{lat:t.ubicacion.lat,lng:t.ubicacion.lng}:{lat:0,lng:0},newLogoFile:(t==null?void 0:t.newLogoFile)??null})}catch(o){console.error("Error al obtener los datos del cliente:",o),N.push(e.jsx(j,{title:"Error",children:"Ocurrio un error al cargar los datos del cliente."}))}finally{V(!1)}};d.useEffect(()=>{_()},[]);const x=o=>{const a=Math.floor(Date.now()/1e3),b=o.seconds-a;return Math.ceil(b/(60*60*24))},q=o=>{const a=new Date(o.seconds*1e3),t=String(a.getDate()).padStart(2,"0"),b=String(a.getMonth()+1).padStart(2,"0"),f=a.getFullYear();return`${t}/${b}/${f}`},X=async o=>{try{const a=M(S,"Usuarios",i),t=M(G(S,"Subscripciones"));await $o(t,{uid:t.id,nombre:o.nombre,monto:o.monto,vigencia:o.vigencia,cantidad_servicios:o.cantidad_servicios,status:"Por Aprobar",taller_uid:i,fechaCreacion:ie.fromDate(new Date)}),await ae(a,{subscripcion_actual:{uid:t.id,nombre:o.nombre,monto:o.monto,vigencia:o.vigencia,cantidad_servicios:o.cantidad_servicios,status:"Por Aprobar"}}),k(!0),await _(),Ve(),console.log("Subscripción actualizada y guardada en Subscripciones."),N.push(e.jsx(j,{title:"Éxito",type:"success",children:"Se ha subscrito correctamente a este plan."}))}catch(a){console.error("Error al guardar la subscripción:",a),N.push(e.jsx(j,{title:"Error",children:"Ocurrió un error al subscribirse a este plan. Inténtalo nuevamente."}))}},z=({title:o,value:a})=>e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("p",{className:"text-gray-700 dark:text-gray-200 font-semibold",children:a})]}),F=(o,a)=>{pe(t=>{const b=t.filter(f=>f.id!==o);return a!==""&&b.push({id:o,value:a}),b})},A=o=>{const{name:a,value:t}=o.target;h(b=>({...b,[a]:t}))},[K,Ce]=d.useState({facebook:"",instagram:"",tiktok:"",whatsapp:""}),fo=(o,a)=>({facebook:/^(https?:\/\/)?(www\.)?facebook\.com\/.+$/,instagram:/^(https?:\/\/)?(www\.)?instagram\.com\/.+$/,tiktok:/^(https?:\/\/)?(www\.)?tiktok\.com\/.+$/})[a].test(o)?"":`La URL ingresada no es válida para ${a}.`,Ee=(o,a)=>{const{value:t}=o.target;h(f=>({...f,[`Link${a.charAt(0).toUpperCase()+a.slice(1)}`]:t}));const b=fo(t,a);Ce(f=>({...f,[a]:b}))},bo=async()=>{var o;if(!n.nombre||n.nombre.trim()===""){N.push(e.jsx(j,{title:"Error",children:"El nombre no puede estar vacío."}));return}if(!n.phone||!/^[1-9]\d*$/.test(n.phone)){N.push(e.jsx(j,{title:"Error",children:"El teléfono debe contener solo números y no puede comenzar con 0."}));return}if(n.whatsapp&&!/^[1-9]\d*$/.test(n.whatsapp)){N.push(e.jsx(j,{title:"Error",children:"El WhatsApp debe contener solo números y no puede comenzar con 0."}));return}if(!n.rif||!/^[JVEGCP]-\d+$/.test(n.rif)){N.push(e.jsx(j,{title:"Error",children:"El RIF debe estar en un formato válido (Ejemplo: J-12345678)."}));return}if(!n.Direccion||n.Direccion.trim()===""){N.push(e.jsx(j,{title:"Error",children:"La Direccion no puede estar vacía."}));return}if(!n.status){N.push(e.jsx(j,{title:"Error",children:"Debes seleccionar un estatus."}));return}if(!n.estado){N.push(e.jsx(j,{title:"Error",children:"Debes seleccionar un estado."}));return}try{const a=G(S,"Usuarios"),t=await J(a);if(t.docs.some(Y=>Y.data().rif===n.rif&&Y.id!==i)){N.push(e.jsx(j,{title:"Error",children:"El RIF ya está registrado. Por favor, verifica e intenta con otro."}));return}if(t.docs.some(Y=>Y.data().phone===n.phone&&Y.id!==i)){N.push(e.jsx(j,{title:"Error",children:"El teléfono ya está registrado. Por favor, verifica e intenta con otro."}));return}let ee=n.image_perfil;if(n.newLogoFile){const me=(o=decodeURIComponent(n.image_perfil).split("/").pop())==null?void 0:o.split("?")[0],Ae=`${i}_`,Oe=me==null?void 0:me.match(/_(\d+)\.jpg$/),Ie=Oe?parseInt(Oe[1],10):0,be=`${Ae}${Ie+1}.jpg`,w=we(Ue,`profileImages/${me}`);try{await Fo(w)}catch(Oo){console.error("Error al eliminar la imagen anterior:",Oo)}const l=we(Ue,`profileImages/${be}`);await ze(l,n.newLogoFile),ee=await Ke(l)}const B=M(S,"Usuarios",i),fe={...n,image_perfil:ee};delete fe.newLogoFile,await ae(B,fe),v({...n,image_perfil:ee}),I(!1),_(),N.push(e.jsx(j,{title:"Éxito",type:"success",children:"Datos de Usuario actualizados correctamente."}))}catch(a){console.error("Error al actualizar los datos:",a),N.push(e.jsx(j,{title:"Error",children:"Ocurrió un error al actualizar los datos del usuario. Inténtalo nuevamente."}))}},jo=async()=>{try{const o=M(S,"Usuarios",i);await ae(o,{metodos_pago:y}),N.push(e.jsx(j,{title:"Éxito",type:"success",children:"Métodos de pago actualizados correctamente."}))}catch(o){console.error("Error al guardar los métodos de pago:",o),N.push(e.jsx(j,{title:"Error",children:"Ocurrió un error al actualizar los métodos de pago. Inténtalo nuevamente."}))}},No=[{name:"Pago móvil",icon:e.jsx(oa,{}),dbKey:"pagoMovil"},{name:"Transferencias bancarias",icon:e.jsx(ea,{}),dbKey:"transferencia"},{name:"Punto de venta",icon:e.jsx(Me,{}),dbKey:"puntoVenta"},{name:"Zinli",icon:e.jsx(no,{}),dbKey:"zinli"},{name:"Efectivo",icon:e.jsx(no,{}),dbKey:"efectivo"},{name:"Zelle",icon:e.jsx(aa,{}),dbKey:"zelle"},{name:"Tarjetas de crédito nacional",icon:e.jsx(Me,{}),dbKey:"tarjetaCreditoN"},{name:"Tarjetas de crédito internacional",icon:e.jsx(Me,{}),dbKey:"tarjetaCreditoI"}],Ve=()=>$(!1),yo=()=>I(!0),[ge,pe]=d.useState([]),[_e,ke]=d.useState([]),{TabNav:He,TabList:wo,TabContent:Ze}=lo,vo=[{header:"Nombre del Servicio",accessorKey:"nombre_servicio"},{header:"Precio",accessorKey:"precio",cell:({row:o})=>`$${parseFloat(o.original.precio).toFixed(2)}`},{header:"Estatus",accessorKey:"estatus",cell:({row:o})=>{const[a,t]=d.useState(o.original.estatus??!1),b=async f=>{t(f);const ee=C.map(B=>B.uid_servicio===o.original.uid_servicio?{...B,estatus:f}:B);T(ee);try{const B=M(S,"Servicios",o.original.uid_servicio);await ae(B,{estatus:f}),console.log("Estado del servicio actualizado")}catch(B){console.error("Error al actualizar el estado del servicio:",B)}};return e.jsx("div",{children:e.jsx(qo,{checked:a,onChange:()=>b(!a)})})}},{header:"Acciones",id:"actions",cell:({row:o})=>e.jsx("div",{className:"",children:e.jsx(oe,{size:"sm",variant:"solid",onClick:()=>Do(o.original),className:"text-blue-900 hover:bg-blue-700",children:e.jsx(Yo,{})})})}],So=[{header:"Nombre del Plan",accessorKey:"nombre"},{header:"Monto",accessorKey:"monto"},{header:"Descripcion",accessorKey:"descripcion"},{header:"Cantidad de servicios",accessorKey:"cantidad_servicios"}],Co=[{header:"Nombre del Plan",accessorKey:"nombre"},{header:"Monto",accessorKey:"monto"},{header:"vigencia",accessorKey:"vigencia"},{header:"Fecha de vencimiento",accessorKey:"fecha_fin",cell:({row:o})=>`${q(o.original.fecha_fin)}`}],{Tr:re,Th:he,Td:xe,THead:Re,TBody:Le,Sorter:la}=je,De=Te({data:C,columns:vo,state:{sorting:_e,columnFilters:ge},onSortingChange:ke,onColumnFiltersChange:pe,getCoreRowModel:$e(),getSortedRowModel:Fe(),getFilteredRowModel:Be()}),Ye=Te({data:te,columns:So,state:{sorting:_e,columnFilters:ge},onSortingChange:ke,onColumnFiltersChange:pe,getCoreRowModel:$e(),getSortedRowModel:Fe(),getFilteredRowModel:Be()}),Je=Te({data:se,columns:Co,state:{sorting:_e,columnFilters:ge},onSortingChange:ke,onColumnFiltersChange:pe,getCoreRowModel:$e(),getSortedRowModel:Fe(),getFilteredRowModel:Be()}),[H,Eo]=d.useState(1),Z=6,We=De.getRowModel().rows.length,Qe=o=>{console.log("onPaginationChange",o),Eo(o)},[_o,ko]=d.useState(!1),[Ro,Xe]=d.useState(!1),[Lo,eo]=d.useState(null),Pe=()=>{ko(o=>!o)},Do=o=>{eo(o),Xe(!0)},Po=()=>{Xe(!1),eo(null)},Ao=()=>{_()};return e.jsxs(Bo,{className:"min-h-screen overflow-y-auto pb-8",children:[m&&e.jsx("div",{className:"flex items-center",children:e.jsxs("button",{onClick:()=>c(`${Uo}/garages`),className:"flex items-center text-blue-900 mb-3 ml-2 px-4 py-2 bg-blue-100 rounded-lg hover:bg-blue-200 transition duration-200",children:[e.jsx(Ko,{className:"mr-2"}),e.jsx("span",{children:"Volver"})]})}),e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 pb-8",children:[e.jsxs(so,{children:[e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{className:"bg-[#1d1e56] rounded-md p-2 hover:bg-[#1E3a8a] text-white",onClick:yo,children:"Editar"})}),e.jsxs("div",{className:"flex flex-col xl:justify-between min-w-[260px] h-full 2xl:min-w-[360px] mx-auto",children:[e.jsxs("div",{className:"flex xl:flex-col items-center gap-4",children:[e.jsx(ro,{size:90,shape:"circle",src:(r==null?void 0:r.image_perfil)||"/img/logo/logo-light-streamline.png",className:"p-2 bg-white shadow-lg"}),e.jsx("h4",{className:"font-bold",children:(r==null?void 0:r.nombre)||"Nombre no disponible"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-y-7 gap-x-4 mt-8",children:[e.jsx(z,{title:"Correo electronico",value:(r==null?void 0:r.email)||"Correo no disponible"}),e.jsx(z,{title:"Numero de telefono",value:(r==null?void 0:r.phone)||"Telefono no disponible"}),e.jsx(z,{title:"Rif",value:(r==null?void 0:r.rif)||"Rif no disponible"}),e.jsx(z,{title:"Estado",value:(r==null?void 0:r.estado)||"Estado no disponible"}),e.jsx(z,{title:"Estatus",value:(r==null?void 0:r.status)||"Estatus no disponible"}),e.jsx(z,{title:"Direccion",value:(r==null?void 0:r.Direccion)||"Direccion no disponible"}),r!=null&&r.ubicacion?e.jsx(sa,{center:{lat:r.ubicacion.lat,lng:r.ubicacion.lng},markers:[{lat:r.ubicacion.lat,lng:r.ubicacion.lng}]}):"Ubicación no disponible",e.jsxs("div",{className:"mb-7",children:[e.jsx("span",{children:"Redes Sociales"}),e.jsx("div",{className:"flex mt-4 gap-2",children:r!=null&&r.LinkFacebook||r!=null&&r.LinkInstagram||r!=null&&r.whatsapp||r!=null&&r.LinkTiktok?e.jsxs(e.Fragment,{children:[r.LinkFacebook&&e.jsx("a",{href:r.LinkFacebook,target:"_blank",rel:"noopener noreferrer",title:r.LinkFacebook,children:e.jsx(oe,{shape:"circle",size:"sm",icon:e.jsx(Go,{className:"text-[#1773ea]"})})}),r.LinkInstagram&&e.jsx("a",{href:r.LinkInstagram,target:"_blank",rel:"noopener noreferrer",title:r.LinkInstagram,children:e.jsx(oe,{shape:"circle",size:"sm",icon:e.jsx(Vo,{className:"text-[#E1306C]"})})}),r.LinkTiktok&&e.jsx("a",{href:r.LinkTiktok,target:"_blank",rel:"noopener noreferrer",title:r.LinkTiktok,children:e.jsx(oe,{shape:"circle",size:"sm",icon:e.jsx(Ho,{className:"text-black"})})}),r.whatsapp&&e.jsx("a",{href:`https://wa.me/${r.whatsapp}?text=${encodeURIComponent("Hola, quiero más información sobre el servicio")}`,target:"_blank",rel:"noopener noreferrer",title:r.whatsapp,children:e.jsx(oe,{shape:"circle",size:"sm",icon:e.jsx(Zo,{className:"text-[#25d366]"})})})]}):e.jsx("p",{className:"text-gray-500",children:"No hay redes sociales disponibles"})})]})]})]})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs(lo,{defaultValue:"tab1",children:[e.jsxs(wo,{children:[e.jsx(He,{value:"tab1",children:"Planes"}),e.jsx(He,{value:"tab2",children:"Servicios"})]}),e.jsx("div",{className:"w-full",children:e.jsx(Ze,{value:"tab1",children:e.jsxs("div",{className:"mb-8 mt-4",children:[e.jsx("h6",{className:"mb-4",children:"Subscripción"}),e.jsx(so,{bordered:!0,className:"mb-4",children:s?e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 p-4 border rounded-lg shadow-md bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ro,{className:"bg-transparent",shape:"circle",icon:e.jsx(Wo,{className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:(u==null?void 0:u.nombre)||"Cargando..."}),e.jsx(Jo,{className:`rounded-md border-0 mx-2 ${(u==null?void 0:u.status)==="Aprobado"?"bg-green-100 text-green-400":(u==null?void 0:u.status)==="Vencido"?"bg-red-100 text-red-400":"bg-yellow-100 text-yellow-400"}`,children:(u==null?void 0:u.status)||"Pendiente"})]}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Vigencia:"," ",(u==null?void 0:u.vigencia)??"---"," ","días"]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Monto mensual:"," ",e.jsxs("span",{className:"font-bold text-gray-800",children:["$",(u==null?void 0:u.monto)??"---"]})]}),(u==null?void 0:u.status)==="Aprobado"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs ml-2 text-gray-600",children:[W??"---"," ","días restantes"]}),e.jsxs("p",{className:"text-xs ml-2 text-gray-600",children:["Fecha de vencimiento:"," ",e.jsx("span",{className:"text-xs text-gray-600",children:u.fecha_fin?q(u.fecha_fin):"Fecha no disponible"})]})]})]})]})]}),(u==null?void 0:u.status)==="Vencido"&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{onClick:()=>$(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition duration-200",children:"Elegir Plan"})}),(u==null?void 0:u.status)==="Aprobado"&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{onClick:()=>$(!0),className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Renovar Pago"})}),(u==null?void 0:u.status)==="Por Aprobar"&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx(ta,{talleruid:i,subscriptionId:(oo=se[0])==null?void 0:oo.uid})})]}):e.jsxs("div",{className:"flex justify-end",children:[e.jsx("p",{className:"text-xs mr-64 mt-3",children:"Puede visualizar y suscribirse a un plan para su taller..."}),e.jsx("button",{onClick:()=>$(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition duration-200",children:"Ver Planes"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"p-4 rounded-lg shadow",children:[e.jsx("h6",{className:"mb-6 flex justify-start mt-4",children:"Historial de Subscripciones"}),e.jsxs(je,{className:"w-full rounded-lg",children:[e.jsx(Re,{children:Je.getHeaderGroups().map(o=>e.jsx(re,{children:o.headers.map(a=>e.jsx(he,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsx("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:ne(a.column.columnDef.header,a.getContext())})},a.id))},o.id))}),e.jsx(Le,{children:Je.getRowModel().rows.slice((H-1)*Z,H*Z).map(o=>e.jsx(re,{children:o.getVisibleCells().map(a=>e.jsx(xe,{children:ne(a.column.columnDef.cell,a.getContext())},a.id))},o.id))})]}),e.jsx(io,{onChange:Qe,currentPage:H,totalRows:We,rowsPerPage:Z})]})}),e.jsx("div",{className:"border-t border-gray-300 my-4"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 p-4",children:No.map(o=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Qo,{checked:y[o.dbKey]||!1,onChange:a=>{P(t=>({...t,[o.dbKey]:a}))}}),e.jsx("span",{children:o.icon}),e.jsx("span",{children:o.name})]},o.name))}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:jo,className:"px-4 py-2 bg-[#1d1e56] text-white rounded-md hover:bg-blue-900 focus:outline-none",children:"Guardar"})})]})})}),e.jsx(Ze,{value:"tab2",children:e.jsx("div",{className:"w-full h-full",children:e.jsxs("div",{className:"p-4 rounded-lg",children:[e.jsx("h6",{className:"mb-6 flex justify-start mt-4",children:"Lista de Servicios"}),e.jsxs(je,{className:"w-full rounded-lg",children:[e.jsx(Re,{children:De.getHeaderGroups().map(o=>e.jsx(re,{children:o.headers.map(a=>e.jsx(he,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsx("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:ne(a.column.columnDef.header,a.getContext())})},a.id))},o.id))}),e.jsx(Le,{children:De.getRowModel().rows.slice((H-1)*Z,H*Z).map(o=>e.jsx(re,{children:o.getVisibleCells().map(a=>e.jsx(xe,{children:ne(a.column.columnDef.cell,a.getContext())},a.id))},o.id))})]}),e.jsx(io,{onChange:Qe,currentPage:H,totalRows:We,rowsPerPage:Z})]})})})]})})]}),e.jsx(mo,{width:1e3,isOpen:ce,onClose:Ve,children:e.jsxs("div",{className:"table-responsive",children:[e.jsx("h2",{className:"mb-4",children:"Planes de Subscripción"}),e.jsx("div",{className:"p-2 rounded-lg shadow",children:e.jsxs(je,{className:"w-full rounded-lg",children:[e.jsx(Re,{children:Ye.getHeaderGroups().map(o=>e.jsxs(re,{children:[o.headers.map(a=>{var t,b;return e.jsx(he,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsxs("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:[ne(a.column.columnDef.header,a.getContext()),a.column.getCanFilter()?e.jsx("input",{type:"text",value:((b=(t=ge.find(f=>f.id===a.id))==null?void 0:t.value)==null?void 0:b.toString())||"",onChange:f=>F(a.id,f.target.value),placeholder:"Buscar",className:"mt-2 p-1 border rounded",onClick:f=>f.stopPropagation()}):null]})},a.id)}),e.jsx(he,{children:"Acción"})," "]},o.id))}),e.jsx(Le,{children:Ye.getRowModel().rows.slice((H-1)*Z,H*Z).map(o=>e.jsxs(re,{children:[o.getVisibleCells().map(a=>e.jsx(xe,{children:ne(a.column.columnDef.cell,a.getContext())},a.id)),e.jsx(xe,{children:e.jsx("button",{className:"bg-[#1d1e56] text-white px-4 py-2 rounded",onClick:()=>X(o.original),children:"Suscribirse"})})]},o.id))})]})})]})}),R&&e.jsx(zo,{isOpen:R,title:"Editar Taller",confirmButtonColor:"blue-600",onClose:()=>I(!1),onRequestClose:()=>I(!1),onCancel:()=>I(!1),onConfirm:bo,children:e.jsxs("div",{className:"max-h-[450px] overflow-y-auto",children:[e.jsx("div",{className:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10 gap-2",children:e.jsxs("div",{className:"text-center",children:[!n.image_perfil&&!n.newLogoFile?e.jsx(Ge,{className:"mx-auto h-12 w-12 text-gray-300","aria-hidden":"true"}):e.jsxs("div",{children:[e.jsx("img",{src:n.newLogoFile?URL.createObjectURL(n.newLogoFile):n.image_perfil,alt:"Preview Logo",className:"mx-auto h-32 w-32 object-cover"}),e.jsx("button",{onClick:()=>h(o=>({...o,newLogoFile:null,image_perfil:""})),className:"mt-2 text-red-500 hover:text-red-700",children:"Quitar Logo"})]}),e.jsx("div",{className:"mt-4 flex text-sm leading-6 text-gray-600 justify-center",children:e.jsxs("label",{htmlFor:"logo-upload",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500 flex justify-center items-center",children:[e.jsx("span",{children:n.newLogoFile?"Cambiar Logo":"Seleccionar Logo"}),e.jsx("input",{id:"logo-upload",name:"logo-upload",type:"file",accept:"image/*",className:"sr-only",onChange:o=>{var t;const a=(t=o.target.files)==null?void 0:t[0];h(b=>({...b,newLogoFile:a||null}))}})]})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Nombre"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Nombre",name:"nombre",value:n.nombre,onChange:A})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Correo Electrónico"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Correo Electrónico",disabled:!0,name:"email",value:n.email,onChange:A})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Teléfono"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Teléfono",name:"phone",value:n.phone,onChange:A,onKeyDown:o=>{o.currentTarget.value===""&&o.key==="0"&&o.preventDefault()},onInput:o=>{const a=o.target,t=a.value.replace(/^0+/,"");t!==a.value&&h(b=>({...b,phone:t}))}})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"WhatsApp"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"WhatsApp",name:"whatsapp",value:n.whatsapp,onChange:A,onKeyDown:o=>{o.currentTarget.value===""&&o.key==="0"&&o.preventDefault()},onInput:o=>{const a=o.target,t=a.value.replace(/^0+/,"");t!==a.value&&h(b=>({...b,whatsapp:t}))}})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"RIF:"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsxs("select",{value:((ao=n.rif)==null?void 0:ao.split("-")[0])||"J",onChange:o=>h(a=>{var t;return{...a,rif:`${o.target.value}-${((t=a==null?void 0:a.rif)==null?void 0:t.split("-")[1])||""}`}}),className:"mx-2 p-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"J",children:"J-"}),e.jsx("option",{value:"V",children:"V-"}),e.jsx("option",{value:"E",children:"E-"}),e.jsx("option",{value:"C",children:"C-"}),e.jsx("option",{value:"G",children:"G-"}),e.jsx("option",{value:"P",children:"P-"})]}),e.jsx("input",{disabled:!0,type:"text",value:((to=n.rif)==null?void 0:to.split("-")[1])||"",onChange:o=>h(a=>{var t;return{...a,rif:`${((t=a==null?void 0:a.rif)==null?void 0:t.split("-")[0])||"J"}-${o.target.value}`}}),className:"p-3 border border-gray-300 rounded-r-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 mx-2 w-full"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Estado:"}),e.jsxs("select",{name:"estado",value:n.estado,onChange:A,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"",children:"Seleccione un Estado"}),["Amazonas","Anzoátegui","Apure","Aragua","Barinas","Bolívar","Carabobo","Cojedes","Delta Amacuro","Distrito Capital","Falcón","Guárico","Lara","La Guaira","Mérida","Miranda","Monagas","Nueva Esparta","Portuguesa","Sucre","Táchira","Trujillo","Yaracuy","Zulia"].map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Direccion"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"",name:"Direccion",value:n.Direccion,onChange:A})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Mapa"}),e.jsx("button",{type:"button",className:"w-full mt-1 p-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring focus:ring-blue-300",onClick:Pe,children:"Abrir Mapa"})]}),_o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-3xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Editar ubicación"}),e.jsx("button",{className:"text-gray-600 hover:text-gray-800 focus:outline-none",onClick:Pe,children:"✖"})]}),e.jsx(ra,{initialLocation:{lat:n.ubicacion.lat,lng:n.ubicacion.lng},onLocationChange:o=>h(a=>({...a,ubicacion:o}))}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring focus:ring-blue-300",onClick:Pe,children:"Guardar"})})]})}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Estatus"}),e.jsxs("select",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",name:"status",value:n.status,onChange:A,children:[e.jsx("option",{value:"Aprobado",children:"Aprobado"}),e.jsx("option",{value:"Pendiente",children:"Pendiente"}),e.jsx("option",{value:"Rechazado",children:"Rechazado"}),e.jsx("option",{value:"En espera por aprobación",children:"En espera por aprobación"})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Facebook"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de Facebook",name:"LinkFacebook",value:n.LinkFacebook,onChange:o=>Ee(o,"facebook")}),K.facebook&&e.jsx("span",{className:"text-red-500 text-sm",children:K.facebook})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Instagram"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de Instagram",name:"LinkInstagram",value:n.LinkInstagram,onChange:o=>Ee(o,"instagram")}),K.instagram&&e.jsx("span",{className:"text-red-500 text-sm",children:K.instagram})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"TikTok"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de TikTok",name:"LinkTiktok",value:n.LinkTiktok,onChange:o=>Ee(o,"tiktok")}),K.tiktok&&e.jsx("span",{className:"text-red-500 text-sm",children:K.tiktok})]})]})]})}),e.jsx(ia,{isOpen:Ro,onClose:Po,service:Lo,onServiceUpdated:Ao})]})};export{Pt as default};
