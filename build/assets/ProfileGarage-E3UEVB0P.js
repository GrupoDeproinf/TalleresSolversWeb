import{r as c,j as e,a8 as G,a9 as S,aa as J,ag as D,ap as Ue,b2 as Io,ak as we,al as qe,am as ze,an as te,af as Q,ab as Ce,a7 as Se,aj as $e,a4 as Mo,u as To,ai as Fo,ar as Bo}from"./index-Nr7DOcs5.js";import{C as $o,a as Uo}from"./Views-SzAC9t3D.js";import{S as qo}from"./Switcher-Ut7y20GG.js";import{C as so}from"./Card-GtPtNWmu.js";import{A as to}from"./index-3dK65p4G.js";import{B as W}from"./Button-RpRRBLhx.js";import{C as zo}from"./ConfirmDialog-XhuTrmUf.js";import{g as Ke,r as Ko,t as Go,x as Vo,y as Ho,z as Zo,d as Wo}from"./index.esm-7QtrnPrk.js";import{T as Jo}from"./Tag-A5Cp-iKQ.js";import{ap as Qo,aq as Ie,ar as ro}from"./index.esm-hDm5I03d.js";import{T as je}from"./index-NkYS5vPG.js";import"./Alert-IFyBpUTx.js";import"./Badge-7gcaibQO.js";import"./Calendar-gVQy20-l.js";import{C as Yo}from"./index-p7qyf0aj.js";import"./index-Iglej30T.js";import{D as co}from"./Dialog-mo71bq2S.js";import{D as mo}from"./Drawer-1Mi38Dxe.js";import"./index-dKO4bEJu.js";import"./FormItem-U6G_YRIs.js";import{I as de}from"./Input-6raBYDQf.js";import"./index-QZyWdjEP.js";import"./index-FXe5p_jG.js";import"./index-OLaUrpI8.js";import{N as b,t as j}from"./toast-1qPzYHZN.js";import{P as no}from"./index-Brff2YrL.js";import"./Progress-XpERHQYE.js";import"./index-bODHSr2e.js";import"./RangeCalendar-Q9AzkEiE.js";import"./ScrollBar-39BbJnce.js";import"./index-bU75oMiq.js";import{d as Xo}from"./Select-PkSYplil.js";import"./Skeleton-5yRo8qaR.js";import"./index-tC9k94Mh.js";import{T as io}from"./index-Jo3TiA2s.js";import"./index-XVNNSon3.js";import"./index-UzMXGgmd.js";import"./Tooltip-gLhVAyTO.js";import"./Upload-SY7Bu0VE.js";import{u as Me,f as se,g as Te,a as Fe,b as Be}from"./index-bkn0uZwU.js";import{R as ea}from"./index.esm-_1tCRt2Z.js";import{M as oa}from"./index.esm-cvuoA7wo.js";import{S as aa}from"./index.esm-DIrlIaUg.js";import{F as uo,a as go,b as A,E as P}from"./formik.esm-0kcgy0iu.js";import{c as re,g as Ne,h as ye,a as L}from"./index.esm-1XJFlNta.js";import{G as po,M as ho}from"./esm-iBLvqSmq.js";import"./useMergeRef-Rt_Crb27.js";import"./context-gbG70jxa.js";import"./useTimeout-_DD3r0oe.js";import"./CloseButton-s3M96kL4.js";import"./StatusIcon-_EmpelN-.js";import"./motion-GODN01Pl.js";import"./useControllableState-nFLDxS-2.js";import"./cloneDeep-Rfdj1wFF.js";import"./_getAllKeys-7DpwFFi_.js";import"./_MapCache-zjtmu8-K.js";import"./_baseIsEqual-Wz-ZGWgV.js";import"./get-1iKrFfDd.js";import"./toString-xXAQzo7k.js";import"./floating-ui.react-Siy9LDCN.js";import"./floating-ui.dom-0rLBacrf.js";import"./TimeInput-J0GAAAi0.js";import"./useUniqueId-op574tzc.js";import"./useDidUpdate-RKJnPgc_.js";import"./index-K_MsMzaT.js";import"./index-YzJdvSvg.js";import"./useRootClose-3u3AcjdZ.js";import"./isNil-8yPb6mot.js";import"./index-c5JwgfFM.js";import"./chainedFunction-ltcSYACe.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./mapCloneElement-AO4c1VWz.js";import"./index.esm-ZAJo3edJ.js";import"./index.esm-e_Pi5fAz.js";const lo=[{codigo:"0102",nombre:"BANCO DE VENEZUELA"},{codigo:"0156",nombre:"100% BANCO"},{codigo:"0172",nombre:"BANCAMIGA BANCO MICROFINANCIERO C A"},{codigo:"0114",nombre:"BANCARIBE"},{codigo:"0171",nombre:"BANCO ACTIVO"},{codigo:"0166",nombre:"BANCO AGRICOLA DE VENEZUELA"},{codigo:"0175",nombre:"BANCO BICENTENARIO DEL PUEBLO"},{codigo:"0128",nombre:"BANCO CARONI"},{codigo:"0163",nombre:"BANCO DEL TESORO"},{codigo:"0115",nombre:"BANCO EXTERIOR"},{codigo:"0151",nombre:"BANCO FONDO COMUN"},{codigo:"0173",nombre:"BANCO INTERNACIONAL DE DESARROLLO"},{codigo:"0105",nombre:"BANCO MERCANTIL"},{codigo:"0191",nombre:"BANCO NACIONAL DE CREDITO"},{codigo:"0138",nombre:"BANCO PLAZA"},{codigo:"0137",nombre:"BANCO SOFITASA"},{codigo:"0104",nombre:"BANCO VENEZOLANO DE CREDITO"},{codigo:"0168",nombre:"BANCRECER"},{codigo:"0134",nombre:"BANESCO"},{codigo:"0177",nombre:"BANFANB"},{codigo:"0146",nombre:"BANGENTE"},{codigo:"0174",nombre:"BANPLUS"},{codigo:"0108",nombre:"BBVA PROVINCIAL"},{codigo:"0157",nombre:"DELSUR BANCO UNIVERSAL"},{codigo:"0169",nombre:"MI BANCO"},{codigo:"0178",nombre:"N58 BANCO DIGITAL BANCO MICROFINANCIERO S A"}],sa=({subscriptionId:r,talleruid:C})=>{const[t,k]=c.useState("Efectivo"),[v,I]=c.useState([]),[Y,E]=c.useState(!1),[T,B]=c.useState(!1),[ne,$]=c.useState(!1),[R,O]=c.useState(!1);c.useEffect(()=>{(async()=>{const u=G(S,"MetodosPago"),x=(await J(u)).docs.map(_=>_.data());I(x.filter(_=>_.status))})()},[]),c.useEffect(()=>{(async()=>{if(C)try{const u=D(S,"Usuarios",C),d=await Ue(u);if(d.exists()){const _=d.data().subscripcion_actual;_&&_.pago_reportado===!0&&$(!0)}}catch(u){console.error("Error al verificar si ya se reportó el pago:",u)}})()},[C]);const V=i=>{k(i)},H=()=>{ne?O(!0):B(!0)},p=re().shape({monto:Ne().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),fechaPago:ye().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),ie=re().shape({monto:Ne().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),numReferencia:L().required("El número de referencia es obligatorio"),bancoDestino:L().required("Selecciona un banco de destino"),bancoOrigen:L().required("Selecciona un banco de origen"),fechaPago:ye().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),X=re().shape({monto:Ne().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),numReferencia:L().required("El número de referencia es obligatorio"),telefono:L().required("El teléfono es obligatorio"),bancoDestino:L().required("Selecciona un banco de destino"),bancoOrigen:L().required("Selecciona un banco de origen"),fechaPago:ye().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),m=re().shape({monto:Ne().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),correo:L().email("El correo no es válido").required("El correo Zelle es obligatorio"),fechaPago:ye().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),n=re().shape({...t==="Efectivo"&&p.fields,...t==="Transferencia"&&ie.fields,...t==="Pago Móvil"&&X.fields,...t==="Zelle"&&m.fields}),h={metodoPago:"",monto:"",numReferencia:"",telefono:"",correo:"",cedula:"",bancoOrigen:"",bancoDestino:"",fechaPago:"",newLogoFile:null},N=async i=>{if(!r){console.error("Error: subscriptionId no está definido");return}E(!0);try{let u="";if(i.newLogoFile&&t&&C){const le=Io(),me=new Date().toISOString(),ve=`${t}_${C}_${me}.jpg`,U=i.newLogoFile,Ee=we(le,`paymentcommitment/${ve}`),F=await qe(Ee,U);u=await ze(F.ref)}const d=i.fechaPago?te.fromDate(new Date(i.fechaPago)):null,x={metodo:t,monto:i.monto,fechaPago:d,comprobante:u};t==="Transferencia"&&(x.numReferencia=i.numReferencia??"",x.cedula=i.cedula??"",x.bancoOrigen=i.bancoOrigen??"",x.bancoDestino=i.bancoDestino??""),t==="Pago Móvil"&&(x.cedula=i.cedula,x.telefono=i.telefono,x.bancoOrigen=i.bancoOrigen,x.bancoDestino=i.bancoDestino),t==="Zelle"&&(x.correo=i.correo??"",x.numReferencia=i.numReferencia),console.log(x);const _=D(S,"Subscripciones",r);if(await Q(_,{comprobante_pago:x}),C){const le=D(S,"Usuarios",C);await Q(le,{"subscripcion_actual.pago_reportado":!0}),$(!0)}console.log("Pago registrado exitosamente"),j.push(e.jsx(b,{title:"Éxito",type:"success",children:"Se ha registrado el pago correctamente."}))}catch(u){console.error("Error al registrar el pago:",u),j.push(e.jsx(b,{title:"Error",children:"Ocurrió un problema al registrar el pago."}))}finally{E(!1),B(!1)}},g=v.find(i=>i.tipo_pago===t);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:H,className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Reportar Pago"}),e.jsx(co,{isOpen:R,onClose:()=>O(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Pago Ya Reportado"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Ya se ha reportado un pago para esta suscripción. No se puede reportar otro pago."}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>O(!1),className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Entendido"})})]})}),e.jsx(mo,{isOpen:T,onClose:()=>B(!1),title:"Registrar Pago",children:e.jsx(uo,{initialValues:h,onSubmit:N,validationSchema:n,validateOnBlur:!0,validateOnChange:!1,children:({setFieldValue:i,values:u})=>e.jsxs(go,{className:"flex flex-col gap-4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Selecciona el Método de Pago"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mb-4",children:v==null?void 0:v.map(d=>e.jsx("button",{type:"button",onClick:()=>V(d.tipo_pago),className:`text-sm py-2 px-4 rounded-md ${t===d.tipo_pago?"bg-[#1d1e56] text-white":"bg-gray-200"}`,children:d.tipo_pago},d.tipo_pago))}),t!=="Efectivo"&&g&&e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg mb-4",children:[e.jsx("h5",{className:"font-semibold text-lg",children:"Detalles de la Empresa"}),g.email&&e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",g.email]}),g.num_ref&&e.jsxs("p",{children:[e.jsx("strong",{children:"Número de Referencia:"})," ",g.num_ref]}),g.banco&&e.jsxs("p",{children:[e.jsx("strong",{children:"Banco:"})," ",g.banco]}),g.cedula_rif&&e.jsxs("p",{children:[e.jsx("strong",{children:"Cédula/RIF:"})," ",g.cedula_rif]}),g.cuenta&&e.jsxs("p",{children:[e.jsx("strong",{children:"Cuenta:"})," ",g.cuenta]}),g.status_pago!==void 0&&e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",g.status_pago?"Activo":"Inactivo"]}),g.tipo_cuenta&&e.jsxs("p",{children:[e.jsx("strong",{children:"Tipo de Cuenta:"})," ",g.tipo_cuenta]}),g.telefono&&e.jsxs("p",{children:[e.jsx("strong",{children:"Teléfono:"})," ",g.telefono]}),g.titular&&e.jsxs("p",{children:[e.jsx("strong",{children:"Titular:"})," ",g.titular]})]}),e.jsx(A,{id:"monto",name:"monto",as:de,placeholder:"Ingresa el monto en $"}),e.jsx(P,{name:"monto",component:"div",className:"text-red-500"}),e.jsx(A,{id:"fechaPago",name:"fechaPago",as:de,type:"date",placeholder:"Fecha de pago"}),e.jsx(P,{name:"fechaPago",component:"div",className:"text-red-500"}),t==="Pago Móvil"&&e.jsxs(e.Fragment,{children:[e.jsx(A,{id:"telefono",name:"telefono",as:de,placeholder:"Teléfono"}),e.jsx(P,{name:"telefono",component:"div",className:"text-red-500"})]}),t==="Zelle"&&e.jsx(A,{id:"correo",name:"correo",as:de,placeholder:"Correo Zelle"}),["Transferencia","Pago Móvil"].includes(t)&&e.jsxs(e.Fragment,{children:[e.jsx(A,{id:"numReferencia",name:"numReferencia",as:de,placeholder:"Número de referencia"}),e.jsx(P,{name:"numReferencia",component:"div",className:"text-red-500"})]}),["Transferencia","Pago Móvil"].includes(t)&&e.jsxs(e.Fragment,{children:[e.jsxs(A,{id:"bancoDestino",as:"select",name:"bancoDestino",className:"p-2 rounded-md border border-slate-300",children:[e.jsx("option",{value:"",children:"Selecciona Banco de Destino"}),lo.map(d=>e.jsx("option",{value:d.nombre,children:d.nombre},d.codigo))]}),e.jsx(P,{name:"bancoDestino",component:"div",className:"text-red-500"}),e.jsxs(A,{id:"bancoOrigen",as:"select",name:"bancoOrigen",className:"p-2 rounded-md border border-slate-300",children:[e.jsx("option",{value:"",children:"Selecciona Banco de Origen"}),lo.map(d=>e.jsx("option",{value:d.nombre,children:d.nombre},d.codigo))]}),e.jsx(P,{name:"bancoOrigen",component:"div",className:"text-red-500"})]}),["Transferencia","Pago Móvil","Zelle"].includes(t)&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10 gap-2",children:e.jsxs("div",{className:"text-center",children:[u.newLogoFile?e.jsx("img",{src:URL.createObjectURL(u.newLogoFile),alt:"Logo",className:"w-32 h-32 object-cover rounded-md"}):e.jsx(Ke,{className:"text-gray-500 text-center text-3xl"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"fileInput",className:"text-sm font-medium text-blue-600 cursor-pointer",children:"Subir Comprobante de Pago"}),e.jsx("input",{id:"fileInput",name:"newLogoFile",type:"file",className:"hidden",accept:"image/*",onChange:d=>{d.target.files&&d.target.files[0]&&i("newLogoFile",d.target.files[0])}})]})]})})}),e.jsx("button",{type:"submit",className:"w-full py-2 mt-4 bg-blue-900 rounded-md hover:bg-blue-700 text-white",children:"Registrar Pago"})]})})})]})},ta=({markers:r,center:C})=>{const[t,k]=c.useState([]);return c.useEffect(()=>{k(r)},[r]),e.jsx("div",{style:{height:"50%",width:"100%"},children:e.jsx(po,{center:C,zoom:10,mapContainerStyle:{height:"400px",width:"100%",marginTop:"10px"},children:t.map((v,I)=>e.jsx(ho,{position:{lat:v.lat,lng:v.lng}},I))})})},ra=({initialLocation:r,onLocationChange:C})=>{const[t,k]=c.useState(null),[v]=c.useState(17);c.useEffect(()=>{r&&r.lat&&r.lng&&k(r)},[r]);const I=E=>{if(!E.latLng)return;const T={lat:E.latLng.lat(),lng:E.latLng.lng()};k(T),C(T)},Y=E=>{if(E.latLng){const T={lat:E.latLng.lat(),lng:E.latLng.lng()};k(T),C(T)}};return e.jsx("div",{style:{height:"450px",width:"100%"},children:e.jsx(po,{center:t||{lat:0,lng:0},zoom:v,mapContainerStyle:{height:"400px",width:"100%",marginTop:"10px"},onClick:I,children:t&&e.jsx(ho,{position:t,draggable:!0,onDragEnd:Y})})})},na=re().shape({nombre_servicio:L().required("El nombre del servicio es requerido"),descripcion:L().required("La descripción es requerida"),uid_categoria:L().required("La categoría es requerida"),precio:L().required("El precio es requerido"),garantia:L().required("La garantía es requerida"),typeService:L().required("El tipo de servicio es requerido")}),ia=({isOpen:r,onClose:C,service:t,onServiceUpdated:k})=>{const[v,I]=c.useState([]),[Y,E]=c.useState([]),[T,B]=c.useState([]),[ne,$]=c.useState(!1),[R,O]=c.useState(null),[V,H]=c.useState(!1);c.useEffect(()=>{(async()=>{var n;if(!(!r||!t)){$(!0);try{const h=Se(G(S,"Categorias"),Ce("estatus","==",!0)),g=(await J(h)).docs.map(d=>({id:d.id,...d.data()}));I(g);const i=await Ue(D(S,"talleres","talleres"));i.exists()&&B(i.data().talleres||[]);const u={nombre_servicio:(t==null?void 0:t.nombre_servicio)||"",descripcion:(t==null?void 0:t.descripcion)||"",uid_categoria:(t==null?void 0:t.uid_categoria)||"",nombre_categoria:(t==null?void 0:t.nombre_categoria)||"",service_image:(t==null?void 0:t.service_image)||(t==null?void 0:t.imagenes)||[],service_image_files:[],uid_taller:(t==null?void 0:t.uid_taller)||"",taller:(t==null?void 0:t.taller)||"",precio:((n=t==null?void 0:t.precio)==null?void 0:n.toString())||"",garantia:(t==null?void 0:t.garantia)||"",typeService:(t==null?void 0:t.typeService)||"local",subcategoria:(t==null?void 0:t.subcategoria)||[]};console.log("Service data:",t),console.log("Initial values:",u),O(u),t!=null&&t.uid_categoria&&await p(t.uid_categoria)}catch(h){console.error("Error loading data:",h),j.push(e.jsx(b,{title:"Error",children:"Error al cargar los datos"}))}finally{$(!1)}}})()},[r,t]),c.useEffect(()=>{R!=null&&R.uid_categoria&&v.length>0&&p(R.uid_categoria)},[R==null?void 0:R.uid_categoria,v.length]);const p=async m=>{if(!m){E([]);return}try{const n=Se(G(S,"Categorias",m,"Subcategorias"),Ce("estatus","==",!0)),N=(await J(n)).docs.map(g=>({id:g.id,...g.data()}));console.log("Subcategories loaded:",N),E(N)}catch(n){console.error("Error loading subcategories:",n),E([])}},ie=async(m,n)=>{const h=[];for(let N=0;N<m.length;N++){const g=m[N],i=Date.now(),u=`${n}_${i}_${N}.jpg`,d=we($e,`service_images/${u}`);try{await qe(d,g);const x=await ze(d);h.push(x)}catch(x){throw console.error("Error uploading image:",x),new Error(`Error al subir la imagen ${N+1}`)}}return h},X=async m=>{try{if(!(t!=null&&t.uid_servicio)){j.push(e.jsx(b,{title:"Error",children:"No se pudo identificar el servicio a editar"}));return}H(!0);let n=[...m.service_image||[]];if(m.service_image_files&&m.service_image_files.length>0)try{const N=await ie(m.service_image_files,t.uid_servicio);n=[...n.filter(i=>!i.startsWith("blob:")),...N]}catch(N){console.error("Error uploading images:",N),j.push(e.jsx(b,{title:"Error",children:"Error al subir las imágenes"})),H(!1);return}else n=n.filter(N=>!N.startsWith("blob:"));const h=D(S,"Servicios",t.uid_servicio);await Q(h,{nombre_servicio:m.nombre_servicio,descripcion:m.descripcion,uid_categoria:m.uid_categoria,nombre_categoria:m.nombre_categoria,precio:m.precio,garantia:m.garantia,typeService:m.typeService,subcategoria:m.subcategoria,service_image:n,uid_taller:t.uid_taller,taller:t.taller,updatedAt:new Date}),j.push(e.jsx(b,{title:"Éxito",children:"Servicio actualizado correctamente"})),k==null||k(),C()}catch(n){console.error("Error updating service:",n),j.push(e.jsx(b,{title:"Error",children:"No se pudo actualizar el servicio"}))}finally{H(!1)}};return!t||!R?null:e.jsxs(mo,{isOpen:r,onClose:C,className:"rounded-md shadow w-full max-w-2xl",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Editar Servicio"}),ne&&e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),e.jsx(uo,{initialValues:R,validationSchema:na,onSubmit:X,enableReinitialize:!0,children:({values:m,handleChange:n,setFieldValue:h,errors:N,touched:g})=>e.jsxs(go,{className:"flex flex-col space-y-6",children:[e.jsx("div",{className:"mt-2 flex flex-col items-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10",children:e.jsxs("div",{className:"text-center",children:[Array.isArray(m.service_image)&&m.service_image.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:m.service_image.map((i,u)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:i,alt:`Imagen del servicio ${u+1}`,className:"h-32 w-full object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:()=>{const d=m.service_image.filter((x,_)=>_!==u);h("service_image",d)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600",children:"×"})]},u))}):e.jsx(Ke,{className:"mx-auto h-12 w-12 text-gray-300","aria-hidden":"true"}),e.jsx("div",{className:"mt-4 flex flex-col text-sm leading-6 text-gray-600 justify-center",children:e.jsxs("label",{htmlFor:"images-upload",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500 flex justify-center items-center",children:[e.jsx("span",{children:"Agregar otra imagen"}),e.jsx("input",{id:"images-upload",name:"images-upload",type:"file",accept:"image/*",multiple:!0,className:"sr-only",onChange:i=>{const u=Array.from(i.target.files||[]),d=u.map(x=>URL.createObjectURL(x));h("service_image",[...m.service_image||[],...d]),h("service_image_files",[...m.service_image_files||[],...u])}})]})})]})}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Nombre Servicio:"}),e.jsx(A,{type:"text",name:"nombre_servicio",value:m.nombre_servicio,onChange:n,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(P,{name:"nombre_servicio",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Tipo de Servicio:"}),e.jsxs("div",{className:"flex items-center space-x-10",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(A,{type:"radio",name:"typeService",value:"local",className:"form-radio"}),e.jsx("span",{children:"En el Local"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(A,{type:"radio",name:"typeService",value:"domicilio",className:"form-radio"}),e.jsx("span",{children:"A Domicilio"})]})]}),e.jsx(P,{name:"typeService",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Categoría:"}),e.jsxs(A,{as:"select",name:"uid_categoria",value:m.uid_categoria,onChange:i=>{const u=i.target.value,d=v.find(x=>x.id===u);h("uid_categoria",u),h("nombre_categoria",(d==null?void 0:d.nombre)||""),h("subcategoria",[]),p(u)},className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"",children:"Seleccione una categoría"}),v.map(i=>e.jsx("option",{value:i.id,children:i.nombre},i.id))]}),e.jsx(P,{name:"uid_categoria",component:"div",className:"text-red-600 text-sm"})]}),e.jsx("label",{className:"font-semibold text-gray-700",children:"Subcategorías:"}),e.jsx(Xo,{isMulti:!0,placeholder:"Selecciona subcategorías",noOptionsMessage:()=>"No hay Subcategorías disponibles",options:m.uid_categoria?Y.map(i=>({value:i.id,label:i.nombre})):[],value:Array.isArray(m.subcategoria)?m.subcategoria.map(i=>({value:i.uid_subcategoria||i.id,label:i.nombre_subcategoria||i.nombre})):[],onChange:i=>h("subcategoria",i.map(u=>({uid_subcategoria:u.value,nombre_subcategoria:u.label}))),className:"mt-1"}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Descripción:"}),e.jsx(A,{as:"textarea",name:"descripcion",value:m.descripcion,onChange:n,rows:1,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 resize-none overflow-hidden",style:{maxHeight:"150px",overflowY:"auto"},onInput:i=>{i.target.style.height="auto",i.target.style.height=`${i.target.scrollHeight}px`}}),e.jsx(P,{name:"descripcion",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Precio:"}),e.jsx(A,{type:"text",name:"precio",value:m.precio,onChange:n,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(P,{name:"precio",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Garantía:"}),e.jsx(A,{type:"text",name:"garantia",value:m.garantia,onChange:n,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(P,{name:"garantia",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(W,{variant:"default",onClick:C,className:"mr-2",disabled:V,children:"Cancelar"}),e.jsx(W,{type:"submit",style:{backgroundColor:"#000B7E"},className:"text-white hover:opacity-80",disabled:V,children:V?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Guardando..."]}):"Guardar"})]})]})})]})},Ps=()=>{var eo,oo,ao;const[r,C]=c.useState(null),[t,k]=c.useState(!1);c.useState(null);const[v,I]=c.useState([]),[Y,E]=c.useState([]),[T,B]=c.useState(!0);c.useState(!1);const[ne,$]=c.useState(!1),[R,O]=c.useState(!1),[V,H]=c.useState(null),[p,ie]=c.useState({fecha_fin:te,fecha_inicio:te,nombre:"",cantidad_servicios:0,monto:0,status:"",vigencia:"",uid:"",fechaCreacion:te.fromDate(new Date)}),[X,m]=c.useState([]),[n,h]=c.useState({image_perfil:"",nombre:"",email:"",phone:"",rif:"",status:"",Direccion:"",ubicacion:{lat:0,lng:0},LinkFacebook:"",LinkTiktok:"",LinkInstagram:"",estado:"",whatsapp:"",newLogoFile:null});c.useState(null);const[N,g]=c.useState({pagoMovil:!1,transferencia:!1,puntoVenta:!1,zinli:!1,efectivo:!1,zelle:!1,tarjetaCreditoN:!1,tarjetaCreditoI:!1}),i=location.pathname.substring(location.pathname.lastIndexOf("/")+1),u=Mo(),d=To(o=>o.auth.user.authority),x=d==null?void 0:d.includes("Admin"),_=async()=>{B(!0);try{const o=D(S,"Usuarios",i),s=(await Ue(o)).data()||null,y=(s==null?void 0:s.metodos_pago)||{};g(w=>({...w,...y}));const f=(s==null?void 0:s.subscripcion_actual)||null;k(!!f);const Z=Se(G(S,"Subscripciones"),Ce("taller_uid","==",i)),xe=(await J(Z)).docs.map(w=>{const l=w.data();return{uid:w.id,nombre:l.nombre||"",monto:l.monto||"0",vigencia:l.vigencia||"",status:l.status||"",cantidad_servicios:l.cantidad_servicios||0,fecha_fin:l.fecha_fin||"no hay fecha",fecha_inicio:l.fecha_inicio||"no hay fecha",taller_uid:l.taller_uid||"",fechaCreacion:te.fromDate(new Date)}}),K=Se(G(S,"Servicios"),Ce("uid_taller","==",i)),fe=(await J(K)).docs.map(w=>{const l=w.data();return{uid_servicio:w.id,nombre_servicio:(l==null?void 0:l.nombre_servicio)||"",descripcion:(l==null?void 0:l.descripcion)||"",precio:(l==null?void 0:l.precio)||"0",estatus:l==null?void 0:l.estatus,taller:(l==null?void 0:l.taller)||"",puntuacion:(l==null?void 0:l.puntuacion)||"0",uid_taller:(l==null?void 0:l.uid_taller)||"",uid_categoria:(l==null?void 0:l.uid_categoria)||"",nombre_categoria:(l==null?void 0:l.nombre_categoria)||"",subcategoria:(l==null?void 0:l.subcategoria)||[],garantia:(l==null?void 0:l.garantia)||"",typeService:(l==null?void 0:l.typeService)||"local",service_image:(l==null?void 0:l.service_image)||(l==null?void 0:l.imagenes)||[]}}),be=(await J(G(S,"Planes"))).docs.map(w=>({uid:w.id,nombre:w.data().nombre||"",descripcion:w.data().descripcion||"",monto:w.data().monto||0,status:w.data().status||"",vigencia:w.data().vigencia||"",cantidad_servicios:w.data().cantidad_servicios||0}));C(s),I(fe),console.log(fe),E(be),ie(f),m(xe);const ce=f==null?void 0:f.fecha_fin;if(ce){const w=le(ce);console.log("aqui la vigencia w",w),H(w)}h({nombre:(s==null?void 0:s.nombre)??"",image_perfil:(s==null?void 0:s.image_perfil)??"",email:(s==null?void 0:s.email)??"",phone:(s==null?void 0:s.phone)??"",rif:(s==null?void 0:s.rif)??"",status:(s==null?void 0:s.status)??"",Direccion:(s==null?void 0:s.Direccion)??"",LinkFacebook:(s==null?void 0:s.LinkFacebook)??"",LinkInstagram:(s==null?void 0:s.LinkInstagram)??"",LinkTiktok:(s==null?void 0:s.LinkTiktok)??"",whatsapp:(s==null?void 0:s.whatsapp)??"",estado:(s==null?void 0:s.estado)??"",ubicacion:s!=null&&s.ubicacion?{lat:s.ubicacion.lat,lng:s.ubicacion.lng}:{lat:0,lng:0},newLogoFile:(s==null?void 0:s.newLogoFile)??null})}catch(o){console.error("Error al obtener los datos del cliente:",o),j.push(e.jsx(b,{title:"Error",children:"Ocurrio un error al cargar los datos del cliente."}))}finally{B(!1)}};c.useEffect(()=>{_()},[]);const le=o=>{const a=Math.floor(Date.now()/1e3),y=o.seconds-a;return Math.ceil(y/(60*60*24))},me=o=>{const a=new Date(o.seconds*1e3),s=String(a.getDate()).padStart(2,"0"),y=String(a.getMonth()+1).padStart(2,"0"),f=a.getFullYear();return`${s}/${y}/${f}`},ve=async o=>{try{const a=D(S,"Usuarios",i),s=D(G(S,"Subscripciones"));await Fo(s,{uid:s.id,nombre:o.nombre,monto:o.monto,vigencia:o.vigencia,cantidad_servicios:o.cantidad_servicios,status:"Por Aprobar",taller_uid:i,fechaCreacion:te.fromDate(new Date)}),await Q(a,{subscripcion_actual:{uid:s.id,nombre:o.nombre,monto:o.monto,vigencia:o.vigencia,cantidad_servicios:o.cantidad_servicios,status:"Por Aprobar"}}),k(!0),await _(),Ge(),console.log("Subscripción actualizada y guardada en Subscripciones."),j.push(e.jsx(b,{title:"Éxito",type:"success",children:"Se ha subscrito correctamente a este plan."}))}catch(a){console.error("Error al guardar la subscripción:",a),j.push(e.jsx(b,{title:"Error",children:"Ocurrió un error al subscribirse a este plan. Inténtalo nuevamente."}))}},U=({title:o,value:a})=>e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("p",{className:"text-gray-700 dark:text-gray-200 font-semibold",children:a})]}),Ee=(o,a)=>{ge(s=>{const y=s.filter(f=>f.id!==o);return a!==""&&y.push({id:o,value:a}),y})},F=o=>{const{name:a,value:s}=o.target;h(y=>({...y,[a]:s}))},[ee,xo]=c.useState({facebook:"",instagram:"",tiktok:"",whatsapp:""}),fo=(o,a)=>({facebook:/^(https?:\/\/)?(www\.)?facebook\.com\/.+$/,instagram:/^(https?:\/\/)?(www\.)?instagram\.com\/.+$/,tiktok:/^(https?:\/\/)?(www\.)?tiktok\.com\/.+$/})[a].test(o)?"":`La URL ingresada no es válida para ${a}.`,_e=(o,a)=>{const{value:s}=o.target;h(f=>({...f,[`Link${a.charAt(0).toUpperCase()+a.slice(1)}`]:s}));const y=fo(s,a);xo(f=>({...f,[a]:y}))},bo=async()=>{var o;if(!n.nombre||n.nombre.trim()===""){j.push(e.jsx(b,{title:"Error",children:"El nombre no puede estar vacío."}));return}if(!n.phone||!/^\d+$/.test(n.phone)||n.phone.startsWith("0")){j.push(e.jsx(b,{title:"Error",children:"El teléfono debe contener solo números y no puede comenzar con 0."}));return}if(n.whatsapp&&(!/^\d+$/.test(n.whatsapp)||n.whatsapp.startsWith("0"))){j.push(e.jsx(b,{title:"Error",children:"El WhatsApp debe contener solo números y no puede comenzar con 0."}));return}if(!n.rif||!/^[JVEGCP]-\d+$/.test(n.rif)){j.push(e.jsx(b,{title:"Error",children:"El RIF debe estar en un formato válido (Ejemplo: J-12345678)."}));return}if(!n.Direccion||n.Direccion.trim()===""){j.push(e.jsx(b,{title:"Error",children:"La Direccion no puede estar vacía."}));return}if(!n.status){j.push(e.jsx(b,{title:"Error",children:"Debes seleccionar un estatus."}));return}if(!n.estado){j.push(e.jsx(b,{title:"Error",children:"Debes seleccionar un estado."}));return}try{const a=G(S,"Usuarios"),s=await J(a);if(s.docs.some(K=>K.data().rif===n.rif&&K.id!==i)){j.push(e.jsx(b,{title:"Error",children:"El RIF ya está registrado. Por favor, verifica e intenta con otro."}));return}if(s.docs.some(K=>K.data().phone===n.phone&&K.id!==i)){j.push(e.jsx(b,{title:"Error",children:"El teléfono ya está registrado. Por favor, verifica e intenta con otro."}));return}let Z=n.image_perfil;if(n.newLogoFile){const ae=(o=decodeURIComponent(n.image_perfil).split("/").pop())==null?void 0:o.split("?")[0],fe=`${i}_`,De=ae==null?void 0:ae.match(/_(\d+)\.jpg$/),be=De?parseInt(De[1],10):0,ce=`${fe}${be+1}.jpg`;console.log(ae,be,ce);const w=we($e,`profileImages/${ae}`);try{await Bo(w)}catch(Do){console.error("Error al eliminar la imagen anterior:",Do)}const l=we($e,`profileImages/${ce}`);await qe(l,n.newLogoFile),Z=await ze(l)}const M=D(S,"Usuarios",i),xe={...n,image_perfil:Z};delete xe.newLogoFile,await Q(M,xe),C({...n,image_perfil:Z}),O(!1),_(),j.push(e.jsx(b,{title:"Éxito",type:"success",children:"Datos de Usuario actualizados correctamente."}))}catch(a){console.error("Error al actualizar los datos:",a),j.push(e.jsx(b,{title:"Error",children:"Ocurrió un error al actualizar los datos del usuario. Inténtalo nuevamente."}))}},jo=async()=>{try{const o=D(S,"Usuarios",i);await Q(o,{metodos_pago:N}),j.push(e.jsx(b,{title:"Éxito",type:"success",children:"Métodos de pago actualizados correctamente."}))}catch(o){console.error("Error al guardar los métodos de pago:",o),j.push(e.jsx(b,{title:"Error",children:"Ocurrió un error al actualizar los métodos de pago. Inténtalo nuevamente."}))}},No=[{name:"Pago móvil",icon:e.jsx(oa,{}),dbKey:"pagoMovil"},{name:"Transferencias bancarias",icon:e.jsx(ea,{}),dbKey:"transferencia"},{name:"Punto de venta",icon:e.jsx(Ie,{}),dbKey:"puntoVenta"},{name:"Zinli",icon:e.jsx(ro,{}),dbKey:"zinli"},{name:"Efectivo",icon:e.jsx(ro,{}),dbKey:"efectivo"},{name:"Zelle",icon:e.jsx(aa,{}),dbKey:"zelle"},{name:"Tarjetas de crédito nacional",icon:e.jsx(Ie,{}),dbKey:"tarjetaCreditoN"},{name:"Tarjetas de crédito internacional",icon:e.jsx(Ie,{}),dbKey:"tarjetaCreditoI"}],Ge=()=>$(!1),yo=()=>O(!0),[ue,ge]=c.useState([]),[ke,Re]=c.useState([]),{TabNav:Ve,TabList:wo,TabContent:He}=io,Co=[{header:"Nombre del Servicio",accessorKey:"nombre_servicio"},{header:"Precio",accessorKey:"precio",cell:({row:o})=>`$${parseFloat(o.original.precio).toFixed(2)}`},{header:"Estatus",accessorKey:"estatus",cell:({row:o})=>{const[a,s]=c.useState(o.original.estatus??!1),y=async f=>{s(f);const Z=v.map(M=>M.uid_servicio===o.original.uid_servicio?{...M,estatus:f}:M);I(Z);try{const M=D(S,"Servicios",o.original.uid_servicio);await Q(M,{estatus:f}),console.log("Estado del servicio actualizado")}catch(M){console.error("Error al actualizar el estado del servicio:",M)}};return e.jsx("div",{children:e.jsx(qo,{checked:a,onChange:()=>y(!a)})})}},{header:"Acciones",id:"actions",cell:({row:o})=>e.jsx("div",{className:"",children:e.jsx(W,{size:"sm",variant:"solid",onClick:()=>Ao(o.original),className:"text-blue-900 hover:bg-blue-700",children:e.jsx(Wo,{})})})}],So=[{header:"Nombre del Plan",accessorKey:"nombre"},{header:"Monto",accessorKey:"monto"},{header:"Descripcion",accessorKey:"descripcion"},{header:"Cantidad de servicios",accessorKey:"cantidad_servicios"}],vo=[{header:"Nombre del Plan",accessorKey:"nombre"},{header:"Monto",accessorKey:"monto"},{header:"vigencia",accessorKey:"vigencia"},{header:"Fecha de vencimiento",accessorKey:"fecha_fin",cell:({row:o})=>`${me(o.original.fecha_fin)}`}],{Tr:oe,Th:pe,Td:he,THead:Le,TBody:Ae,Sorter:la}=je,Pe=Me({data:v,columns:Co,state:{sorting:ke,columnFilters:ue},onSortingChange:Re,onColumnFiltersChange:ge,getCoreRowModel:Te(),getSortedRowModel:Fe(),getFilteredRowModel:Be()}),Ze=Me({data:Y,columns:So,state:{sorting:ke,columnFilters:ue},onSortingChange:Re,onColumnFiltersChange:ge,getCoreRowModel:Te(),getSortedRowModel:Fe(),getFilteredRowModel:Be()}),We=Me({data:X,columns:vo,state:{sorting:ke,columnFilters:ue},onSortingChange:Re,onColumnFiltersChange:ge,getCoreRowModel:Te(),getSortedRowModel:Fe(),getFilteredRowModel:Be()}),[q,Eo]=c.useState(1),z=6,Je=Pe.getRowModel().rows.length,Qe=o=>{console.log("onPaginationChange",o),Eo(o)};console.log("data del taller",n);const[_o,ko]=c.useState(!1),[Ro,Ye]=c.useState(!1),[Lo,Xe]=c.useState(null),Oe=()=>{ko(o=>!o)},Ao=o=>{Xe(o),Ye(!0)},Po=()=>{Ye(!1),Xe(null)},Oo=()=>{_()};return e.jsxs($o,{className:"min-h-screen overflow-y-auto pb-8",children:[x&&e.jsx("div",{className:"flex items-center",children:e.jsxs("button",{onClick:()=>u(`${Uo}/garages`),className:"flex items-center text-blue-900 mb-3 ml-2 px-4 py-2 bg-blue-100 rounded-lg hover:bg-blue-200 transition duration-200",children:[e.jsx(Ko,{className:"mr-2"}),e.jsx("span",{children:"Volver"})]})}),e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 pb-8",children:[e.jsxs(so,{children:[e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{className:"bg-[#1d1e56] rounded-md p-2 hover:bg-[#1E3a8a] text-white",onClick:yo,children:"Editar"})}),e.jsxs("div",{className:"flex flex-col xl:justify-between min-w-[260px] h-full 2xl:min-w-[360px] mx-auto",children:[e.jsxs("div",{className:"flex xl:flex-col items-center gap-4",children:[e.jsx(to,{size:90,shape:"circle",src:(r==null?void 0:r.image_perfil)||"/img/logo/logo-light-streamline.png",className:"p-2 bg-white shadow-lg"}),e.jsx("h4",{className:"font-bold",children:(r==null?void 0:r.nombre)||"Nombre no disponible"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-y-7 gap-x-4 mt-8",children:[e.jsx(U,{title:"Correo electronico",value:(r==null?void 0:r.email)||"Correo no disponible"}),e.jsx(U,{title:"Numero de telefono",value:(r==null?void 0:r.phone)||"Telefono no disponible"}),e.jsx(U,{title:"Rif",value:(r==null?void 0:r.rif)||"Rif no disponible"}),e.jsx(U,{title:"Estado",value:(r==null?void 0:r.estado)||"Estado no disponible"}),e.jsx(U,{title:"Estatus",value:(r==null?void 0:r.status)||"Estatus no disponible"}),e.jsx(U,{title:"Direccion",value:(r==null?void 0:r.Direccion)||"Direccion no disponible"}),r!=null&&r.ubicacion?e.jsx(ta,{center:{lat:r.ubicacion.lat,lng:r.ubicacion.lng},markers:[{lat:r.ubicacion.lat,lng:r.ubicacion.lng}]}):"Ubicación no disponible",e.jsxs("div",{className:"mb-7",children:[e.jsx("span",{children:"Redes Sociales"}),e.jsx("div",{className:"flex mt-4 gap-2",children:r!=null&&r.LinkFacebook||r!=null&&r.LinkInstagram||r!=null&&r.whatsapp||r!=null&&r.LinkTiktok?e.jsxs(e.Fragment,{children:[r.LinkFacebook&&e.jsx("a",{href:r.LinkFacebook,target:"_blank",rel:"noopener noreferrer",title:r.LinkFacebook,children:e.jsx(W,{shape:"circle",size:"sm",icon:e.jsx(Go,{className:"text-[#1773ea]"})})}),r.LinkInstagram&&e.jsx("a",{href:r.LinkInstagram,target:"_blank",rel:"noopener noreferrer",title:r.LinkInstagram,children:e.jsx(W,{shape:"circle",size:"sm",icon:e.jsx(Vo,{className:"text-[#E1306C]"})})}),r.LinkTiktok&&e.jsx("a",{href:r.LinkTiktok,target:"_blank",rel:"noopener noreferrer",title:r.LinkTiktok,children:e.jsx(W,{shape:"circle",size:"sm",icon:e.jsx(Ho,{className:"text-black"})})}),r.whatsapp&&e.jsx("a",{href:`https://wa.me/${r.whatsapp}?text=${encodeURIComponent("Hola, quiero más información sobre el servicio")}`,target:"_blank",rel:"noopener noreferrer",title:r.whatsapp,children:e.jsx(W,{shape:"circle",size:"sm",icon:e.jsx(Zo,{className:"text-[#25d366]"})})})]}):e.jsx("p",{className:"text-gray-500",children:"No hay redes sociales disponibles"})})]})]})]})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs(io,{defaultValue:"tab1",children:[e.jsxs(wo,{children:[e.jsx(Ve,{value:"tab1",children:"Planes"}),e.jsx(Ve,{value:"tab2",children:"Servicios"})]}),e.jsx("div",{className:"w-full",children:e.jsx(He,{value:"tab1",children:e.jsxs("div",{className:"mb-8 mt-4",children:[e.jsx("h6",{className:"mb-4",children:"Subscripción"}),e.jsx(so,{bordered:!0,className:"mb-4",children:t?e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 p-4 border rounded-lg shadow-md bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(to,{className:"bg-transparent",shape:"circle",icon:e.jsx(Qo,{className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:(p==null?void 0:p.nombre)||"Cargando..."}),e.jsx(Jo,{className:`rounded-md border-0 mx-2 ${(p==null?void 0:p.status)==="Aprobado"?"bg-green-100 text-green-400":"bg-yellow-100 text-yellow-400"}`,children:(p==null?void 0:p.status)||"Pendiente"})]}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Vigencia:"," ",(p==null?void 0:p.vigencia)??"---"," ","días"]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Monto mensual:"," ",e.jsxs("span",{className:"font-bold text-gray-800",children:["$",(p==null?void 0:p.monto)??"---"]})]}),(p==null?void 0:p.status)==="Aprobado"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs ml-2 text-gray-600",children:[V??"---"," ","días restantes"]}),e.jsxs("p",{className:"text-xs ml-2 text-gray-600",children:["Fecha de vencimiento:"," ",e.jsx("span",{className:"text-xs text-gray-600",children:p.fecha_fin?me(p.fecha_fin):"Fecha no disponible"})]})]})]})]})]}),(p==null?void 0:p.status)==="Por Aprobar"&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx(sa,{talleruid:i,subscriptionId:(eo=X[0])==null?void 0:eo.uid})})]}):e.jsxs("div",{className:"flex justify-end",children:[e.jsx("p",{className:"text-xs mr-64 mt-3",children:"Puede visualizar y suscribirse a un plan para su taller..."}),e.jsx("button",{onClick:()=>$(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition duration-200",children:"Ver Planes"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"p-4 rounded-lg shadow",children:[e.jsx("h6",{className:"mb-6 flex justify-start mt-4",children:"Historial de Subscripciones"}),e.jsxs(je,{className:"w-full rounded-lg",children:[e.jsx(Le,{children:We.getHeaderGroups().map(o=>e.jsx(oe,{children:o.headers.map(a=>e.jsx(pe,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsx("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:se(a.column.columnDef.header,a.getContext())})},a.id))},o.id))}),e.jsx(Ae,{children:We.getRowModel().rows.slice((q-1)*z,q*z).map(o=>e.jsx(oe,{children:o.getVisibleCells().map(a=>e.jsx(he,{children:se(a.column.columnDef.cell,a.getContext())},a.id))},o.id))})]}),e.jsx(no,{onChange:Qe,currentPage:q,totalRows:Je,rowsPerPage:z})]})}),e.jsx("div",{className:"border-t border-gray-300 my-4"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 p-4",children:No.map(o=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Yo,{checked:N[o.dbKey]||!1,onChange:a=>{g(s=>({...s,[o.dbKey]:a}))}}),e.jsx("span",{children:o.icon}),e.jsx("span",{children:o.name})]},o.name))}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:jo,className:"px-4 py-2 bg-[#1d1e56] text-white rounded-md hover:bg-blue-900 focus:outline-none",children:"Guardar"})})]})})}),e.jsx(He,{value:"tab2",children:e.jsx("div",{className:"w-full h-full",children:e.jsxs("div",{className:"p-4 rounded-lg",children:[e.jsx("h6",{className:"mb-6 flex justify-start mt-4",children:"Lista de Servicios"}),e.jsxs(je,{className:"w-full rounded-lg",children:[e.jsx(Le,{children:Pe.getHeaderGroups().map(o=>e.jsx(oe,{children:o.headers.map(a=>e.jsx(pe,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsx("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:se(a.column.columnDef.header,a.getContext())})},a.id))},o.id))}),e.jsx(Ae,{children:Pe.getRowModel().rows.slice((q-1)*z,q*z).map(o=>e.jsx(oe,{children:o.getVisibleCells().map(a=>e.jsx(he,{children:se(a.column.columnDef.cell,a.getContext())},a.id))},o.id))})]}),e.jsx(no,{onChange:Qe,currentPage:q,totalRows:Je,rowsPerPage:z})]})})})]})})]}),e.jsx(co,{width:1e3,isOpen:ne,onClose:Ge,children:e.jsxs("div",{className:"table-responsive",children:[e.jsx("h2",{className:"mb-4",children:"Planes de Subscripción"}),e.jsx("div",{className:"p-2 rounded-lg shadow",children:e.jsxs(je,{className:"w-full rounded-lg",children:[e.jsx(Le,{children:Ze.getHeaderGroups().map(o=>e.jsxs(oe,{children:[o.headers.map(a=>{var s,y;return e.jsx(pe,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsxs("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:[se(a.column.columnDef.header,a.getContext()),a.column.getCanFilter()?e.jsx("input",{type:"text",value:((y=(s=ue.find(f=>f.id===a.id))==null?void 0:s.value)==null?void 0:y.toString())||"",onChange:f=>Ee(a.id,f.target.value),placeholder:"Buscar",className:"mt-2 p-1 border rounded",onClick:f=>f.stopPropagation()}):null]})},a.id)}),e.jsx(pe,{children:"Acción"})," "]},o.id))}),e.jsx(Ae,{children:Ze.getRowModel().rows.slice((q-1)*z,q*z).map(o=>e.jsxs(oe,{children:[o.getVisibleCells().map(a=>e.jsx(he,{children:se(a.column.columnDef.cell,a.getContext())},a.id)),e.jsx(he,{children:e.jsx("button",{className:"bg-[#1d1e56] text-white px-4 py-2 rounded",onClick:()=>ve(o.original),children:"Suscribirse"})})]},o.id))})]})})]})}),R&&e.jsx(zo,{isOpen:R,title:"Editar Taller",confirmButtonColor:"blue-600",onClose:()=>O(!1),onRequestClose:()=>O(!1),onCancel:()=>O(!1),onConfirm:bo,children:e.jsxs("div",{className:"max-h-[450px] overflow-y-auto",children:[e.jsx("div",{className:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10 gap-2",children:e.jsxs("div",{className:"text-center",children:[!n.image_perfil&&!n.newLogoFile?e.jsx(Ke,{className:"mx-auto h-12 w-12 text-gray-300","aria-hidden":"true"}):e.jsxs("div",{children:[e.jsx("img",{src:n.newLogoFile?URL.createObjectURL(n.newLogoFile):n.image_perfil,alt:"Preview Logo",className:"mx-auto h-32 w-32 object-cover"}),e.jsx("button",{onClick:()=>h(o=>({...o,newLogoFile:null,image_perfil:""})),className:"mt-2 text-red-500 hover:text-red-700",children:"Quitar Logo"})]}),e.jsx("div",{className:"mt-4 flex text-sm leading-6 text-gray-600 justify-center",children:e.jsxs("label",{htmlFor:"logo-upload",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500 flex justify-center items-center",children:[e.jsx("span",{children:n.newLogoFile?"Cambiar Logo":"Seleccionar Logo"}),e.jsx("input",{id:"logo-upload",name:"logo-upload",type:"file",accept:"image/*",className:"sr-only",onChange:o=>{var s;const a=(s=o.target.files)==null?void 0:s[0];h(y=>({...y,newLogoFile:a||null}))}})]})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Nombre"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Nombre",name:"nombre",value:n.nombre,onChange:F})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Correo Electrónico"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Correo Electrónico",disabled:!0,name:"email",value:n.email,onChange:F})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Teléfono"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Teléfono",name:"phone",value:n.phone,onChange:F})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"WhatsApp"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"WhatsApp",name:"whatsapp",value:n.whatsapp,onChange:F})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"RIF:"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsxs("select",{value:((oo=n.rif)==null?void 0:oo.split("-")[0])||"J",onChange:o=>h(a=>{var s;return{...a,rif:`${o.target.value}-${((s=a==null?void 0:a.rif)==null?void 0:s.split("-")[1])||""}`}}),className:"mx-2 p-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"J",children:"J-"}),e.jsx("option",{value:"V",children:"V-"}),e.jsx("option",{value:"E",children:"E-"}),e.jsx("option",{value:"C",children:"C-"}),e.jsx("option",{value:"G",children:"G-"}),e.jsx("option",{value:"P",children:"P-"})]}),e.jsx("input",{disabled:!0,type:"text",value:((ao=n.rif)==null?void 0:ao.split("-")[1])||"",onChange:o=>h(a=>{var s;return{...a,rif:`${((s=a==null?void 0:a.rif)==null?void 0:s.split("-")[0])||"J"}-${o.target.value}`}}),className:"p-3 border border-gray-300 rounded-r-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 mx-2 w-full"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Estado:"}),e.jsxs("select",{name:"estado",value:n.estado,onChange:F,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"",children:"Seleccione un Estado"}),["Amazonas","Anzoátegui","Apure","Aragua","Barinas","Bolívar","Carabobo","Cojedes","Delta Amacuro","Distrito Capital","Falcón","Guárico","Lara","La Guaira","Mérida","Miranda","Monagas","Nueva Esparta","Portuguesa","Sucre","Táchira","Trujillo","Yaracuy","Zulia"].map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Direccion"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"",name:"Direccion",value:n.Direccion,onChange:F})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Mapa"}),e.jsx("button",{type:"button",className:"w-full mt-1 p-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring focus:ring-blue-300",onClick:Oe,children:"Abrir Mapa"})]}),_o&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-3xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Editar ubicación"}),e.jsx("button",{className:"text-gray-600 hover:text-gray-800 focus:outline-none",onClick:Oe,children:"✖"})]}),e.jsx(ra,{initialLocation:{lat:n.ubicacion.lat,lng:n.ubicacion.lng},onLocationChange:o=>h(a=>({...a,ubicacion:o}))}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring focus:ring-blue-300",onClick:Oe,children:"Guardar"})})]})}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Estatus"}),e.jsxs("select",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",name:"status",value:n.status,onChange:F,children:[e.jsx("option",{value:"Aprobado",children:"Aprobado"}),e.jsx("option",{value:"Pendiente",children:"Pendiente"}),e.jsx("option",{value:"Rechazado",children:"Rechazado"}),e.jsx("option",{value:"En espera por aprobación",children:"En espera por aprobación"})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Facebook"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de Facebook",name:"LinkFacebook",value:n.LinkFacebook,onChange:o=>_e(o,"facebook")}),ee.facebook&&e.jsx("span",{className:"text-red-500 text-sm",children:ee.facebook})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Instagram"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de Instagram",name:"LinkInstagram",value:n.LinkInstagram,onChange:o=>_e(o,"instagram")}),ee.instagram&&e.jsx("span",{className:"text-red-500 text-sm",children:ee.instagram})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"TikTok"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de TikTok",name:"LinkTiktok",value:n.LinkTiktok,onChange:o=>_e(o,"tiktok")}),ee.tiktok&&e.jsx("span",{className:"text-red-500 text-sm",children:ee.tiktok})]})]})]})}),e.jsx(ia,{isOpen:Ro,onClose:Po,service:Lo,onServiceUpdated:Oo})]})};export{Ps as default};
