import{a as B,r as y,j as e,T as q,a4 as S,a5 as K}from"./index-zN_cMCXj.js";import{C as L}from"./Views-zD_Q7SBY.js";import{A as P}from"./AdaptableCard-Z9nht5s7.js";import{C as z}from"./Card-q0IeE3mQ.js";import{B as m}from"./Button-3FDHFgBt.js";import{T as M}from"./Tooltip-TmV83Zem.js";import{D as f}from"./index-mBZpBLg-.js";import{T as U}from"./TextEllipsis-qbkXf-YG.js";import{U as F}from"./UsersAvatarGroup-q5k9OJPx.js";import{D as T}from"./Dialog-1b1ZmvQp.js";import{I}from"./Input-jjp4yHHW.js";import{C as O}from"./ConfirmDialog-m2tgk5nn.js";import{u as d,t as w,s as C,a as N,b as R,c as V,g as G,d as k,r as Q}from"./index-rEfMQx4G.js";import{c as j}from"./cloneDeep-hY89VSV4.js";import{a as J}from"./useUniqueId-mGBrdPHP.js";import{a9 as W,ab as X,z as Y,aI as Z,R as _,Q as ee}from"./index.esm-Wztopsom.js";import{m as te}from"./motion-TPlYCOYk.js";import"./context-4K_It7vM.js";import"./index.esm-qF4ozkmo.js";import"./floating-ui.react-NPg6DBrp.js";import"./floating-ui.dom-0rLBacrf.js";import"./index-e95nRWq5.js";import"./useRootClose-5KdsbEvo.js";import"./isNil-MbCIHf64.js";import"./chainedFunction-ltcSYACe.js";import"./index-_o3pW7qI.js";import"./index-02QlkbFi.js";import"./useMergeRef-Rt_Crb27.js";import"./useTwColorByName-o1043egF.js";import"./index-tw4ez8WU.js";import"./index-Aw7A1Eb2.js";import"./CloseButton-thKRAv7B.js";import"./get-wdqsSC5n.js";import"./_MapCache-mUj7I7Ze.js";import"./toString-3FE3Yt23.js";import"./KnowledgeBaseService-XbYTX0Fg.js";import"./ApiService-pW-w6BK2.js";import"./_getAllKeys-josaXZHF.js";const se=({data:t})=>{const s=B(),l=y.useRef(null),n=y.useRef(null),a=d(o=>o.knowledgeBaseManageArticles.data.articleDeleteConfirmation),A=d(o=>o.knowledgeBaseManageArticles.data.categoryDeleteConfirmation),v=d(o=>o.knowledgeBaseManageArticles.data.categoryRenameDialog),x=d(o=>o.knowledgeBaseManageArticles.data.categoryAddDialog),g=d(o=>o.knowledgeBaseManageArticles.data.selected),u=()=>{s(w(!1))},D=()=>{const c=j(t).map(i=>(i.value===g.categoryValue&&(i.articles=i.articles.filter($=>$.id!==g.id)),i));s(w(!1)),s(C(c))},p=()=>{s(N(!1))},h=()=>{const c=j(t).map(i=>(i.value===g.categoryValue&&l.current&&(i.label=l.current.value),i));s(N(!1)),s(C(c))},r=()=>{s(R(!1))},E=()=>{const c=j(t).filter(i=>i.value!==g.categoryValue);s(R(!1)),s(C(c))},b=()=>{s(V(!1))},H=()=>{const o=j(t);if(n.current){const c=[{label:n.current.value,value:J("new-category"),articles:[]},...o];s(C(c))}s(V(!1))};return e.jsxs(e.Fragment,{children:[e.jsx(O,{isOpen:a,type:"danger",title:"Delete article",confirmButtonColor:"red-600",onClose:u,onRequestClose:u,onCancel:u,onConfirm:D,children:e.jsx("p",{children:"Are you sure you want to delete this article? This action cannot be undone."})}),e.jsx(O,{isOpen:A,type:"danger",title:"Delete category",confirmButtonColor:"red-600",onClose:r,onRequestClose:r,onCancel:r,onConfirm:E,children:e.jsx("p",{children:"Are you sure you want to delete this category? All the articles under this category will be deleted as well. All This action cannot be undone."})}),e.jsxs(T,{isOpen:v,onClose:p,onRequestClose:p,children:[e.jsx("h5",{className:"mb-4",children:"Rename Category"}),e.jsx("div",{children:e.jsx(I,{ref:l})}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(m,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:p,children:"Cancel"}),e.jsx(m,{variant:"solid",onClick:h,children:"Confirm"})]})]}),e.jsxs(T,{isOpen:x,onClose:b,onRequestClose:b,children:[e.jsx("h5",{className:"mb-4",children:"Add Category"}),e.jsx("div",{children:e.jsx(I,{ref:n})}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(m,{size:"sm",className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:b,children:"Cancel"}),e.jsx(m,{size:"sm",variant:"solid",onClick:H,children:"Add"})]})]})]})},re=({data:t})=>{var p,h;const s=B(),[l,n]=y.useState(!1),a=S(),A=()=>{n(!l)},v=r=>{a(`/app/knowledge-base/edit-article?id=${r}&categoryLabel=${t.label}&categoryValue=${t.value}`)},x=()=>{a(`/app/knowledge-base/edit-article?categoryLabel=${t.label}&categoryValue=${t.value}`)},g=r=>{s(k({id:r,categoryValue:t.value})),s(w(!0))},u=()=>{s(k({id:"",categoryValue:t.value})),s(N(!0))},D=()=>{s(k({id:"",categoryValue:t.value})),s(R(!0))};return e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1 cursor-pointer select-none",onClick:A,children:[e.jsx("span",{className:"text-lg",children:l?e.jsx(W,{}):e.jsx(X,{})}),e.jsx("h5",{children:t==null?void 0:t.label}),e.jsxs("span",{children:["(",(p=t==null?void 0:t.articles)==null?void 0:p.length,")"]})]}),e.jsx("hr",{className:"mx-3 w-full"}),e.jsxs(f,{placement:"bottom-end",renderTitle:e.jsx(m,{shape:"circle",variant:"plain",icon:e.jsx(Y,{})}),children:[e.jsx(f.Item,{eventKey:"addArticle",onClick:()=>x(),children:"Add article"}),e.jsx(f.Item,{eventKey:"rename",onClick:u,children:"Rename"}),e.jsx(f.Item,{eventKey:"delete",onClick:D,children:"Delete"})]})]}),e.jsxs(te.div,{className:"grid xl:grid-cols-4 lg:grid-cols-3 md:grid-cols-2 grid-cols-1 gap-4 mt-4",initial:{opacity:0,height:0,overflow:"hidden"},animate:{opacity:l?0:1,height:l?0:"auto"},transition:{duration:.15},children:[t.articles.length===0&&e.jsx(z,{clickable:!0,className:"group border-dashed border-2 hover:border-indigo-600",onClick:x,children:e.jsxs("div",{className:"flex flex-col justify-center items-center py-5",children:[e.jsx("div",{className:"p-4 border-2 border-dashed rounded-full border-gray-200 dark:border-gray-600 group-hover:border-indigo-600",children:e.jsx(Z,{className:"text-4xl text-gray-200 dark:text-gray-600 group-hover:text-indigo-600"})}),e.jsx("p",{className:"mt-5 font-semibold",children:"Add article"})]})}),(h=t==null?void 0:t.articles)==null?void 0:h.map(r=>e.jsxs(z,{bordered:!0,children:[e.jsx("h6",{className:"truncate mb-4",children:r.title}),e.jsx("div",{className:"min-h-[60px]",children:e.jsx(U,{text:r.content.replace(/<[^>]*>?/gm,""),maxTextCount:120})}),e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsx(F,{avatarProps:{size:25},users:r.authors||[]}),e.jsxs("div",{className:"flex",children:[e.jsx(M,{title:"Delete",children:e.jsx(m,{shape:"circle",variant:"plain",size:"sm",icon:e.jsx(_,{}),onClick:()=>g(r.id)})}),e.jsx(M,{title:"Edit",children:e.jsx(m,{shape:"circle",variant:"plain",size:"sm",icon:e.jsx(ee,{}),onClick:()=>v(r.id)})})]})]})]},r.id))]})]})},oe=()=>{const t=B(),s=d(a=>a.knowledgeBaseManageArticles.data.loading),l=d(a=>a.knowledgeBaseManageArticles.data.categorizedArticles);y.useEffect(()=>{n()},[]);const n=()=>{t(G())};return e.jsxs(q,{loading:s,children:[l.map(a=>e.jsx(re,{data:a},a.value)),e.jsx(se,{data:l})]})};K("knowledgeBaseManageArticles",Q);const le=()=>e.jsx(L,{children:e.jsx(P,{children:e.jsx(oe,{})})}),Ue=le;export{Ue as default};
