import{a0 as H,a1 as K,a2 as $,a3 as q,a as b,j as e,r as x,a4 as G,L as w,a5 as V}from"./index-15sR2hcI.js";import{a as Q,b as _}from"./SalesService-T-beGC5-.js";import{A as W}from"./AdaptableCard-mtbjqd0n.js";import{A as F}from"./index-fSOw_GH1.js";import{B as J}from"./Badge-XD-JD0V9.js";import{D as U}from"./DataTable-H82jhZxu.js";import{Q as X,R as Y,D as k,aB as Z,aC as ee,aD as te}from"./index.esm-7YOjLpfE.js";import{F as se}from"./index.esm-znsguo7U.js";import{u as ae}from"./useThemeClass-ZgKQ1qvN.js";import{t as oe,N as re}from"./toast-P6fq2JcL.js";import{C as ne}from"./ConfirmDialog-0oh037NZ.js";import{c as P}from"./cloneDeep-EbfvKIqv.js";import{B as j}from"./Button-8f3-31O1.js";import{I as L}from"./Input-CGghpi6_.js";import{d as le}from"./debounce-xwwPQKMN.js";import{F as ce,a as C}from"./FormItem-toxsVl1N.js";import{C as p}from"./index-8Tuh8IVx.js";import{R as D}from"./index-IoQ3-O-_.js";import{D as ie}from"./Drawer-7nbd4JuZ.js";import{F as de,a as me,b as y}from"./formik.esm-P1HfmhXI.js";import"./ApiService-jGhSHqbt.js";import"./Card-Zg6jSWKE.js";import"./useMergeRef-Rt_Crb27.js";import"./Tooltip-JETBhhx_.js";import"./index.esm-yJD-bGj6.js";import"./floating-ui.react-AHIwqOdP.js";import"./floating-ui.dom-0rLBacrf.js";import"./index-og_L5k7n.js";import"./motion-JCtWUOno.js";import"./index-_AoI4hSc.js";import"./index.esm-NmTktVeB.js";import"./index-GUzNXAnV.js";import"./Select-zY8vZJZ4.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./Views-dlAO8rPI.js";import"./get-EUpMBPWH.js";import"./_MapCache-QLynnWSb.js";import"./toString-jIZDmk4m.js";import"./context-3jl7jrYD.js";import"./TableRowSkeleton-mfr0g2Pf.js";import"./Skeleton-tNhEyXDL.js";import"./index-cLQS0p0I.js";import"./useTimeout-_Lr53nR-.js";import"./CloseButton-uxR0B3Ri.js";import"./StatusIcon-N75kIWR0.js";import"./chainedFunction-ltcSYACe.js";import"./Dialog-WmS_iy8i.js";import"./index-0sC441_J.js";import"./index-dpskanKY.js";import"./_getAllKeys-INUY-PHc.js";import"./isNil-3U8VPEAl.js";import"./_baseIsEqual-LfucHAT4.js";const R="salesProductList",f=H(R+"/getProducts",async t=>(await Q(t)).data),ue=async t=>(await _(t)).data,T={total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},pe={loading:!1,deleteConfirmation:!1,selectedProduct:"",productList:[],tableData:T,filterData:{name:"",category:["bags","cloths","devices","shoes","watches"],status:[0,1,2],productStatus:0}},I=K({name:`${R}/state`,initialState:pe,reducers:{updateProductList:(t,s)=>{t.productList=s.payload},setTableData:(t,s)=>{t.tableData=s.payload},setFilterData:(t,s)=>{t.filterData=s.payload},toggleDeleteConfirmation:(t,s)=>{t.deleteConfirmation=s.payload},setSelectedProduct:(t,s)=>{t.selectedProduct=s.payload}},extraReducers:t=>{t.addCase(f.fulfilled,(s,l)=>{s.productList=l.payload.data,s.tableData.total=l.payload.total,s.loading=!1}).addCase(f.pending,s=>{s.loading=!0})}}),{updateProductList:wt,setTableData:N,setFilterData:xe,toggleDeleteConfirmation:S,setSelectedProduct:he}=I.actions,ge=I.reducer,fe=$({data:ge}),h=q,je=()=>{const t=b(),s=h(i=>i.salesProductList.data.deleteConfirmation),l=h(i=>i.salesProductList.data.selectedProduct),m=h(i=>i.salesProductList.data.tableData),c=()=>{t(S(!1))},r=async()=>{t(S(!1)),await ue({id:l})&&(t(f(m)),oe.push(e.jsx(re,{title:"Successfuly Deleted",type:"success",duration:2500,children:"Product successfuly deleted"}),{placement:"top-center"}))};return e.jsx(ne,{isOpen:s,type:"danger",title:"Delete product",confirmButtonColor:"red-600",onClose:c,onRequestClose:c,onCancel:c,onConfirm:r,children:e.jsx("p",{children:"Are you sure you want to delete this product? All record related to this product will be deleted as well. This action cannot be undone."})})},v={0:{label:"In Stock",dotClass:"bg-emerald-500",textClass:"text-emerald-500"},1:{label:"Limited",dotClass:"bg-amber-500",textClass:"text-amber-500"},2:{label:"Out of Stock",dotClass:"bg-red-500",textClass:"text-red-500"}},be=({row:t})=>{const s=b(),{textTheme:l}=ae(),m=G(),c=()=>{m(`/app/sales/product-edit/${t.id}`)},r=()=>{s(S(!0)),s(he(t.id))};return e.jsxs("div",{className:"flex justify-end text-lg",children:[e.jsx("span",{className:`cursor-pointer p-2 hover:${l}`,onClick:c,children:e.jsx(X,{})}),e.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:r,children:e.jsx(Y,{})})]})},Ce=({row:t})=>{const s=t.img?e.jsx(F,{src:t.img}):e.jsx(F,{icon:e.jsx(se,{})});return e.jsxs("div",{className:"flex items-center",children:[s,e.jsx("span",{className:"ml-2 rtl:mr-2 font-semibold",children:t.name})]})},De=()=>{const t=x.useRef(null),s=b(),{pageIndex:l,pageSize:m,sort:c,query:r,total:i}=h(a=>a.salesProductList.data.tableData),o=h(a=>a.salesProductList.data.filterData),n=h(a=>a.salesProductList.data.loading),g=h(a=>a.salesProductList.data.productList);x.useEffect(()=>{z()},[l,m,c]),x.useEffect(()=>{var a;t&&((a=t.current)==null||a.resetSorting())},[o]);const u=x.useMemo(()=>({pageIndex:l,pageSize:m,sort:c,query:r,total:i}),[l,m,c,r,i]),z=()=>{s(f({pageIndex:l,pageSize:m,sort:c,query:r,filterData:o}))},O=x.useMemo(()=>[{header:"Name",accessorKey:"name",cell:a=>{const d=a.row.original;return e.jsx(Ce,{row:d})}},{header:"Category",accessorKey:"category",cell:a=>{const d=a.row.original;return e.jsx("span",{className:"capitalize",children:d.category})}},{header:"Quantity",accessorKey:"stock",sortable:!0},{header:"Status",accessorKey:"status",cell:a=>{const{status:d}=a.row.original;return e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(J,{className:v[d].dotClass}),e.jsx("span",{className:`capitalize font-semibold ${v[d].textClass}`,children:v[d].label})]})}},{header:"Price",accessorKey:"price",cell:a=>{const{price:d}=a.row.original;return e.jsxs("span",{children:["$",d]})}},{header:"",id:"action",cell:a=>e.jsx(be,{row:a.row.original})}],[]),E=a=>{const d=P(u);d.pageIndex=a,s(N(d))},B=a=>{const d=P(u);d.pageSize=Number(a),d.pageIndex=1,s(N(d))},M=a=>{const d=P(u);d.sort=a,s(N(d))};return e.jsxs(e.Fragment,{children:[e.jsx(U,{ref:t,columns:O,data:g,skeletonAvatarColumns:[0],skeletonAvatarProps:{className:"rounded-md"},loading:n,pagingData:{total:u.total,pageIndex:u.pageIndex,pageSize:u.pageSize},onPaginationChange:E,onSelectChange:B,onSort:M}),e.jsx(je,{})]})},ye=()=>{const t=b(),s=x.useRef(null),l=h(o=>o.salesProductList.data.tableData),m=le(c,500);function c(o){const n=P(l);n.query=o,n.pageIndex=1,typeof o=="string"&&o.length>1&&r(n),typeof o=="string"&&o.length===0&&r(n)}const r=o=>{t(N(o)),t(f(o))},i=o=>{m(o.target.value)};return e.jsx(L,{ref:s,className:"max-w-md md:w-52 md:mb-0 mb-4",size:"sm",placeholder:"Search product",prefix:e.jsx(k,{className:"text-lg"}),onChange:i})},A=x.forwardRef(({onSubmitComplete:t},s)=>{const l=b(),m=h(r=>r.salesProductList.data.filterData),c=r=>{t==null||t(),l(xe(r)),l(f(T))};return e.jsx(de,{enableReinitialize:!0,innerRef:s,initialValues:m,onSubmit:r=>{c(r)},children:({values:r,touched:i,errors:o})=>e.jsx(me,{children:e.jsxs(ce,{children:[e.jsxs(C,{invalid:o.name&&i.name,errorMessage:o.name,children:[e.jsx("h6",{className:"mb-4",children:"Included text"}),e.jsx(y,{type:"text",autoComplete:"off",name:"name",placeholder:"Keyword",component:L,prefix:e.jsx(k,{className:"text-lg"})})]}),e.jsxs(C,{invalid:o.category&&i.category,errorMessage:o.category,children:[e.jsx("h6",{className:"mb-4",children:"Product Category"}),e.jsx(y,{name:"category",children:({field:n,form:g})=>e.jsx(e.Fragment,{children:e.jsxs(p.Group,{vertical:!0,value:r.category,onChange:u=>g.setFieldValue(n.name,u),children:[e.jsxs(p,{className:"mb-3",name:n.name,value:"bags",children:["Bags"," "]}),e.jsxs(p,{className:"mb-3",name:n.name,value:"cloths",children:["Cloths"," "]}),e.jsxs(p,{className:"mb-3",name:n.name,value:"devices",children:["Devices"," "]}),e.jsxs(p,{className:"mb-3",name:n.name,value:"shoes",children:["Shoes"," "]}),e.jsxs(p,{name:n.name,value:"watches",children:["Watches"," "]})]})})})]}),e.jsxs(C,{invalid:o.status&&i.status,errorMessage:o.status,children:[e.jsx("h6",{className:"mb-4",children:"Product Category"}),e.jsx(y,{name:"status",children:({field:n,form:g})=>e.jsx(e.Fragment,{children:e.jsxs(p.Group,{vertical:!0,value:r.status,onChange:u=>g.setFieldValue(n.name,u),children:[e.jsxs(p,{className:"mb-3",name:n.name,value:0,children:["In Stock"," "]}),e.jsxs(p,{className:"mb-3",name:n.name,value:1,children:["Limited"," "]}),e.jsxs(p,{className:"mb-3",name:n.name,value:2,children:["Out Of Stock"," "]})]})})})]}),e.jsxs(C,{invalid:o.productStatus&&i.productStatus,errorMessage:o.productStatus,children:[e.jsx("h6",{className:"mb-4",children:"Product Status"}),e.jsx(y,{name:"productStatus",children:({field:n,form:g})=>e.jsxs(D.Group,{vertical:!0,value:r.productStatus,onChange:u=>g.setFieldValue(n.name,u),children:[e.jsx(D,{value:0,children:"Published"}),e.jsx(D,{value:1,children:"Disabled"}),e.jsx(D,{value:2,children:"Archive"})]})})]})]})})})}),Pe=({onSaveClick:t,onCancel:s})=>e.jsxs("div",{className:"text-right w-full",children:[e.jsx(j,{size:"sm",className:"mr-2",onClick:s,children:"Cancel"}),e.jsx(j,{size:"sm",variant:"solid",onClick:t,children:"Query"})]}),Ne=()=>{const t=x.useRef(null),[s,l]=x.useState(!1),m=()=>{l(!0)},c=()=>{l(!1)},r=()=>{var i;(i=t.current)==null||i.submitForm()};return e.jsxs(e.Fragment,{children:[e.jsx(j,{size:"sm",className:"block md:inline-block ltr:md:ml-2 rtl:md:mr-2 md:mb-0 mb-4",icon:e.jsx(Z,{}),onClick:()=>m(),children:"Filter"}),e.jsx(ie,{title:"Filter",isOpen:s,footer:e.jsx(Pe,{onCancel:c,onSaveClick:r}),onClose:c,onRequestClose:c,children:e.jsx(A,{ref:t,onSubmitComplete:c})})]})};A.displayName="FilterForm";const ve=()=>e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center",children:[e.jsx(ye,{}),e.jsx(Ne,{}),e.jsx(w,{download:!0,className:"block lg:inline-block md:mx-2 md:mb-0 mb-4",to:"/data/product-list.csv",target:"_blank",children:e.jsx(j,{block:!0,size:"sm",icon:e.jsx(ee,{}),children:"Export"})}),e.jsx(w,{className:"block lg:inline-block md:mb-0 mb-4",to:"/app/sales/product-new",children:e.jsx(j,{block:!0,variant:"solid",size:"sm",icon:e.jsx(te,{}),children:"Add Product"})})]});V("salesProductList",fe);const Se=()=>e.jsxs(W,{className:"h-full",bodyClass:"h-full",children:[e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Products"}),e.jsx(ve,{})]}),e.jsx(De,{})]}),Ft=Se;export{Ft as default};
