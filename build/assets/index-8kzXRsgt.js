import{r as c,j as s,T as B}from"./index-KQFNJtc4.js";import{B as j}from"./Button--D0tRVmb.js";import{A as y}from"./index-AzPWxrgC.js";import{T as v}from"./Tag-k0Xfqpup.js";import{T as x}from"./index-NtdJ7jWN.js";import{C as L}from"./Card-xLnaagij.js";import{I as P}from"./Input-7K7l2bPW.js";import{A as b}from"./AdaptableCard-KBCkay_F.js";import{C as R}from"./Views-aA243lDZ.js";import{R as F}from"./RichTextEditor-KpKxDXES.js";import{I as n}from"./IconText-ncI1PH-I.js";import{X as G,Y as z,Z as C,_ as O,$,a0 as U,a1 as X}from"./index.esm-jb16UrWF.js";import{f as Y}from"./ProjectService-xvuuYmCK.js";import{H as Z}from"./index-VXFiPzRQ.js";import{i as k}from"./isLastChild-6BXlVJ47.js";import{d as _}from"./debounce-5rQpXXJ3.js";import{c as q}from"./cloneDeep-CjJ0LPh2.js";import"./context-U4uJiOlk.js";import"./useMergeRef-Rt_Crb27.js";import"./Tooltip-rFfMZWAg.js";import"./index.esm-ODZ_1Gk0.js";import"./floating-ui.react-gVU2UEvr.js";import"./floating-ui.dom-0rLBacrf.js";import"./index-xIA8Eb8D.js";import"./motion-4MnqOKZu.js";import"./mapCloneElement-FdyajOIG.js";import"./isNil-L5c80eVR.js";import"./get-EkBL7rjB.js";import"./_MapCache-0VrhD5q7.js";import"./toString-46epAutM.js";import"./_baseIsEqual--CyDiGti.js";import"./_getAllKeys-XkXg1sqn.js";import"./ApiService-etMEz65z.js";const p=({children:e,...t})=>s.jsx(y,{...t,size:30,shape:"circle",children:e}),J=({timeline:e,...t})=>{var l;return s.jsx(x.Item,{className:"w-full",media:s.jsx(p,{className:"text-gray-700 bg-gray-200 dark:text-gray-100 dark:bg-gray-600",children:s.jsx("span",{className:"text-xl",children:s.jsx(X,{})})}),...t,children:s.jsxs("p",{className:"my-1 flex items-center",children:[s.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:e.name}),s.jsx("span",{className:"mx-2",children:"assigned "}),(l=e.assignees)==null?void 0:l.map((i,m)=>s.jsxs("span",{className:"font-semibold text-gray-900 dark:text-gray-100 mr-1 rtl:ml-1",children:[i,!k(e.assignees||[],m)&&s.jsx("span",{children:","})]},i)),s.jsx("span",{children:e.time})]})})},K=({timeline:e,...t})=>s.jsxs(x.Item,{className:"w-full",media:s.jsx(p,{src:e.img}),...t,children:[s.jsxs("p",{className:"my-1 flex items-center",children:[s.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:e.name}),s.jsx("span",{className:"mx-2",children:"added a comment "}),s.jsx("span",{children:e.time})]}),s.jsx(L,{bordered:!0,className:"mt-4",children:s.jsx("p",{children:e.comment})})]}),Q=({timeline:e,...t})=>{var l;return s.jsx(x.Item,{className:"w-full",media:s.jsx(p,{className:"text-gray-700 bg-gray-200 dark:text-gray-100 dark:bg-gray-600",children:s.jsx("span",{className:"text-xl",children:s.jsx(C,{})})}),...t,children:s.jsxs("div",{className:"flex items-center",children:[s.jsxs("span",{className:"font-semibold text-gray-900 dark:text-gray-100",children:[e.name," "]}),s.jsx("span",{className:"mx-2",children:"added tags "}),(l=e.labels)==null?void 0:l.map(i=>s.jsx(v,{prefix:!0,className:"mr-2 rtl:ml-2 cursor-pointer",prefixClass:i.class,children:i.title},i.title)),s.jsx("span",{children:e.time})]})})},V=()=>{var g,u,f;const[e,t]=c.useState({}),[l,i]=c.useState(!0),[m,h]=c.useState(!1),o=c.useRef(null),T=_(I,1e3);function I(a){t(r=>({...r,description:a}))}c.useEffect(()=>{A()},[]);const A=c.useCallback(async()=>{i(!0);const a=await Y();t(a.data),i(!1)},[]),E=c.useCallback(()=>{h(!0)},[]),w=c.useCallback(()=>{h(!1)},[]),H=a=>{T(a)},M=()=>{var N;const r={type:"COMMENT",name:"Carolyn Perkins",img:"/img/avatars/thumb-1.jpg",time:"now",comment:(N=o.current)==null?void 0:N.value},d=q(e.activity);d==null||d.push(r),t(S=>({...S,activity:d})),o.current&&(o.current.value="")},D=(a,r)=>{switch(a.type){case"COMMENT":return s.jsx(K,{timeline:a,isLast:r});case"ASSIGN":return s.jsx(J,{timeline:a,isLast:r});case"TAG":return s.jsx(Q,{timeline:a,isLast:r});default:return s.jsx(s.Fragment,{})}};return s.jsx(R,{className:"h-full",children:s.jsx(B,{loading:l,children:s.jsxs("div",{className:"grid md:grid-cols-1 lg:grid-cols-3 gap-4",children:[s.jsx("div",{className:"lg:col-span-2",children:s.jsxs(b,{rightSideBorder:!0,bodyClass:"p-5",children:[s.jsxs("div",{className:"flex flex-col md:flex-row md:items-center justify-between gap-4",children:[s.jsxs("div",{children:[s.jsx("h3",{className:"mb-2 font-bold",children:e.title}),s.jsxs("p",{children:[e.ticketId," created by",s.jsx("span",{className:"font-semibold text-gray-900 dark:text-gray-100 mx-1 cursor-pointer",children:e.createdBy})]})]}),s.jsx("div",{children:m?s.jsx(j,{block:!0,variant:"solid",onClick:w,children:"Done"}):s.jsx(j,{block:!0,icon:s.jsx(G,{}),onClick:E,children:"Edit"})})]}),s.jsx("hr",{className:"my-6"}),s.jsx("div",{className:"text-base",children:m?s.jsx(F,{value:e.description,onChange:H}):s.jsx("div",{className:"prose dark:prose-invert max-w-none",children:Z(e.description||"")})}),s.jsxs("div",{className:"mt-12",children:[s.jsx("h4",{children:"Activity"}),s.jsx("hr",{className:"my-6"}),s.jsx(x,{children:(g=e.activity)==null?void 0:g.map((a,r)=>s.jsx(c.Fragment,{children:D(a,k(e.activity||[],r))},a.type+r))}),s.jsxs("div",{className:"mt-6 mb-3 flex flex-auto",children:[s.jsx(p,{src:"/img/avatars/thumb-1.jpg"}),s.jsx("div",{className:"ml-4 rtl:mr-4 w-full",children:s.jsx(P,{ref:o,textArea:!0,placeholder:"Leave a comment"})})]}),s.jsx("div",{className:"text-right",children:s.jsx(j,{variant:"solid",onClick:()=>M(),children:"Comment"})})]})]})}),s.jsx("div",{children:s.jsxs(b,{bodyClass:"p-5",children:[s.jsx("h4",{className:"mb-6",children:"Details"}),s.jsx(n,{className:"mb-4 text-emerald-500",icon:s.jsx(z,{className:"text-lg"}),children:s.jsx("span",{className:"font-semibold",children:"In Progress"})}),s.jsx(n,{className:"mb-4",icon:s.jsx(C,{className:"text-lg opacity-70"}),children:s.jsx("span",{className:"font-semibold",children:e.underProject})}),s.jsx(n,{className:"mb-4",icon:s.jsx(O,{className:"text-lg opacity-70"}),children:s.jsx("span",{className:"font-semibold cursor-pointer",children:"Linked tickets"})}),s.jsx(n,{className:"mb-4",icon:s.jsx($,{className:"text-lg opacity-70"}),children:s.jsx("span",{className:"font-semibold cursor-pointer",children:"5 story point"})}),s.jsx(n,{className:"mb-4",icon:s.jsx(U,{className:"text-lg opacity-70"}),children:s.jsxs("span",{className:"font-semibold",children:["Created on ",e.date]})}),s.jsx("hr",{className:"my-6"}),s.jsx("p",{className:"font-semibold mb-4",children:"Assignees"}),(u=e.assignees)==null?void 0:u.map(a=>s.jsx(n,{className:"mb-4",icon:s.jsx(y,{size:20,shape:"circle",src:a.img}),children:s.jsx("span",{className:"font-semibold text-gray-700 dark:text-gray-100",children:a.name})},a.id)),s.jsx("p",{className:"font-semibold mb-4 mt-8",children:"Tags"}),(f=e.labels)==null?void 0:f.map(a=>s.jsx(v,{prefix:!0,className:"mr-2 rtl:ml-2 cursor-pointer",prefixClass:a.class,children:a.title},a.title))]})})]})})})},Ds=V;export{Ds as default};
