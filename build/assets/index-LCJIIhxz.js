import{a0 as O,a1 as $,a2 as L,a3 as V,a as N,j as e,au as p,a5 as A,r as M}from"./index-O97KD1XJ.js";import{C as P}from"./CalendarView-_iD5VAnf.js";import{C as B}from"./Views-iRCRASdY.js";import{I as z}from"./Input-makuYaeg.js";import{B as T}from"./Button-n3c8cB2K.js";import{S as W,c as U}from"./Select-_e0TKXtk.js";import{D as f}from"./index-LjY7nyu6.js";import{D as G}from"./Dialog-XDuIBQJJ.js";import{F as H,a as u}from"./FormItem-bCrHbCc8.js";import{B as w}from"./Badge-_LYGoG9s.js";import{h as _}from"./index-L_xsvYZk.js";import{b as J}from"./CrmService-FOmmpLGP.js";import{F as K,a as Q,b as g}from"./formik.esm-xorrCZOp.js";import{L as X}from"./index.esm-MD-IZzhi.js";import{c as Y,a as C,h as D}from"./index.esm-QeVZWOXc.js";import{c as j}from"./cloneDeep-Y-DwtY7_.js";import"./context-BS4LvZM6.js";import"./isNil-1LBAZTYO.js";import"./get--074qGIL.js";import"./_MapCache-vEvIAXSa.js";import"./toString-AeKtklBS.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./floating-ui.dom-0rLBacrf.js";import"./useControllableState-himO6EQI.js";import"./useMergeRef-Rt_Crb27.js";import"./Calendar-teyFW-zD.js";import"./CloseButton-yAPnqcWI.js";import"./floating-ui.react-BJZwznw0.js";import"./RangeCalendar-XiCEUTXt.js";import"./TimeInput-nRyL5gGA.js";import"./useUniqueId-6j7TaJYj.js";import"./useDidUpdate-VG6AO64V.js";import"./index-KCiJfo7F.js";import"./index-kAodoiZN.js";import"./motion-vruOJL_Y.js";import"./index-ZAnTfVAf.js";import"./useRootClose-ld_Ws5Z2.js";import"./useTimeout-Gx-8vXJL.js";import"./ApiService-I6G-i7NO.js";import"./_getAllKeys-cII5gLKi.js";const F="crmCalendar",R=O(F+"/getEvents",async()=>(await J()).data),Z={loading:!1,eventList:[],dialogOpen:!1,selected:{type:""}},q=$({name:`${F}/state`,initialState:Z,reducers:{updateEvent:(t,o)=>{t.eventList=o.payload},openDialog:t=>{t.dialogOpen=!0},closeDialog:t=>{t.dialogOpen=!1},setSelected:(t,o)=>{t.selected=o.payload}},extraReducers:t=>{t.addCase(R.fulfilled,(o,m)=>{o.eventList=m.payload})}}),{updateEvent:y,openDialog:E,closeDialog:S,setSelected:k}=q.actions,ee=q.reducer,te=L({data:ee}),x=V,{Control:ae}=U,{useUniqueId:le}=_,h=[{value:"red",label:"red",color:"bg-red-500"},{value:"orange",label:"orange",color:"bg-orange-500"},{value:"amber",label:"amber",color:"bg-amber-500"},{value:"yellow",label:"yellow",color:"bg-yellow-500"},{value:"lime",label:"lime",color:"bg-lime-500"},{value:"green",label:"green",color:"bg-green-500"},{value:"emerald",label:"emerald",color:"bg-emerald-500"},{value:"teal",label:"teal",color:"bg-teal-500"},{value:"cyan",label:"cyan",color:"bg-cyan-500"},{value:"sky",label:"sky",color:"bg-sky-500"},{value:"blue",label:"blue",color:"bg-blue-500"},{value:"indigo",label:"indigo",color:"bg-indigo-500"},{value:"purple",label:"purple",color:"bg-purple-500"},{value:"fuchsia",label:"fuchsia",color:"bg-fuchsia-500"},{value:"pink",label:"pink",color:"bg-pink-500"},{value:"rose",label:"rose",color:"bg-rose-500"}],re=({innerProps:t,label:o,data:m,isSelected:s})=>e.jsxs("div",{className:`flex items-center justify-between p-2 ${s?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...t,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(w,{className:m.color}),e.jsx("span",{className:"ml-2 rtl:mr-2 capitalize",children:o})]}),s&&e.jsx(X,{className:"text-emerald-500 text-xl"})]}),oe=({children:t,...o})=>{const m=o.getValue()[0];return e.jsxs(ae,{className:"capitalize",...o,children:[m&&e.jsx(w,{className:`${m.color} ltr:ml-4 rtl:mr-4`}),t]})},se=Y().shape({title:C().required("Event title Required"),startDate:D().required("Start Date Required"),endDate:D(),color:C().required("Color Required")}),ne=({submit:t})=>{const o=N(),m=x(a=>a.crmCalendar.data.dialogOpen),s=x(a=>a.crmCalendar.data.selected),v=le("event-"),b=()=>{o(S())},n=(a,l)=>{l(!1);const r={id:s.id||v,title:a.title,start:p(a.startDate).format(),eventColor:a.color};a.endDate&&(r.end=p(a.endDate).format()),t==null||t(r,s.type),o(S())};return e.jsxs(G,{isOpen:m,onClose:b,onRequestClose:b,children:[e.jsx("h5",{className:"mb-4",children:s.type==="NEW"?"Add New Event":"Edit Event"}),e.jsx("div",{children:e.jsx(K,{enableReinitialize:!0,initialValues:{title:s.title||"",startDate:s.start?p(s.start).toDate():"",endDate:s.end?p(s.end).toDate():"",color:s.eventColor||h[0].value},validationSchema:se,onSubmit:(a,{setSubmitting:l})=>{n(a,l)},children:({values:a,touched:l,errors:r})=>e.jsx(Q,{children:e.jsxs(H,{children:[e.jsx(u,{label:"User Name",invalid:r.title&&l.title,errorMessage:r.title,children:e.jsx(g,{type:"text",autoComplete:"off",name:"title",placeholder:"Please enter title",component:z})}),e.jsx(u,{label:"Start Date",invalid:r.startDate&&l.startDate,errorMessage:r.startDate,children:e.jsx(g,{name:"startDate",placeholder:"Date",children:({field:i,form:c})=>e.jsx(f,{field:i,form:c,value:i.value,onChange:d=>{c.setFieldValue(i.name,d)}})})}),e.jsx(u,{label:"End Date",invalid:r.endDate&&l.endDate,errorMessage:r.endDate,children:e.jsx(g,{name:"endDate",placeholder:"Date",children:({field:i,form:c})=>e.jsx(f,{field:i,form:c,value:i.value,onChange:d=>{c.setFieldValue(i.name,d)}})})}),e.jsx(u,{label:"Prefered",asterisk:!0,invalid:r.color&&l.color,errorMessage:r.color,children:e.jsx(g,{name:"color",children:({field:i,form:c})=>e.jsx(W,{field:i,form:c,options:h,value:h.filter(d=>d.value===a.color),components:{Option:re,Control:oe},onChange:d=>c.setFieldValue(i.name,d==null?void 0:d.value)})})}),e.jsx(u,{className:"mb-0 text-right rtl:text-left",children:e.jsx(T,{variant:"solid",type:"submit",children:"Submit"})})]})})})})]})};A("crmCalendar",te);const ie=()=>{const t=N(),o=x(n=>n.crmCalendar.data.eventList);M.useEffect(()=>{t(R())},[]);const m=n=>{const{start:a,end:l}=n;t(k({type:"NEW",start:p(a).format(),end:p(l).format()})),t(E())},s=n=>{const{start:a,end:l,id:r,title:i,extendedProps:c}=n.event;t(k({type:"EDIT",eventColor:c.eventColor,title:i,start:a,end:l,id:r})),t(E())},v=(n,a)=>{let l=j(o);a==="NEW"&&l.push(n),a==="EDIT"&&(l=l.map(r=>(n.id===r.id&&(r=n),r))),t(y(l))},b=n=>{const a=j(o).map(l=>{if(n.event.id===l.id){const{id:r,extendedProps:i,start:c,end:d,title:I}=n.event;l={id:r,start:p(c).format(),end:p(d).format(),title:I,eventColor:i.eventColor}}return l});t(y(a))};return e.jsxs(B,{className:"h-full",children:[e.jsx(P,{editable:!0,selectable:!0,events:o,eventClick:s,select:m,eventDrop:b}),e.jsx(ne,{submit:v})]})},Xe=ie;export{Xe as default};
