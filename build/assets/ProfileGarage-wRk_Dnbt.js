import{r as d,j as e,a8 as V,a9 as S,aa as J,ag as $,ap as ze,b3 as To,ak as Ce,al as Ke,am as Ge,an as ie,af as ae,ab as Se,a7 as Ee,aj as qe,a4 as $o,u as Fo,ai as Bo,ar as Uo,as as qo}from"./index-sxY2vR_b.js";import{C as zo,a as Ko}from"./Views-YxvfAhNX.js";import{S as Go}from"./Switcher-VFtKx0K1.js";import{C as ro}from"./Card-3z76uwgw.js";import{A as no}from"./index-168mgl0G.js";import{B as oe}from"./Button-gHfU8a9b.js";import{C as Vo}from"./ConfirmDialog-1vkasI0v.js";import{h as Ve,v as Ho,x as Zo,B as Yo,C as Jo,D as Wo,e as Qo}from"./index.esm-7rMJeW_p.js";import{T as Xo}from"./Tag-5NPWn_uT.js";import{ap as ea,aq as Te,ar as io}from"./index.esm-cN1LGhJ4.js";import{T as ye}from"./index-AN3niVhH.js";import"./Alert-1kxoHLt1.js";import"./Badge-WPmbxsX2.js";import"./Calendar-ZgfSp0Fx.js";import{C as oa}from"./index-0cCTVzk8.js";import"./index-JPCr6e7Q.js";import{D as uo}from"./Dialog-FwOZiQ_s.js";import{D as go}from"./Drawer-KaX1Kqot.js";import"./index-2djQTcgN.js";import"./FormItem-ICRO4P5i.js";import{I as ge}from"./Input-ZPP_AMg7.js";import"./index-I4EIx4PY.js";import"./index-jl_zHUR_.js";import"./index-TkDSRGw1.js";import{N as j,t as N}from"./toast-N-ApZxOe.js";import{P as lo}from"./index-AsMD9Xvv.js";import"./Progress-p9IPJkjX.js";import"./index-QXg7WEm2.js";import"./RangeCalendar-g4odKOuj.js";import"./ScrollBar-k_2w5HU3.js";import"./index-lXV4h-Rf.js";import{d as aa}from"./Select-vJOz7BTD.js";import"./Skeleton-zGhQ9bnn.js";import"./index-TP-BM9LS.js";import{T as co}from"./index-JXMUYVq9.js";import"./index-uGSpJKVA.js";import"./index-onWM9cyH.js";import"./Tooltip-tOnNgS6K.js";import"./Upload-GAFqS9aY.js";import{u as $e,f as ne,g as Fe,a as Be,b as Ue}from"./index-AdiLc_ck.js";import{R as sa}from"./index.esm-xVmdIlpe.js";import{M as ta}from"./index.esm-qQsv22NO.js";import{S as ra}from"./index.esm-2V1o1-ZT.js";import{F as po,a as ho,b as P,E as I}from"./formik.esm-4xE5LDXP.js";import{c as le,g as we,h as ve,a as D}from"./index.esm-1j1B1UQO.js";import{G as xo,M as fo}from"./esm-vjv7mhiG.js";import"./useMergeRef-Rt_Crb27.js";import"./context-ugtK0z0w.js";import"./useTimeout-KcO8uHA1.js";import"./CloseButton-zdejdkm_.js";import"./StatusIcon-KQcZjBe0.js";import"./motion-h-3axnRn.js";import"./useControllableState-ID83Xmrm.js";import"./cloneDeep-zb5lPSU-.js";import"./_getAllKeys--cIPhckb.js";import"./_MapCache-2jaa7x3q.js";import"./_baseIsEqual-mdoAGwaV.js";import"./get-Hn36fiWU.js";import"./toString-O8bkrTIN.js";import"./floating-ui.react-xh7t2hCc.js";import"./floating-ui.dom-0rLBacrf.js";import"./TimeInput-AHD-Ag0H.js";import"./useUniqueId-Oy16QHov.js";import"./useDidUpdate-6tzSgSG9.js";import"./index-gZB_DS34.js";import"./index-t_CREONj.js";import"./useRootClose-E9p0nRhu.js";import"./isNil-e2_r07uT.js";import"./index-beo0AS2x.js";import"./chainedFunction-ltcSYACe.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./mapCloneElement-dQmo0QW8.js";import"./index.esm-lAhGiBpp.js";import"./index.esm-LGScvnh4.js";const mo=[{codigo:"0102",nombre:"BANCO DE VENEZUELA"},{codigo:"0156",nombre:"100% BANCO"},{codigo:"0172",nombre:"BANCAMIGA BANCO MICROFINANCIERO C A"},{codigo:"0114",nombre:"BANCARIBE"},{codigo:"0171",nombre:"BANCO ACTIVO"},{codigo:"0166",nombre:"BANCO AGRICOLA DE VENEZUELA"},{codigo:"0175",nombre:"BANCO BICENTENARIO DEL PUEBLO"},{codigo:"0128",nombre:"BANCO CARONI"},{codigo:"0163",nombre:"BANCO DEL TESORO"},{codigo:"0115",nombre:"BANCO EXTERIOR"},{codigo:"0151",nombre:"BANCO FONDO COMUN"},{codigo:"0173",nombre:"BANCO INTERNACIONAL DE DESARROLLO"},{codigo:"0105",nombre:"BANCO MERCANTIL"},{codigo:"0191",nombre:"BANCO NACIONAL DE CREDITO"},{codigo:"0138",nombre:"BANCO PLAZA"},{codigo:"0137",nombre:"BANCO SOFITASA"},{codigo:"0104",nombre:"BANCO VENEZOLANO DE CREDITO"},{codigo:"0168",nombre:"BANCRECER"},{codigo:"0134",nombre:"BANESCO"},{codigo:"0177",nombre:"BANFANB"},{codigo:"0146",nombre:"BANGENTE"},{codigo:"0174",nombre:"BANPLUS"},{codigo:"0108",nombre:"BBVA PROVINCIAL"},{codigo:"0157",nombre:"DELSUR BANCO UNIVERSAL"},{codigo:"0169",nombre:"MI BANCO"},{codigo:"0178",nombre:"N58 BANCO DIGITAL BANCO MICROFINANCIERO S A"}],na=({subscriptionId:r,talleruid:C})=>{const[t,k]=d.useState("Efectivo"),[E,F]=d.useState([]),[se,_]=d.useState(!1),[K,H]=d.useState(!1),[ce,B]=d.useState(!1),[R,M]=d.useState(!1);d.useEffect(()=>{(async()=>{const m=V(S,"MetodosPago"),L=(await J(m)).docs.map(x=>x.data());F(L.filter(x=>x.status))})()},[]),d.useEffect(()=>{(async()=>{if(C)try{const m=$(S,"Usuarios",C),u=await ze(m);if(u.exists()){const x=u.data().subscripcion_actual;x&&x.pago_reportado===!0&&B(!0)}}catch(m){console.error("Error al verificar si ya se reportó el pago:",m)}})()},[C]);const A=i=>{k(i)},W=()=>{ce?M(!0):H(!0)},Q=le().shape({monto:we().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),fechaPago:ve().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),de=le().shape({monto:we().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),numReferencia:D().required("El número de referencia es obligatorio"),bancoDestino:D().required("Selecciona un banco de destino"),bancoOrigen:D().required("Selecciona un banco de origen"),fechaPago:ve().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),p=le().shape({monto:we().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),numReferencia:D().required("El número de referencia es obligatorio"),telefono:D().required("El teléfono es obligatorio").matches(/^[1-9]\d*$/,"El teléfono no puede comenzar con 0 y debe contener solo números"),bancoDestino:D().required("Selecciona un banco de destino"),bancoOrigen:D().required("Selecciona un banco de origen"),fechaPago:ve().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),g=le().shape({monto:we().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),correo:D().email("El correo no es válido").required("El correo Zelle es obligatorio"),fechaPago:ve().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),h=le().shape({...t==="Efectivo"&&Q.fields,...t==="Transferencia"&&de.fields,...t==="Pago Móvil"&&p.fields,...t==="Zelle"&&g.fields}),y={metodoPago:"",monto:"",numReferencia:"",telefono:"",correo:"",cedula:"",bancoOrigen:"",bancoDestino:"",fechaPago:"",newLogoFile:null},n=async(i,m)=>{try{const u=V(S,"Subscripciones"),L=await J(u),x=new Date(i.fechaPago),T=`${x.getFullYear()}-${String(x.getMonth()+1).padStart(2,"0")}-${String(x.getDate()).padStart(2,"0")}`;for(const X of L.docs){const U=X.data().comprobante_pago;if(U&&U.fechaPago){const O=U.fechaPago.toDate();if(`${O.getFullYear()}-${String(O.getMonth()+1).padStart(2,"0")}-${String(O.getDate()).padStart(2,"0")}`===T){if((m==="Pago Móvil"||m==="Transferencia")&&U.numReferencia===i.numReferencia)return{isDuplicate:!0,message:`Ya existe un pago con el número de referencia ${i.numReferencia} en la fecha ${T}`};if(m==="Zelle"&&U.correo===i.correo)return{isDuplicate:!0,message:`Ya existe un pago con el correo ${i.correo} en la fecha ${T}`};if(m==="Efectivo"&&U.monto===parseFloat(i.monto))return{isDuplicate:!0,message:`Ya existe un pago en efectivo por el monto $${i.monto} en la fecha ${T}`}}}}return{isDuplicate:!1,message:""}}catch(u){return console.error("Error al validar duplicidad:",u),{isDuplicate:!1,message:""}}},w=async i=>{if(!r){console.error("Error: subscriptionId no está definido");return}_(!0);try{const m=await n(i,t);if(m.isDuplicate){N.push(e.jsx(j,{title:"Error",type:"danger",children:m.message})),_(!1);return}let u="";if(i.newLogoFile&&t&&C){const X=To(),me=new Date().toISOString(),U=`${t}_${C}_${me}.jpg`,O=i.newLogoFile,pe=Ce(X,`paymentcommitment/${U}`),G=await Ke(pe,O);u=await Ge(G.ref)}const L=i.fechaPago?ie.fromDate(new Date(i.fechaPago)):null,x={metodo:t,monto:i.monto,fechaPago:L,comprobante:u};t==="Transferencia"&&(x.numReferencia=i.numReferencia??"",x.cedula=i.cedula??"",x.bancoOrigen=i.bancoOrigen??"",x.bancoDestino=i.bancoDestino??""),t==="Pago Móvil"&&(x.cedula=i.cedula,x.telefono=i.telefono,x.bancoOrigen=i.bancoOrigen,x.bancoDestino=i.bancoDestino),t==="Zelle"&&(x.correo=i.correo??"",x.numReferencia=i.numReferencia),console.log(x);const T=$(S,"Subscripciones",r);if(await ae(T,{comprobante_pago:x}),C){const X=$(S,"Usuarios",C);await ae(X,{"subscripcion_actual.pago_reportado":!0}),B(!0)}console.log("Pago registrado exitosamente"),N.push(e.jsx(j,{title:"Éxito",type:"success",children:"Se ha registrado el pago correctamente."}))}catch(m){console.error("Error al registrar el pago:",m),N.push(e.jsx(j,{title:"Error",children:"Ocurrió un problema al registrar el pago."}))}finally{_(!1),H(!1)}},c=E.find(i=>i.tipo_pago===t);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:W,className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Reportar Pago"}),e.jsx(uo,{isOpen:R,onClose:()=>M(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Pago Ya Reportado"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Ya se ha reportado un pago para esta suscripción. No se puede reportar otro pago."}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>M(!1),className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Entendido"})})]})}),e.jsx(go,{isOpen:K,onClose:()=>H(!1),title:"Registrar Pago",children:e.jsx(po,{initialValues:y,onSubmit:w,validationSchema:h,validateOnBlur:!0,validateOnChange:!1,children:({setFieldValue:i,values:m})=>e.jsxs(ho,{className:"flex flex-col gap-4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Selecciona el Método de Pago"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mb-4",children:E==null?void 0:E.map(u=>e.jsx("button",{type:"button",onClick:()=>A(u.tipo_pago),className:`text-sm py-2 px-4 rounded-md ${t===u.tipo_pago?"bg-[#1d1e56] text-white":"bg-gray-200"}`,children:u.tipo_pago},u.tipo_pago))}),t!=="Efectivo"&&c&&e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg mb-4",children:[e.jsx("h5",{className:"font-semibold text-lg",children:"Detalles de la Empresa"}),c.email&&e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",c.email]}),c.num_ref&&e.jsxs("p",{children:[e.jsx("strong",{children:"Número de Referencia:"})," ",c.num_ref]}),c.banco&&e.jsxs("p",{children:[e.jsx("strong",{children:"Banco:"})," ",c.banco]}),c.cedula_rif&&e.jsxs("p",{children:[e.jsx("strong",{children:"Cédula/RIF:"})," ",c.cedula_rif]}),c.cuenta&&e.jsxs("p",{children:[e.jsx("strong",{children:"Cuenta:"})," ",c.cuenta]}),c.status_pago!==void 0&&e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",c.status_pago?"Activo":"Inactivo"]}),c.tipo_cuenta&&e.jsxs("p",{children:[e.jsx("strong",{children:"Tipo de Cuenta:"})," ",c.tipo_cuenta]}),c.telefono&&e.jsxs("p",{children:[e.jsx("strong",{children:"Teléfono:"})," ",c.telefono]}),c.titular&&e.jsxs("p",{children:[e.jsx("strong",{children:"Titular:"})," ",c.titular]})]}),e.jsx(P,{id:"monto",name:"monto",as:ge,placeholder:"Ingresa el monto en $"}),e.jsx(I,{name:"monto",component:"div",className:"text-red-500"}),e.jsx(P,{id:"fechaPago",name:"fechaPago",as:ge,type:"date",placeholder:"Fecha de pago"}),e.jsx(I,{name:"fechaPago",component:"div",className:"text-red-500"}),t==="Pago Móvil"&&e.jsxs(e.Fragment,{children:[e.jsx(P,{id:"telefono",name:"telefono",as:ge,placeholder:"Teléfono",onKeyDown:u=>{u.currentTarget.value===""&&u.key==="0"&&u.preventDefault()},onChange:u=>{const L=u.target.value.replace(/^0+/,"");i("telefono",L)}}),e.jsx(I,{name:"telefono",component:"div",className:"text-red-500"})]}),t==="Zelle"&&e.jsx(P,{id:"correo",name:"correo",as:ge,placeholder:"Correo Zelle"}),["Transferencia","Pago Móvil"].includes(t)&&e.jsxs(e.Fragment,{children:[e.jsx(P,{id:"numReferencia",name:"numReferencia",as:ge,placeholder:"Número de referencia"}),e.jsx(I,{name:"numReferencia",component:"div",className:"text-red-500"})]}),["Transferencia","Pago Móvil"].includes(t)&&e.jsxs(e.Fragment,{children:[e.jsxs(P,{id:"bancoDestino",as:"select",name:"bancoDestino",className:"p-2 rounded-md border border-slate-300",children:[e.jsx("option",{value:"",children:"Selecciona Banco de Destino"}),mo.map(u=>e.jsx("option",{value:u.nombre,children:u.nombre},u.codigo))]}),e.jsx(I,{name:"bancoDestino",component:"div",className:"text-red-500"}),e.jsxs(P,{id:"bancoOrigen",as:"select",name:"bancoOrigen",className:"p-2 rounded-md border border-slate-300",children:[e.jsx("option",{value:"",children:"Selecciona Banco de Origen"}),mo.map(u=>e.jsx("option",{value:u.nombre,children:u.nombre},u.codigo))]}),e.jsx(I,{name:"bancoOrigen",component:"div",className:"text-red-500"})]}),["Transferencia","Pago Móvil","Zelle"].includes(t)&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10 gap-2",children:e.jsxs("div",{className:"text-center",children:[m.newLogoFile?e.jsx("img",{src:URL.createObjectURL(m.newLogoFile),alt:"Logo",className:"w-32 h-32 object-cover rounded-md"}):e.jsx(Ve,{className:"text-gray-500 text-center text-3xl"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"fileInput",className:"text-sm font-medium text-blue-600 cursor-pointer",children:"Subir Comprobante de Pago"}),e.jsx("input",{id:"fileInput",name:"newLogoFile",type:"file",className:"hidden",accept:"image/*",onChange:u=>{u.target.files&&u.target.files[0]&&i("newLogoFile",u.target.files[0])}})]})]})})}),e.jsx("button",{type:"submit",className:"w-full py-2 mt-4 bg-blue-900 rounded-md hover:bg-blue-700 text-white",children:"Registrar Pago"})]})})})]})},ia=({markers:r,center:C})=>{const[t,k]=d.useState([]);return d.useEffect(()=>{k(r)},[r]),e.jsx("div",{style:{height:"50%",width:"100%"},children:e.jsx(xo,{center:C,zoom:10,mapContainerStyle:{height:"400px",width:"100%",marginTop:"10px"},children:t.map((E,F)=>e.jsx(fo,{position:{lat:E.lat,lng:E.lng}},F))})})},la=({initialLocation:r,onLocationChange:C})=>{const[t,k]=d.useState(null),[E]=d.useState(17);d.useEffect(()=>{r&&r.lat&&r.lng&&k(r)},[r]);const F=_=>{if(!_.latLng)return;const K={lat:_.latLng.lat(),lng:_.latLng.lng()};k(K),C(K)},se=_=>{if(_.latLng){const K={lat:_.latLng.lat(),lng:_.latLng.lng()};k(K),C(K)}};return e.jsx("div",{style:{height:"450px",width:"100%"},children:e.jsx(xo,{center:t||{lat:0,lng:0},zoom:E,mapContainerStyle:{height:"400px",width:"100%",marginTop:"10px"},onClick:F,children:t&&e.jsx(fo,{position:t,draggable:!0,onDragEnd:se})})})},ca=le().shape({nombre_servicio:D().required("El nombre del servicio es requerido"),descripcion:D().required("La descripción es requerida"),uid_categoria:D().required("La categoría es requerida"),precio:D().required("El precio es requerido"),garantia:D().required("La garantía es requerida"),typeService:D().required("El tipo de servicio es requerido")}),da=({isOpen:r,onClose:C,service:t,onServiceUpdated:k})=>{const[E,F]=d.useState([]),[se,_]=d.useState([]),[K,H]=d.useState([]),[ce,B]=d.useState(!1),[R,M]=d.useState(null),[A,W]=d.useState(!1);d.useEffect(()=>{(async()=>{var h;if(!(!r||!t)){B(!0);try{const y=Ee(V(S,"Categorias"),Se("estatus","==",!0)),w=(await J(y)).docs.map(m=>({id:m.id,...m.data()}));F(w);const c=await ze($(S,"talleres","talleres"));c.exists()&&H(c.data().talleres||[]);const i={nombre_servicio:(t==null?void 0:t.nombre_servicio)||"",descripcion:(t==null?void 0:t.descripcion)||"",uid_categoria:(t==null?void 0:t.uid_categoria)||"",nombre_categoria:(t==null?void 0:t.nombre_categoria)||"",service_image:(t==null?void 0:t.service_image)||(t==null?void 0:t.imagenes)||[],service_image_files:[],uid_taller:(t==null?void 0:t.uid_taller)||"",taller:(t==null?void 0:t.taller)||"",precio:((h=t==null?void 0:t.precio)==null?void 0:h.toString())||"",garantia:(t==null?void 0:t.garantia)||"",typeService:(t==null?void 0:t.typeService)||"local",subcategoria:(t==null?void 0:t.subcategoria)||[]};M(i),t!=null&&t.uid_categoria&&await Q(t.uid_categoria)}catch(y){console.error("Error loading data:",y),N.push(e.jsx(j,{title:"Error",children:"Error al cargar los datos"}))}finally{B(!1)}}})()},[r,t]),d.useEffect(()=>{R!=null&&R.uid_categoria&&E.length>0&&Q(R.uid_categoria)},[R==null?void 0:R.uid_categoria,E.length]);const Q=async g=>{if(!g){_([]);return}try{const h=Ee(V(S,"Categorias",g,"Subcategorias"),Se("estatus","==",!0)),n=(await J(h)).docs.map(w=>({id:w.id,...w.data()}));_(n)}catch(h){console.error("Error loading subcategories:",h),_([])}},de=async(g,h)=>{const y=[];for(let n=0;n<g.length;n++){const w=g[n],c=Date.now(),i=`${h}_${c}_${n}.jpg`,m=Ce(qe,`service_images/${i}`);try{await Ke(m,w);const u=await Ge(m);y.push(u)}catch(u){throw console.error("Error uploading image:",u),new Error(`Error al subir la imagen ${n+1}`)}}return y},p=async g=>{try{if(!(t!=null&&t.uid_servicio)){N.push(e.jsx(j,{title:"Error",children:"No se pudo identificar el servicio a editar"}));return}W(!0);let h=[...g.service_image||[]];if(g.service_image_files&&g.service_image_files.length>0)try{const n=await de(g.service_image_files,t.uid_servicio);h=[...h.filter(c=>!c.startsWith("blob:")),...n]}catch(n){console.error("Error uploading images:",n),N.push(e.jsx(j,{title:"Error",children:"Error al subir las imágenes"})),W(!1);return}else h=h.filter(n=>!n.startsWith("blob:"));const y=$(S,"Servicios",t.uid_servicio);await ae(y,{nombre_servicio:g.nombre_servicio,descripcion:g.descripcion,uid_categoria:g.uid_categoria,nombre_categoria:g.nombre_categoria,precio:g.precio,garantia:g.garantia,typeService:g.typeService,subcategoria:g.subcategoria,service_image:h,uid_taller:t.uid_taller,taller:t.taller,updatedAt:new Date}),N.push(e.jsx(j,{title:"Éxito",children:"Servicio actualizado correctamente"})),k==null||k(),C()}catch(h){console.error("Error updating service:",h),N.push(e.jsx(j,{title:"Error",children:"No se pudo actualizar el servicio"}))}finally{W(!1)}};return!t||!R?null:e.jsxs(go,{isOpen:r,onClose:C,className:"rounded-md shadow w-full max-w-2xl",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Editar Servicio"}),ce&&e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),e.jsx(po,{initialValues:R,validationSchema:ca,onSubmit:p,enableReinitialize:!0,children:({values:g,handleChange:h,setFieldValue:y,errors:n,touched:w})=>e.jsxs(ho,{className:"flex flex-col space-y-6",children:[e.jsx("div",{className:"mt-2 flex flex-col items-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10",children:e.jsxs("div",{className:"text-center",children:[Array.isArray(g.service_image)&&g.service_image.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:g.service_image.map((c,i)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:c,alt:`Imagen del servicio ${i+1}`,className:"h-32 w-full object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:()=>{const m=g.service_image.filter((u,L)=>L!==i);y("service_image",m)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600",children:"×"})]},i))}):e.jsx(Ve,{className:"mx-auto h-12 w-12 text-gray-300","aria-hidden":"true"}),e.jsx("div",{className:"mt-4 flex flex-col text-sm leading-6 text-gray-600 justify-center",children:e.jsxs("label",{htmlFor:"images-upload",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500 flex justify-center items-center",children:[e.jsx("span",{children:"Agregar otra imagen"}),e.jsx("input",{id:"images-upload",name:"images-upload",type:"file",accept:"image/*",multiple:!0,className:"sr-only",onChange:c=>{const i=Array.from(c.target.files||[]),m=i.map(u=>URL.createObjectURL(u));y("service_image",[...g.service_image||[],...m]),y("service_image_files",[...g.service_image_files||[],...i])}})]})})]})}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Nombre Servicio:"}),e.jsx(P,{type:"text",name:"nombre_servicio",value:g.nombre_servicio,onChange:h,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(I,{name:"nombre_servicio",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Tipo de Servicio:"}),e.jsxs("div",{className:"flex items-center space-x-10",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(P,{type:"radio",name:"typeService",value:"local",className:"form-radio"}),e.jsx("span",{children:"En el Local"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(P,{type:"radio",name:"typeService",value:"domicilio",className:"form-radio"}),e.jsx("span",{children:"A Domicilio"})]})]}),e.jsx(I,{name:"typeService",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Categoría:"}),e.jsxs(P,{as:"select",name:"uid_categoria",value:g.uid_categoria,onChange:c=>{const i=c.target.value,m=E.find(u=>u.id===i);y("uid_categoria",i),y("nombre_categoria",(m==null?void 0:m.nombre)||""),y("subcategoria",[]),Q(i)},className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"",children:"Seleccione una categoría"}),E.map(c=>e.jsx("option",{value:c.id,children:c.nombre},c.id))]}),e.jsx(I,{name:"uid_categoria",component:"div",className:"text-red-600 text-sm"})]}),e.jsx("label",{className:"font-semibold text-gray-700",children:"Subcategorías:"}),e.jsx(aa,{isMulti:!0,placeholder:"Selecciona subcategorías",noOptionsMessage:()=>"No hay Subcategorías disponibles",options:g.uid_categoria?se.map(c=>({value:c.id,label:c.nombre})):[],value:Array.isArray(g.subcategoria)?g.subcategoria.map(c=>({value:c.uid_subcategoria||c.id,label:c.nombre_subcategoria||c.nombre})):[],onChange:c=>y("subcategoria",c.map(i=>({uid_subcategoria:i.value,nombre_subcategoria:i.label}))),className:"mt-1"}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Descripción:"}),e.jsx(P,{as:"textarea",name:"descripcion",value:g.descripcion,onChange:h,rows:1,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 resize-none overflow-hidden",style:{maxHeight:"150px",overflowY:"auto"},onInput:c=>{c.target.style.height="auto",c.target.style.height=`${c.target.scrollHeight}px`}}),e.jsx(I,{name:"descripcion",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Precio:"}),e.jsx(P,{type:"text",name:"precio",value:g.precio,onChange:h,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(I,{name:"precio",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Garantía:"}),e.jsx(P,{type:"text",name:"garantia",value:g.garantia,onChange:h,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(I,{name:"garantia",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(oe,{variant:"default",onClick:C,className:"mr-2",disabled:A,children:"Cancelar"}),e.jsx(oe,{type:"submit",style:{backgroundColor:"#000B7E"},className:"text-white hover:opacity-80",disabled:A,children:A?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Guardando..."]}):"Guardar"})]})]})})]})},Is=()=>{var ao,so,to;const[r,C]=d.useState(null),[t,k]=d.useState(!1);d.useState(null);const[E,F]=d.useState([]),[se,_]=d.useState([]),[K,H]=d.useState(!0);d.useState(!1);const[ce,B]=d.useState(!1),[R,M]=d.useState(!1),[A,W]=d.useState(null),[Q,de]=d.useState(null),[p,g]=d.useState({fecha_fin:ie,fecha_inicio:ie,nombre:"",cantidad_servicios:0,monto:0,status:"",vigencia:"",uid:"",fechaCreacion:ie.fromDate(new Date)}),[h,y]=d.useState([]),[n,w]=d.useState({image_perfil:"",nombre:"",email:"",phone:"",rif:"",status:"",Direccion:"",ubicacion:{lat:0,lng:0},LinkFacebook:"",LinkTiktok:"",LinkInstagram:"",estado:"",whatsapp:"",newLogoFile:null});d.useState(null);const[c,i]=d.useState({pagoMovil:!1,transferencia:!1,puntoVenta:!1,zinli:!1,efectivo:!1,zelle:!1,tarjetaCreditoN:!1,tarjetaCreditoI:!1}),m=location.pathname.substring(location.pathname.lastIndexOf("/")+1),u=$o(),L=Fo(o=>o.auth.user.authority),x=L==null?void 0:L.includes("Admin"),T=async()=>{H(!0);try{const o=$(S,"Usuarios",m),s=(await ze(o)).data()||null;W(s);const b=(s==null?void 0:s.metodos_pago)||{};i(v=>({...v,...b}));const f=(s==null?void 0:s.subscripcion_actual)||null;k(!!f);const ee=Ee(V(S,"Subscripciones"),Se("taller_uid","==",m)),je=(await J(ee)).docs.map(v=>{const l=v.data();return{uid:v.id,nombre:l.nombre||"",monto:l.monto||"0",vigencia:l.vigencia||"",status:l.status||"",cantidad_servicios:l.cantidad_servicios||0,fecha_fin:l.fecha_fin||"no hay fecha",fecha_inicio:l.fecha_inicio||"no hay fecha",taller_uid:l.taller_uid||"",fechaCreacion:ie.fromDate(new Date)}}),z=Ee(V(S,"Servicios"),Se("uid_taller","==",m)),Oe=(await J(z)).docs.map(v=>{const l=v.data();return{uid_servicio:v.id,nombre_servicio:(l==null?void 0:l.nombre_servicio)||"",descripcion:(l==null?void 0:l.descripcion)||"",precio:(l==null?void 0:l.precio)||"0",estatus:l==null?void 0:l.estatus,taller:(l==null?void 0:l.taller)||"",puntuacion:(l==null?void 0:l.puntuacion)||"0",uid_taller:(l==null?void 0:l.uid_taller)||"",uid_categoria:(l==null?void 0:l.uid_categoria)||"",nombre_categoria:(l==null?void 0:l.nombre_categoria)||"",subcategoria:(l==null?void 0:l.subcategoria)||[],garantia:(l==null?void 0:l.garantia)||"",typeService:(l==null?void 0:l.typeService)||"local",service_image:(l==null?void 0:l.service_image)||(l==null?void 0:l.imagenes)||[]}}),Me=(await J(V(S,"Planes"))).docs.map(v=>({uid:v.id,nombre:v.data().nombre||"",descripcion:v.data().descripcion||"",monto:v.data().monto||0,status:v.data().status||"",vigencia:v.data().vigencia||"",cantidad_servicios:v.data().cantidad_servicios||0}));C(s),F(Oe),_(Me),g(f),y(je);const Ne=f==null?void 0:f.fecha_fin;if(Ne){const v=X(Ne);console.log("aqui la vigencia w",v),de(v)}w({nombre:(s==null?void 0:s.nombre)??"",image_perfil:(s==null?void 0:s.image_perfil)??"",email:(s==null?void 0:s.email)??"",phone:(s==null?void 0:s.phone)??"",rif:(s==null?void 0:s.rif)??"",status:(s==null?void 0:s.status)??"",Direccion:(s==null?void 0:s.Direccion)??"",LinkFacebook:(s==null?void 0:s.LinkFacebook)??"",LinkInstagram:(s==null?void 0:s.LinkInstagram)??"",LinkTiktok:(s==null?void 0:s.LinkTiktok)??"",whatsapp:(s==null?void 0:s.whatsapp)??"",estado:(s==null?void 0:s.estado)??"",ubicacion:s!=null&&s.ubicacion?{lat:s.ubicacion.lat,lng:s.ubicacion.lng}:{lat:0,lng:0},newLogoFile:(s==null?void 0:s.newLogoFile)??null})}catch(o){console.error("Error al obtener los datos del cliente:",o),N.push(e.jsx(j,{title:"Error",children:"Ocurrio un error al cargar los datos del cliente."}))}finally{H(!1)}};d.useEffect(()=>{T()},[]);const X=o=>{const a=Math.floor(Date.now()/1e3),b=o.seconds-a;return Math.ceil(b/(60*60*24))},me=o=>{const a=new Date(o.seconds*1e3),s=String(a.getDate()).padStart(2,"0"),b=String(a.getMonth()+1).padStart(2,"0"),f=a.getFullYear();return`${s}/${b}/${f}`},U=async o=>{try{const a=$(S,"Usuarios",m),s=$(V(S,"Subscripciones"));await Bo(s,{uid:s.id,nombre:o.nombre,monto:o.monto,vigencia:o.vigencia,cantidad_servicios:o.cantidad_servicios,status:"Por Aprobar",taller_uid:m,fechaCreacion:ie.fromDate(new Date)}),await ae(a,{subscripcion_actual:{uid:s.id,nombre:o.nombre,monto:o.monto,vigencia:o.vigencia,cantidad_servicios:o.cantidad_servicios,status:"Por Aprobar"}}),k(!0),await T(),He(),console.log("Subscripción actualizada y guardada en Subscripciones."),N.push(e.jsx(j,{title:"Éxito",type:"success",children:"Se ha subscrito correctamente a este plan."}))}catch(a){console.error("Error al guardar la subscripción:",a),N.push(e.jsx(j,{title:"Error",children:"Ocurrió un error al subscribirse a este plan. Inténtalo nuevamente."}))}},O=({title:o,value:a})=>e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("p",{className:"text-gray-700 dark:text-gray-200 font-semibold",children:a})]}),pe=(o,a)=>{xe(s=>{const b=s.filter(f=>f.id!==o);return a!==""&&b.push({id:o,value:a}),b})},G=o=>{const{name:a,value:s}=o.target;w(b=>({...b,[a]:s}))},[te,bo]=d.useState({facebook:"",instagram:"",tiktok:"",whatsapp:""}),jo=(o,a)=>({facebook:/^(https?:\/\/)?(www\.)?facebook\.com\/.+$/,instagram:/^(https?:\/\/)?(www\.)?instagram\.com\/.+$/,tiktok:/^(https?:\/\/)?(www\.)?tiktok\.com\/.+$/})[a].test(o)?"":`La URL ingresada no es válida para ${a}.`,_e=(o,a)=>{const{value:s}=o.target;w(f=>({...f,[`Link${a.charAt(0).toUpperCase()+a.slice(1)}`]:s}));const b=jo(s,a);bo(f=>({...f,[a]:b}))},No=async()=>{var o;if(!n.nombre||n.nombre.trim()===""){N.push(e.jsx(j,{title:"Error",children:"El nombre no puede estar vacío."}));return}if(!n.phone||!/^[1-9]\d*$/.test(n.phone)){N.push(e.jsx(j,{title:"Error",children:"El teléfono debe contener solo números y no puede comenzar con 0."}));return}if(n.whatsapp&&!/^[1-9]\d*$/.test(n.whatsapp)){N.push(e.jsx(j,{title:"Error",children:"El WhatsApp debe contener solo números y no puede comenzar con 0."}));return}if(!n.rif||!/^[JVEGCP]-\d+$/.test(n.rif)){N.push(e.jsx(j,{title:"Error",children:"El RIF debe estar en un formato válido (Ejemplo: J-12345678)."}));return}if(!n.Direccion||n.Direccion.trim()===""){N.push(e.jsx(j,{title:"Error",children:"La Direccion no puede estar vacía."}));return}if(!n.status){N.push(e.jsx(j,{title:"Error",children:"Debes seleccionar un estatus."}));return}if(!n.estado){N.push(e.jsx(j,{title:"Error",children:"Debes seleccionar un estado."}));return}try{const a=V(S,"Usuarios"),s=await J(a);if(s.docs.some(z=>z.data().rif===n.rif&&z.id!==m)){N.push(e.jsx(j,{title:"Error",children:"El RIF ya está registrado. Por favor, verifica e intenta con otro."}));return}if(s.docs.some(z=>z.data().phone===n.phone&&z.id!==m)){N.push(e.jsx(j,{title:"Error",children:"El teléfono ya está registrado. Por favor, verifica e intenta con otro."}));return}let ee=n.image_perfil;if(n.newLogoFile){const ue=(o=decodeURIComponent(n.image_perfil).split("/").pop())==null?void 0:o.split("?")[0],Oe=`${m}_`,Ie=ue==null?void 0:ue.match(/_(\d+)\.jpg$/),Me=Ie?parseInt(Ie[1],10):0,Ne=`${Oe}${Me+1}.jpg`,v=Ce(qe,`profileImages/${ue}`);try{await Uo(v)}catch(Mo){console.error("Error al eliminar la imagen anterior:",Mo)}const l=Ce(qe,`profileImages/${Ne}`);await Ke(l,n.newLogoFile),ee=await Ge(l)}const q=$(S,"Usuarios",m),je={...n,image_perfil:ee};if(delete je.newLogoFile,await ae(q,je),C({...n,image_perfil:ee}),M(!1),T(),console.log("Datos actualizados correctamente",n),console.log("Datos originales",A),(n==null?void 0:n.status)!==(A==null?void 0:A.status)){console.log("Cambio de estado kelfsklflksflks");try{await qo.post("https://apisolvers.solversapp.com/api/usuarios/sendNotification",{token:A==null?void 0:A.token,title:"Cambio de estatus",body:"Hola, su usuario ha cambiado de estado "+(n==null?void 0:n.status)+". Cierre sesión y vuelva a ingresar por favor.",secretCode:"Cambio de estado"})}catch(z){console.error("Error al enviar notificación:",z)}}N.push(e.jsx(j,{title:"Éxito",type:"success",children:"Datos de Usuario actualizados correctamente."}))}catch(a){console.error("Error al actualizar los datos:",a),N.push(e.jsx(j,{title:"Error",children:"Ocurrió un error al actualizar los datos del usuario. Inténtalo nuevamente."}))}},yo=async()=>{try{const o=$(S,"Usuarios",m);await ae(o,{metodos_pago:c}),N.push(e.jsx(j,{title:"Éxito",type:"success",children:"Métodos de pago actualizados correctamente."}))}catch(o){console.error("Error al guardar los métodos de pago:",o),N.push(e.jsx(j,{title:"Error",children:"Ocurrió un error al actualizar los métodos de pago. Inténtalo nuevamente."}))}},wo=[{name:"Pago móvil",icon:e.jsx(ta,{}),dbKey:"pagoMovil"},{name:"Transferencias bancarias",icon:e.jsx(sa,{}),dbKey:"transferencia"},{name:"Punto de venta",icon:e.jsx(Te,{}),dbKey:"puntoVenta"},{name:"Zinli",icon:e.jsx(io,{}),dbKey:"zinli"},{name:"Efectivo",icon:e.jsx(io,{}),dbKey:"efectivo"},{name:"Zelle",icon:e.jsx(ra,{}),dbKey:"zelle"},{name:"Tarjetas de crédito nacional",icon:e.jsx(Te,{}),dbKey:"tarjetaCreditoN"},{name:"Tarjetas de crédito internacional",icon:e.jsx(Te,{}),dbKey:"tarjetaCreditoI"}],He=()=>B(!1),vo=()=>M(!0),[he,xe]=d.useState([]),[ke,Re]=d.useState([]),{TabNav:Ze,TabList:Co,TabContent:Ye}=co,So=[{header:"Nombre del Servicio",accessorKey:"nombre_servicio"},{header:"Precio",accessorKey:"precio",cell:({row:o})=>`$${parseFloat(o.original.precio).toFixed(2)}`},{header:"Estatus",accessorKey:"estatus",cell:({row:o})=>{const[a,s]=d.useState(o.original.estatus??!1),b=async f=>{s(f);const ee=E.map(q=>q.uid_servicio===o.original.uid_servicio?{...q,estatus:f}:q);F(ee);try{const q=$(S,"Servicios",o.original.uid_servicio);await ae(q,{estatus:f}),console.log("Estado del servicio actualizado")}catch(q){console.error("Error al actualizar el estado del servicio:",q)}};return e.jsx("div",{children:e.jsx(Go,{checked:a,onChange:()=>b(!a)})})}},{header:"Acciones",id:"actions",cell:({row:o})=>e.jsx("div",{className:"",children:e.jsx(oe,{size:"sm",variant:"solid",onClick:()=>Ao(o.original),className:"text-blue-900 hover:bg-blue-700",children:e.jsx(Qo,{})})})}],Eo=[{header:"Nombre del Plan",accessorKey:"nombre"},{header:"Monto",accessorKey:"monto"},{header:"Descripcion",accessorKey:"descripcion"},{header:"Cantidad de servicios",accessorKey:"cantidad_servicios"}],_o=[{header:"Nombre del Plan",accessorKey:"nombre"},{header:"Monto",accessorKey:"monto"},{header:"vigencia",accessorKey:"vigencia"},{header:"Fecha de vencimiento",accessorKey:"fecha_fin",cell:({row:o})=>`${me(o.original.fecha_fin)}`}],{Tr:re,Th:fe,Td:be,THead:Le,TBody:De,Sorter:ma}=ye,Pe=$e({data:E,columns:So,state:{sorting:ke,columnFilters:he},onSortingChange:Re,onColumnFiltersChange:xe,getCoreRowModel:Fe(),getSortedRowModel:Be(),getFilteredRowModel:Ue()}),Je=$e({data:se,columns:Eo,state:{sorting:ke,columnFilters:he},onSortingChange:Re,onColumnFiltersChange:xe,getCoreRowModel:Fe(),getSortedRowModel:Be(),getFilteredRowModel:Ue()}),We=$e({data:h,columns:_o,state:{sorting:ke,columnFilters:he},onSortingChange:Re,onColumnFiltersChange:xe,getCoreRowModel:Fe(),getSortedRowModel:Be(),getFilteredRowModel:Ue()}),[Z,ko]=d.useState(1),Y=6,Qe=Pe.getRowModel().rows.length,Xe=o=>{console.log("onPaginationChange",o),ko(o)},[Ro,Lo]=d.useState(!1),[Do,eo]=d.useState(!1),[Po,oo]=d.useState(null),Ae=()=>{Lo(o=>!o)},Ao=o=>{oo(o),eo(!0)},Oo=()=>{eo(!1),oo(null)},Io=()=>{T()};return e.jsxs(zo,{className:"min-h-screen overflow-y-auto pb-8",children:[x&&e.jsx("div",{className:"flex items-center",children:e.jsxs("button",{onClick:()=>u(`${Ko}/garages`),className:"flex items-center text-blue-900 mb-3 ml-2 px-4 py-2 bg-blue-100 rounded-lg hover:bg-blue-200 transition duration-200",children:[e.jsx(Ho,{className:"mr-2"}),e.jsx("span",{children:"Volver"})]})}),e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 pb-8",children:[e.jsxs(ro,{children:[e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{className:"bg-[#1d1e56] rounded-md p-2 hover:bg-[#1E3a8a] text-white",onClick:vo,children:"Editar"})}),e.jsxs("div",{className:"flex flex-col xl:justify-between min-w-[260px] h-full 2xl:min-w-[360px] mx-auto",children:[e.jsxs("div",{className:"flex xl:flex-col items-center gap-4",children:[e.jsx(no,{size:90,shape:"circle",src:(r==null?void 0:r.image_perfil)||"/img/logo/logo-light-streamline.png",className:"p-2 bg-white shadow-lg"}),e.jsx("h4",{className:"font-bold",children:(r==null?void 0:r.nombre)||"Nombre no disponible"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-y-7 gap-x-4 mt-8",children:[e.jsx(O,{title:"Correo electronico",value:(r==null?void 0:r.email)||"Correo no disponible"}),e.jsx(O,{title:"Numero de telefono",value:(r==null?void 0:r.phone)||"Telefono no disponible"}),e.jsx(O,{title:"Rif",value:(r==null?void 0:r.rif)||"Rif no disponible"}),e.jsx(O,{title:"Estado",value:(r==null?void 0:r.estado)||"Estado no disponible"}),e.jsx(O,{title:"Estatus",value:(r==null?void 0:r.status)||"Estatus no disponible"}),e.jsx(O,{title:"Direccion",value:(r==null?void 0:r.Direccion)||"Direccion no disponible"}),r!=null&&r.ubicacion?e.jsx(ia,{center:{lat:r.ubicacion.lat,lng:r.ubicacion.lng},markers:[{lat:r.ubicacion.lat,lng:r.ubicacion.lng}]}):"Ubicación no disponible",e.jsxs("div",{className:"mb-7",children:[e.jsx("span",{children:"Redes Sociales"}),e.jsx("div",{className:"flex mt-4 gap-2",children:r!=null&&r.LinkFacebook||r!=null&&r.LinkInstagram||r!=null&&r.whatsapp||r!=null&&r.LinkTiktok?e.jsxs(e.Fragment,{children:[r.LinkFacebook&&e.jsx("a",{href:r.LinkFacebook,target:"_blank",rel:"noopener noreferrer",title:r.LinkFacebook,children:e.jsx(oe,{shape:"circle",size:"sm",icon:e.jsx(Zo,{className:"text-[#1773ea]"})})}),r.LinkInstagram&&e.jsx("a",{href:r.LinkInstagram,target:"_blank",rel:"noopener noreferrer",title:r.LinkInstagram,children:e.jsx(oe,{shape:"circle",size:"sm",icon:e.jsx(Yo,{className:"text-[#E1306C]"})})}),r.LinkTiktok&&e.jsx("a",{href:r.LinkTiktok,target:"_blank",rel:"noopener noreferrer",title:r.LinkTiktok,children:e.jsx(oe,{shape:"circle",size:"sm",icon:e.jsx(Jo,{className:"text-black"})})}),r.whatsapp&&e.jsx("a",{href:`https://wa.me/${r.whatsapp}?text=${encodeURIComponent("Hola, quiero más información sobre el servicio")}`,target:"_blank",rel:"noopener noreferrer",title:r.whatsapp,children:e.jsx(oe,{shape:"circle",size:"sm",icon:e.jsx(Wo,{className:"text-[#25d366]"})})})]}):e.jsx("p",{className:"text-gray-500",children:"No hay redes sociales disponibles"})})]})]})]})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs(co,{defaultValue:"tab1",children:[e.jsxs(Co,{children:[e.jsx(Ze,{value:"tab1",children:"Planes"}),e.jsx(Ze,{value:"tab2",children:"Servicios"})]}),e.jsx("div",{className:"w-full",children:e.jsx(Ye,{value:"tab1",children:e.jsxs("div",{className:"mb-8 mt-4",children:[e.jsx("h6",{className:"mb-4",children:"Subscripción"}),e.jsx(ro,{bordered:!0,className:"mb-4",children:t?e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 p-4 border rounded-lg shadow-md bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(no,{className:"bg-transparent",shape:"circle",icon:e.jsx(ea,{className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:(p==null?void 0:p.nombre)||"Cargando..."}),e.jsx(Xo,{className:`rounded-md border-0 mx-2 ${(p==null?void 0:p.status)==="Aprobado"?"bg-green-100 text-green-400":(p==null?void 0:p.status)==="Vencido"?"bg-red-100 text-red-400":"bg-yellow-100 text-yellow-400"}`,children:(p==null?void 0:p.status)||"Pendiente"})]}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Vigencia:"," ",(p==null?void 0:p.vigencia)??"---"," ","días"]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Monto mensual:"," ",e.jsxs("span",{className:"font-bold text-gray-800",children:["$",(p==null?void 0:p.monto)??"---"]})]}),(p==null?void 0:p.status)==="Aprobado"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs ml-2 text-gray-600",children:[Q??"---"," ","días restantes"]}),e.jsxs("p",{className:"text-xs ml-2 text-gray-600",children:["Fecha de vencimiento:"," ",e.jsx("span",{className:"text-xs text-gray-600",children:p.fecha_fin?me(p.fecha_fin):"Fecha no disponible"})]})]})]})]})]}),(p==null?void 0:p.status)==="Vencido"&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{onClick:()=>B(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition duration-200",children:"Elegir Plan"})}),(p==null?void 0:p.status)==="Aprobado"&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{onClick:()=>B(!0),className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Renovar Pago"})}),(p==null?void 0:p.status)==="Por Aprobar"&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx(na,{talleruid:m,subscriptionId:(ao=h[0])==null?void 0:ao.uid})})]}):e.jsxs("div",{className:"flex justify-end",children:[e.jsx("p",{className:"text-xs mr-64 mt-3",children:"Puede visualizar y suscribirse a un plan para su taller..."}),e.jsx("button",{onClick:()=>B(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition duration-200",children:"Ver Planes"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"p-4 rounded-lg shadow",children:[e.jsx("h6",{className:"mb-6 flex justify-start mt-4",children:"Historial de Subscripciones"}),e.jsxs(ye,{className:"w-full rounded-lg",children:[e.jsx(Le,{children:We.getHeaderGroups().map(o=>e.jsx(re,{children:o.headers.map(a=>e.jsx(fe,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsx("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:ne(a.column.columnDef.header,a.getContext())})},a.id))},o.id))}),e.jsx(De,{children:We.getRowModel().rows.slice((Z-1)*Y,Z*Y).map(o=>e.jsx(re,{children:o.getVisibleCells().map(a=>e.jsx(be,{children:ne(a.column.columnDef.cell,a.getContext())},a.id))},o.id))})]}),e.jsx(lo,{onChange:Xe,currentPage:Z,totalRows:Qe,rowsPerPage:Y})]})}),e.jsx("div",{className:"border-t border-gray-300 my-4"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 p-4",children:wo.map(o=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oa,{checked:c[o.dbKey]||!1,onChange:a=>{i(s=>({...s,[o.dbKey]:a}))}}),e.jsx("span",{children:o.icon}),e.jsx("span",{children:o.name})]},o.name))}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:yo,className:"px-4 py-2 bg-[#1d1e56] text-white rounded-md hover:bg-blue-900 focus:outline-none",children:"Guardar"})})]})})}),e.jsx(Ye,{value:"tab2",children:e.jsx("div",{className:"w-full h-full",children:e.jsxs("div",{className:"p-4 rounded-lg",children:[e.jsx("h6",{className:"mb-6 flex justify-start mt-4",children:"Lista de Servicios"}),e.jsxs(ye,{className:"w-full rounded-lg",children:[e.jsx(Le,{children:Pe.getHeaderGroups().map(o=>e.jsx(re,{children:o.headers.map(a=>e.jsx(fe,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsx("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:ne(a.column.columnDef.header,a.getContext())})},a.id))},o.id))}),e.jsx(De,{children:Pe.getRowModel().rows.slice((Z-1)*Y,Z*Y).map(o=>e.jsx(re,{children:o.getVisibleCells().map(a=>e.jsx(be,{children:ne(a.column.columnDef.cell,a.getContext())},a.id))},o.id))})]}),e.jsx(lo,{onChange:Xe,currentPage:Z,totalRows:Qe,rowsPerPage:Y})]})})})]})})]}),e.jsx(uo,{width:1e3,isOpen:ce,onClose:He,children:e.jsxs("div",{className:"table-responsive",children:[e.jsx("h2",{className:"mb-4",children:"Planes de Subscripción"}),e.jsx("div",{className:"p-2 rounded-lg shadow",children:e.jsxs(ye,{className:"w-full rounded-lg",children:[e.jsx(Le,{children:Je.getHeaderGroups().map(o=>e.jsxs(re,{children:[o.headers.map(a=>{var s,b;return e.jsx(fe,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsxs("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:[ne(a.column.columnDef.header,a.getContext()),a.column.getCanFilter()?e.jsx("input",{type:"text",value:((b=(s=he.find(f=>f.id===a.id))==null?void 0:s.value)==null?void 0:b.toString())||"",onChange:f=>pe(a.id,f.target.value),placeholder:"Buscar",className:"mt-2 p-1 border rounded",onClick:f=>f.stopPropagation()}):null]})},a.id)}),e.jsx(fe,{children:"Acción"})," "]},o.id))}),e.jsx(De,{children:Je.getRowModel().rows.slice((Z-1)*Y,Z*Y).map(o=>e.jsxs(re,{children:[o.getVisibleCells().map(a=>e.jsx(be,{children:ne(a.column.columnDef.cell,a.getContext())},a.id)),e.jsx(be,{children:e.jsx("button",{className:"bg-[#1d1e56] text-white px-4 py-2 rounded",onClick:()=>U(o.original),children:"Suscribirse"})})]},o.id))})]})})]})}),R&&e.jsx(Vo,{isOpen:R,title:"Editar Taller",confirmButtonColor:"blue-600",onClose:()=>M(!1),onRequestClose:()=>M(!1),onCancel:()=>M(!1),onConfirm:No,children:e.jsxs("div",{className:"max-h-[450px] overflow-y-auto",children:[e.jsx("div",{className:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10 gap-2",children:e.jsxs("div",{className:"text-center",children:[!n.image_perfil&&!n.newLogoFile?e.jsx(Ve,{className:"mx-auto h-12 w-12 text-gray-300","aria-hidden":"true"}):e.jsxs("div",{children:[e.jsx("img",{src:n.newLogoFile?URL.createObjectURL(n.newLogoFile):n.image_perfil,alt:"Preview Logo",className:"mx-auto h-32 w-32 object-cover"}),e.jsx("button",{onClick:()=>w(o=>({...o,newLogoFile:null,image_perfil:""})),className:"mt-2 text-red-500 hover:text-red-700",children:"Quitar Logo"})]}),e.jsx("div",{className:"mt-4 flex text-sm leading-6 text-gray-600 justify-center",children:e.jsxs("label",{htmlFor:"logo-upload",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500 flex justify-center items-center",children:[e.jsx("span",{children:n.newLogoFile?"Cambiar Logo":"Seleccionar Logo"}),e.jsx("input",{id:"logo-upload",name:"logo-upload",type:"file",accept:"image/*",className:"sr-only",onChange:o=>{var s;const a=(s=o.target.files)==null?void 0:s[0];w(b=>({...b,newLogoFile:a||null}))}})]})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Nombre"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Nombre",name:"nombre",value:n.nombre,onChange:G})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Correo Electrónico"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Correo Electrónico",disabled:!0,name:"email",value:n.email,onChange:G})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Teléfono"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Teléfono",name:"phone",value:n.phone,onChange:G,onKeyDown:o=>{o.currentTarget.value===""&&o.key==="0"&&o.preventDefault()},onInput:o=>{const a=o.target,s=a.value.replace(/^0+/,"");s!==a.value&&w(b=>({...b,phone:s}))}})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"WhatsApp"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"WhatsApp",name:"whatsapp",value:n.whatsapp,onChange:G,onKeyDown:o=>{o.currentTarget.value===""&&o.key==="0"&&o.preventDefault()},onInput:o=>{const a=o.target,s=a.value.replace(/^0+/,"");s!==a.value&&w(b=>({...b,whatsapp:s}))}})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"RIF:"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsxs("select",{value:((so=n.rif)==null?void 0:so.split("-")[0])||"J",onChange:o=>w(a=>{var s;return{...a,rif:`${o.target.value}-${((s=a==null?void 0:a.rif)==null?void 0:s.split("-")[1])||""}`}}),className:"mx-2 p-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"J",children:"J-"}),e.jsx("option",{value:"V",children:"V-"}),e.jsx("option",{value:"E",children:"E-"}),e.jsx("option",{value:"C",children:"C-"}),e.jsx("option",{value:"G",children:"G-"}),e.jsx("option",{value:"P",children:"P-"})]}),e.jsx("input",{disabled:!0,type:"text",value:((to=n.rif)==null?void 0:to.split("-")[1])||"",onChange:o=>w(a=>{var s;return{...a,rif:`${((s=a==null?void 0:a.rif)==null?void 0:s.split("-")[0])||"J"}-${o.target.value}`}}),className:"p-3 border border-gray-300 rounded-r-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 mx-2 w-full"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Estado:"}),e.jsxs("select",{name:"estado",value:n.estado,onChange:G,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"",children:"Seleccione un Estado"}),["Amazonas","Anzoátegui","Apure","Aragua","Barinas","Bolívar","Carabobo","Cojedes","Delta Amacuro","Distrito Capital","Falcón","Guárico","Lara","La Guaira","Mérida","Miranda","Monagas","Nueva Esparta","Portuguesa","Sucre","Táchira","Trujillo","Yaracuy","Zulia"].map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Direccion"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"",name:"Direccion",value:n.Direccion,onChange:G})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Mapa"}),e.jsx("button",{type:"button",className:"w-full mt-1 p-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring focus:ring-blue-300",onClick:Ae,children:"Abrir Mapa"})]}),Ro&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-3xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Editar ubicación"}),e.jsx("button",{className:"text-gray-600 hover:text-gray-800 focus:outline-none",onClick:Ae,children:"✖"})]}),e.jsx(la,{initialLocation:{lat:n.ubicacion.lat,lng:n.ubicacion.lng},onLocationChange:o=>w(a=>({...a,ubicacion:o}))}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring focus:ring-blue-300",onClick:Ae,children:"Guardar"})})]})}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Estatus"}),e.jsxs("select",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",name:"status",value:n.status,onChange:G,children:[e.jsx("option",{value:"Aprobado",children:"Aprobado"}),e.jsx("option",{value:"Pendiente",children:"Pendiente"}),e.jsx("option",{value:"Rechazado",children:"Rechazado"}),e.jsx("option",{value:"En espera por aprobación",children:"En espera por aprobación"})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Facebook"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de Facebook",name:"LinkFacebook",value:n.LinkFacebook,onChange:o=>_e(o,"facebook")}),te.facebook&&e.jsx("span",{className:"text-red-500 text-sm",children:te.facebook})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Instagram"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de Instagram",name:"LinkInstagram",value:n.LinkInstagram,onChange:o=>_e(o,"instagram")}),te.instagram&&e.jsx("span",{className:"text-red-500 text-sm",children:te.instagram})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"TikTok"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de TikTok",name:"LinkTiktok",value:n.LinkTiktok,onChange:o=>_e(o,"tiktok")}),te.tiktok&&e.jsx("span",{className:"text-red-500 text-sm",children:te.tiktok})]})]})]})}),e.jsx(da,{isOpen:Do,onClose:Oo,service:Po,onServiceUpdated:Io})]})};export{Is as default};
