import{a0 as P,a1 as H,b3 as L,a2 as Y,a3 as V,r as m,a as x,j as s,as as _,a4 as I,L as G,a5 as J}from"./index-_feUBWkF.js";import{f as Q,g as U}from"./SalesService-CV3OFujh.js";import{A as W}from"./AdaptableCard-CKf0cL3z.js";import{B as X}from"./Badge-TmEmdow9.js";import{T as N}from"./Tooltip-tqY3hXOR.js";import{D as Z}from"./DataTable-g89ajmbS.js";import{ag as ee,R as k,D as te,aC as se}from"./index.esm-CyL_iEBq.js";import{N as ae}from"./react-number-format.es-AowE_8Dl.js";import{u as v}from"./useThemeClass-Gzk1KTJ6.js";import{c as b}from"./cloneDeep-GJ9f8YIY.js";import{B as M}from"./Button-jcq0xEfh.js";import{I as oe}from"./Input-E8Xy-NaX.js";import{d as re}from"./debounce-Vnjl_Fqd.js";import{t as le,N as ne}from"./toast-GgiGqW4N.js";import{C as ie}from"./ConfirmDialog-9D1ythLk.js";import"./ApiService-t5__pVY7.js";import"./Card-fXn1hgP9.js";import"./index.esm-bIknb-8m.js";import"./floating-ui.react-AOig1bqs.js";import"./floating-ui.dom-0rLBacrf.js";import"./index-C1ft9MxP.js";import"./motion-2zhnpuIh.js";import"./index--K6mHtPM.js";import"./index.esm-c6ShvaQW.js";import"./index-VNg9U51V.js";import"./Select-9xvaqg6U.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./Views-NoPs0swz.js";import"./get-iuu1b1Bt.js";import"./_MapCache-HrqL2mpR.js";import"./toString-LmJFJgEq.js";import"./context-w88CtZWU.js";import"./index-H_ZscJuo.js";import"./_getAllKeys-ubi2BvIA.js";import"./_baseIsEqual-d0iTpr48.js";import"./TableRowSkeleton-zSns7b9c.js";import"./Skeleton-v_ck5RJ1.js";import"./index-IwiwqbVe.js";import"./isNil-uGA-FeKR.js";import"./useTimeout-lvoBzkZb.js";import"./CloseButton-0JjgPcqS.js";import"./StatusIcon-mkSwP6mg.js";import"./chainedFunction-ltcSYACe.js";import"./index-vYF_FpU2.js";import"./useMergeRef-Rt_Crb27.js";import"./Dialog-v8uTeGhc.js";import"./index-8Gigl45y.js";import"./index-Xr0iHSGr.js";const A="salesOrderList",h=P(A+"/getOrders",async t=>(await Q(t)).data),T=async t=>(await U(t)).data,ce={loading:!1,orderList:[],tableData:{total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},selectedRows:[],selectedRow:"",deleteMode:""},B=H({name:`${A}/state`,initialState:ce,reducers:{setOrderList:(t,e)=>{t.orderList=e.payload},setTableData:(t,e)=>{t.tableData=e.payload},setSelectedRows:(t,e)=>{t.selectedRows=e.payload},setSelectedRow:(t,e)=>{t.selectedRow=e.payload},addRowItem:(t,{payload:e})=>{const o=L(t);o.selectedRows.includes(e)||(t.selectedRows=[...o.selectedRows,...e])},removeRowItem:(t,{payload:e})=>{const o=L(t);o.selectedRows.includes(e)&&(t.selectedRows=o.selectedRows.filter(l=>l!==e))},setDeleteMode:(t,e)=>{t.deleteMode=e.payload}},extraReducers:t=>{t.addCase(h.fulfilled,(e,o)=>{e.orderList=o.payload.data,e.tableData.total=o.payload.total,e.loading=!1}).addCase(h.pending,e=>{e.loading=!0})}}),{setOrderList:wt,setTableData:w,setSelectedRows:j,setSelectedRow:S,addRowItem:de,removeRowItem:me,setDeleteMode:C}=B.actions,pe=B.reducer,ue=Y({data:pe}),p=V,R={0:{label:"Paid",dotClass:"bg-emerald-500",textClass:"text-emerald-500"},1:{label:"Pending",dotClass:"bg-amber-500",textClass:"text-amber-500"},2:{label:"Failed",dotClass:"bg-red-500",textClass:"text-red-500"}},ge=({paymentMehod:t,className:e})=>{switch(t){case"visa":return s.jsx("img",{className:e,src:"/img/others/img-8.png",alt:t});case"master":return s.jsx("img",{className:e,src:"/img/others/img-9.png",alt:t});case"paypal":return s.jsx("img",{className:e,src:"/img/others/img-10.png",alt:t});default:return s.jsx(s.Fragment,{})}},he=({row:t})=>{const{textTheme:e}=v(),o=I(),l=m.useCallback(()=>{o(`/app/sales/order-details/${t.id}`)},[o,t]);return s.jsxs("span",{className:`cursor-pointer select-none font-semibold hover:${e}`,onClick:l,children:["#",t.id]})},xe=({row:t})=>{const e=x(),{textTheme:o}=v(),l=I(),d=()=>{e(C("single")),e(S([t.id]))},c=m.useCallback(()=>{l(`/app/sales/order-details/${t.id}`)},[l,t]);return s.jsxs("div",{className:"flex justify-end text-lg",children:[s.jsx(N,{title:"View",children:s.jsx("span",{className:`cursor-pointer p-2 hover:${o}`,onClick:c,children:s.jsx(ee,{})})}),s.jsx(N,{title:"Delete",children:s.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:d,children:s.jsx(k,{})})})]})},fe=()=>{const t=m.useRef(null),e=x(),{pageIndex:o,pageSize:l,sort:d,query:c,total:u}=p(a=>a.salesOrderList.data.tableData),i=p(a=>a.salesOrderList.data.loading),n=p(a=>a.salesOrderList.data.orderList),f=m.useCallback(()=>{console.log("{ pageIndex, pageSize, sort, query }",{pageIndex:o,pageSize:l,sort:d,query:c}),e(h({pageIndex:o,pageSize:l,sort:d,query:c}))},[e,o,l,d,c]);m.useEffect(()=>{e(j([])),f()},[e,f,o,l,d]),m.useEffect(()=>{var a;t&&((a=t.current)==null||a.resetSelected())},[n]);const g=m.useMemo(()=>({pageIndex:o,pageSize:l,sort:d,query:c,total:u}),[o,l,d,c,u]),z=m.useMemo(()=>[{header:"Order",accessorKey:"id",cell:a=>s.jsx(he,{row:a.row.original})},{header:"Date",accessorKey:"date",cell:a=>{const r=a.row.original;return s.jsx("span",{children:_.unix(r.date).format("DD/MM/YYYY")})}},{header:"Customer",accessorKey:"customer"},{header:"Status",accessorKey:"status",cell:a=>{const{status:r}=a.row.original;return s.jsxs("div",{className:"flex items-center",children:[s.jsx(X,{className:R[r].dotClass}),s.jsx("span",{className:`ml-2 rtl:mr-2 capitalize font-semibold ${R[r].textClass}`,children:R[r].label})]})}},{header:"Payment Method",accessorKey:"paymentMehod",cell:a=>{const{paymentMehod:r,paymentIdendifier:D}=a.row.original;return s.jsxs("span",{className:"flex items-center",children:[s.jsx(ge,{className:"max-h-[20px]",paymentMehod:r}),s.jsx("span",{className:"ltr:ml-2 rtl:mr-2",children:D})]})}},{header:"Total",accessorKey:"totalAmount",cell:a=>{const{totalAmount:r}=a.row.original;return s.jsx(ae,{displayType:"text",value:(Math.round(r*100)/100).toFixed(2),prefix:"$",thousandSeparator:!0})}},{header:"",id:"action",cell:a=>s.jsx(xe,{row:a.row.original})}],[]),E=a=>{const r=b(g);r.pageIndex=a,e(w(r))},$=a=>{const r=b(g);r.pageSize=Number(a),r.pageIndex=1,e(w(r))},F=a=>{const r=b(g);r.sort=a,e(w(r))},K=(a,r)=>{e(a?de([r.id]):me(r.id))},q=m.useCallback((a,r)=>{if(a){const D=r.map(y=>y.original),O=[];D.forEach(y=>{O.push(y.id)}),e(j(O))}else e(j([]))},[e]);return s.jsx(Z,{ref:t,selectable:!0,columns:z,data:n,loading:i,pagingData:{total:g.total,pageIndex:g.pageIndex,pageSize:g.pageSize},onPaginationChange:E,onSelectChange:$,onSort:F,onCheckBoxChange:K,onIndeterminateCheckBoxChange:q})},be=()=>{const t=x(),e=m.useRef(null),o=p(i=>i.salesOrderList.data.tableData),l=re(d,500);function d(i){const n=b(o);n.query=i,n.pageIndex=1,typeof i=="string"&&i.length>1&&c(n),typeof i=="string"&&i.length===0&&c(n)}const c=i=>{t(w(i)),t(h(i))},u=i=>{l(i.target.value)};return s.jsx(oe,{ref:e,className:"lg:w-52",size:"sm",placeholder:"Search",prefix:s.jsx(te,{className:"text-lg"}),onChange:u})},we=()=>{const t=x(),e=()=>{t(C("batch"))};return s.jsx(M,{variant:"solid",color:"red-600",size:"sm",icon:s.jsx(k,{}),onClick:e,children:"Batch Delete"})},je=()=>{const t=p(e=>e.salesOrderList.data.selectedRows);return s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[t.length>0&&s.jsx(we,{}),s.jsx(G,{download:!0,to:"/data/order-list.csv",target:"_blank",children:s.jsx(M,{block:!0,size:"sm",icon:s.jsx(se,{}),children:"Export"})}),s.jsx(be,{})]})},Ce=()=>{const t=x(),e=p(n=>n.salesOrderList.data.selectedRows),o=p(n=>n.salesOrderList.data.selectedRow),l=p(n=>n.salesOrderList.data.deleteMode),d=p(n=>n.salesOrderList.data.tableData),c=()=>{t(C("")),l==="single"&&t(S([]))},u=async()=>{if(t(C("")),l==="single"){const n=await T({id:o});i(n),t(S([]))}if(l==="batch"){const n=await T({id:e});i(n,e.length),t(j([]))}},i=(n,f=0)=>{n&&(t(h(d)),le.push(s.jsxs(ne,{title:"Successfuly Deleted",type:"success",duration:2500,children:[l==="single"&&"Order ",l==="batch"&&`${f} orders `,"successfuly deleted"]}),{placement:"top-center"}))};return s.jsx(ie,{isOpen:l==="single"||l==="batch",type:"danger",title:"Delete product",confirmButtonColor:"red-600",onClose:c,onRequestClose:c,onCancel:c,onConfirm:u,children:s.jsx("p",{children:"Are you sure you want to delete this order? All record related to this order will be deleted as well. This action cannot be undone."})})};J("salesOrderList",ue);const De=()=>s.jsxs(W,{className:"h-full",bodyClass:"h-full",children:[s.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"mb-4 lg:mb-0",children:"Orders"}),s.jsx(je,{})]}),s.jsx(fe,{}),s.jsx(Ce,{})]}),jt=De;export{jt as default};
