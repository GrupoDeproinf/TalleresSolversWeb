import{r as o,j as e,a7 as ce,a8 as E,a9 as j,aa as de,ae as me,af as R,ag as ue}from"./index-ATNefdVG.js";import{P as pe}from"./index-Rjm_CfUD.js";import{T as k}from"./index-1QBWWPtH.js";import{u as xe,f as O,g as ge,a as he,b as fe}from"./index-mu3rsG90.js";import{m as be,p as je,q as ve}from"./index.esm-SLyUBwzt.js";import{z as ye}from"./index-Joeg65xT.js";import{B as p}from"./Button-m8cr7QK0.js";import{t as i,N as l}from"./toast-ArUM2hkn.js";import"./Alert-YDCIg78L.js";import"./index-74gKM8Gk.js";import"./Badge-7j32ABcM.js";import"./Calendar-kXRbY7HP.js";import"./Card-OSPH2pm3.js";import"./index-J2oOIxTS.js";import"./index-Ww4KSR8x.js";import"./Dialog-01bjbLh0.js";import{D as P}from"./Drawer-TF5epqni.js";import"./index-OgT6bzbj.js";import"./FormItem-YT9PXtwB.js";import"./Input-esXMioi-.js";import"./index-Yk7DAYzs.js";import"./index-AdZu4ZEf.js";import"./index-Njt5DKLW.js";import"./Progress-8N-5zDn7.js";import"./index-Xj1V1DYV.js";import"./RangeCalendar-KFdi8RAV.js";import"./ScrollBar-wOU87srT.js";import"./index-wOmcTQB3.js";import"./Select-meFjX2OX.js";import"./Skeleton-rqvm5li9.js";import"./index-yyjad8ES.js";import{S as Ne}from"./Switcher-Q2_gTjX7.js";import"./index-8Ze0HwPQ.js";import"./Tag-jU5n4W4w.js";import"./index-9p-8nnWt.js";import"./index-O5FvOx90.js";import"./Tooltip-RPBixJuV.js";import"./Upload-sm3Naufp.js";import{c as we,a as v,g as _}from"./index.esm-veTBKOrz.js";import{F as Ce,a as Se,b as d,E as m}from"./formik.esm-dqEqoyez.js";import{O as De,D as Fe}from"./index.esm-RzyebFAI.js";import"./context-GUUKwgTl.js";import"./useTimeout-1ykP9PCU.js";import"./CloseButton-27bnAAMk.js";import"./StatusIcon-yBHceAv6.js";import"./chainedFunction-ltcSYACe.js";import"./motion-qY3QHwHT.js";import"./useMergeRef-Rt_Crb27.js";import"./useControllableState-TaiAnLFv.js";import"./cloneDeep-yGYZIkRg.js";import"./_getAllKeys-eyRctv10.js";import"./_MapCache-_63I7Bc7.js";import"./Views-oxXEUsSY.js";import"./_baseIsEqual-u0EOHXHy.js";import"./get-GDY1XD6s.js";import"./toString-LadLPz1K.js";import"./floating-ui.react-6woUHVe8.js";import"./floating-ui.dom-0rLBacrf.js";import"./TimeInput-EwrvAjFc.js";import"./useUniqueId-q2Q7KHj7.js";import"./useDidUpdate-R-Sv0J0Y.js";import"./index-lc_qXIiG.js";import"./index-D5lh9mO-.js";import"./useRootClose-2Ks0vhqk.js";import"./isNil-qbgWSuln.js";import"./index-LDVYzlxf.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./mapCloneElement-I1EKrR-t.js";import"./index.esm-6sKRXwnY.js";import"./index.esm-5SxxohUP.js";const Ee=()=>{const[M,T]=o.useState([]),[q,H]=o.useState([]),[I,x]=o.useState([]);o.useState(!1);const[y,$]=o.useState("nombre"),[g,B]=o.useState(""),[t,h]=o.useState(null),[z,f]=o.useState(!1),u=async()=>{const s=ce(E(j,"Planes")),a=await de(s),r=[];a.forEach(n=>{const le=n.data();r.push({...le,uid:n.id})}),T(r)};o.useEffect(()=>{u()},[]);const V=async()=>{await u(),i.push(e.jsx(l,{title:"Datos actualizados",children:"La tabla ha sido actualizada con éxito."}))},[K,c]=o.useState(!1),[Re,L]=o.useState({nombre:"",descripcion:"",cantidad_servicios:0,monto:"",status:"",vigencia:"",uid:"",id:""}),A=s=>{h(s),f(!0)},G=we().shape({nombre:v().required("El nombre es obligatorio").min(3,"El nombre debe tener al menos 3 caracteres"),descripcion:v().required("La descripción es obligatoria").min(5,"La descripción debe tener al menos 5 caracteres"),cantidad_servicios:_().typeError("Debe ingresar un número en la cantidad de servicios").required("La cantidad de servicios es obligatoria").integer("Debe ser un número entero").positive("Debe ser un número positivo"),monto:_().typeError("Debe ingresar un número en el monto").required("El monto es obligatorio").positive("Debe ser un monto positivo"),vigencia:v().required("La vigencia es obligatoria").matches(/^\d+$/,"La vigencia debe ser un número válido")}),Y=async s=>{try{const a=E(j,"Planes"),r=await me(a,{nombre:s.nombre,descripcion:s.descripcion,cantidad_servicios:s.cantidad_servicios,monto:s.monto,status:"Activo",vigencia:s.vigencia,uid:""});await R(r,{uid:r.id}),i.push(e.jsx(l,{title:"Éxito",children:"Plan creado con éxito."})),c(!1),u()}catch(a){if(a instanceof ye.ZodError){const r=a.errors.map(n=>n.message).join(", ");i.push(e.jsx(l,{title:"Error",children:r}))}else console.error("Error creando plan:",a),i.push(e.jsx(l,{title:"Error",children:"Hubo un error al crear el plan."}))}},Z=s=>{const a=s.target.value;B(a),x([{id:y,value:a}])},J=s=>{const a=s.target.value;$(a),g!==""&&x([{id:a,value:g}])},Q=async()=>{if(t)try{const s=ue(j,"Planes",t.uid);await R(s,{nombre:t.nombre,descripcion:t.descripcion,cantidad_servicios:t.cantidad_servicios,monto:t.monto,status:t.status,vigencia:t.vigencia}),i.push(e.jsx(l,{title:"Éxito",children:"Plan actualizado con éxito."})),f(!1),u()}catch(s){console.error("Error actualizando el plan:",s),i.push(e.jsx(l,{title:"Error",children:"Hubo un error al actualizar el plan."}))}},U=[{header:"Nombre",accessorKey:"nombre",cell:({getValue:s})=>s(),filterFn:"includesString",footer:s=>s.column.id},{header:"Descripcion",accessorKey:"descripcion",filterFn:"includesString"},{header:"Cantidad de Servicios",accessorKey:"cantidad_servicios",filterFn:"includesString"},{header:"Monto",accessorKey:"monto",filterFn:"includesString",cell:({row:s})=>`$${parseFloat(s.original.monto).toFixed(2)}`},{header:"Vigencia",accessorKey:"vigencia",filterFn:"includesString"},{header:"Estado",accessorKey:"status",cell:({row:s})=>{const a=s.getValue("status");let r,n;switch(a){case"Activo":r=e.jsx(ve,{className:"text-green-500 mr-1"}),n="text-green-500";break;case"Inactivo":r=e.jsx(je,{className:"text-red-500 mr-1"}),n="text-red-500";break}return e.jsxs("div",{className:`flex items-center ${n}`,children:[r,e.jsx("span",{children:a})]})}},{header:" ",cell:({row:s})=>{const a=s.original;return e.jsx("div",{className:"gap-2",children:e.jsx("button",{onClick:()=>A(a),className:"text-blue-900",children:e.jsx(be,{})})})}}],{Tr:N,Th:W,Td:X,THead:ee,TBody:se,Sorter:ke}=k,ae=s=>{console.log("Drawer cerrado",s),f(!1),c(!1),h(null),L({nombre:"",descripcion:"",cantidad_servicios:0,monto:"",vigencia:"",id:"",uid:""})},w=xe({data:M,columns:U,state:{sorting:q,columnFilters:I},onSortingChange:H,onColumnFiltersChange:x,getCoreRowModel:ge(),getSortedRowModel:he(),getFilteredRowModel:fe()}),[C,S]=o.useState(1),[b,te]=o.useState(10);o.useState(!1);const D=w.getRowModel().rows,re=D.length,oe=s=>{S(s)},ne=s=>{te(s),S(1)},F=(C-1)*b,ie=F+b;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsxs("h1",{className:"mb-6 flex justify-start items-center space-x-4",children:[" ",e.jsx("span",{className:"text-[#000B7E]",children:"Planes"}),e.jsx("button",{className:"p-2  bg-slate-100 hover:bg-slate-200 active:bg-slate-300 transition-all duration-200 shadow-md transform hover:scale-105 rounded-md",onClick:V,children:e.jsx(De,{className:"w-5 h-5 text-gray-700 hover:text-blue-500 transition-colors duration-200"})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative w-32",children:[" ",e.jsxs("select",{className:"h-10 w-full py-2 px-4 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:J,value:y,children:[e.jsx("option",{value:"",disabled:!0,children:"Seleccionar columna..."}),e.jsx("option",{value:"nombre",children:"Nombre"})]})]}),e.jsxs("div",{className:"relative w-80 ml-4",children:[e.jsx("input",{type:"text",placeholder:"Buscar...",className:"w-full py-2 px-4 pl-10 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 h-10",value:g,onChange:Z}),e.jsx(Fe,{className:"absolute left-3 top-5 transform -translate-y-1/2 text-gray-500 w-5 h-5"})]}),e.jsx(p,{className:"w-40 ml-4 text-white hover:opacity-80",style:{backgroundColor:"#000B7E"},onClick:()=>c(!0),children:"Crear Plan"})]})})]}),e.jsxs("div",{className:"p-3 rounded-lg shadow",children:[e.jsxs(k,{className:"w-full rounded-lg",children:[e.jsx(ee,{children:w.getHeaderGroups().map(s=>e.jsx(N,{children:s.headers.map(a=>e.jsx(W,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsx("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:O(a.column.columnDef.header,a.getContext())})},a.id))},s.id))}),e.jsx(se,{children:D.slice(F,ie).map(s=>e.jsx(N,{children:s.getVisibleCells().map(a=>e.jsx(X,{children:O(a.column.columnDef.cell,a.getContext())},a.id))},s.id))})]}),e.jsx(pe,{onChange:oe,currentPage:C,totalRows:re,rowsPerPage:b,onRowsPerPageChange:ne})]}),e.jsxs(P,{isOpen:z,onClose:ae,className:"rounded-md shadow",children:[e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("h2",{className:"flex mb-4 text-xl font-bold",children:"Ver Plan"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ne,{defaultChecked:(t==null?void 0:t.status)==="Activo",onChange:s=>h(a=>({...a??{descripcion:"",nombre:"",cantidad_servicios:0,monto:"",uid:"",vigencia:"",id:"",status:""},status:s?"Activo":"Inactivo"})),color:(t==null?void 0:t.status)==="Activo"?"green-500":"red-500"}),e.jsx("span",{className:"ml-2 text-gray-700",children:t==null?void 0:t.status})," "]})]}),e.jsxs("div",{className:"flex flex-col space-y-6",children:[" ",e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Nombre:"}),e.jsx("input",{type:"text",value:(t==null?void 0:t.nombre)||"",readOnly:!0,className:"mt-1 p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Descripcion:"}),e.jsx("input",{type:"text",value:(t==null?void 0:t.descripcion)||"",readOnly:!0,className:"mt-1 p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Cantidad de Servicios:"}),e.jsx("input",{type:"text",value:(t==null?void 0:t.cantidad_servicios)||"",readOnly:!0,className:"mt-1 p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Monto:"}),e.jsx("input",{type:"text",value:(t==null?void 0:t.monto)||"",readOnly:!0,className:"mt-1 p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Vigencia:"}),e.jsx("input",{type:"text",value:(t==null?void 0:t.vigencia)||"",readOnly:!0,className:"mt-1 p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]})]}),e.jsx("div",{className:"text-center mt-6 ",children:e.jsx(p,{onClick:Q,style:{backgroundColor:"#000B7E"},className:"text-white hover:opacity-80",children:"Guardar Cambios"})})]}),e.jsxs(P,{isOpen:K,onClose:()=>c(!1),className:"rounded-md shadow",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Crear Plan"}),e.jsx(Ce,{initialValues:{nombre:"",descripcion:"",cantidad_servicios:"",monto:"",vigencia:""},validationSchema:G,onSubmit:(s,{setSubmitting:a})=>{Y(s),a(!1)},children:({isSubmitting:s,values:a})=>e.jsxs(Se,{className:"flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"font-semibold text-gray-700",children:"Nombre:"}),e.jsx(d,{type:"text",name:"nombre",className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(m,{name:"nombre",component:"div",className:"text-red-600 text-sm mt-1"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"font-semibold text-gray-700",children:"Descripción:"}),e.jsx(d,{as:"textarea",name:"descripcion",className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 resize-none overflow-hidden",rows:1,style:{maxHeight:"150px",overflowY:"auto"},onInput:r=>{const n=r.target;n.style.height="auto",n.style.height=`${n.scrollHeight}px`}}),e.jsx(m,{name:"descripcion",component:"div",className:"text-red-600 text-sm mt-1"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"font-semibold text-gray-700",children:"Cantidad de Servicios:"}),e.jsx(d,{type:"text",name:"cantidad_servicios",className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(m,{name:"cantidad_servicios",component:"div",className:"text-red-600 text-sm mt-1"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"font-semibold text-gray-700",children:"Monto:"}),e.jsx(d,{type:"text",name:"monto",className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(m,{name:"monto",component:"div",className:"text-red-600 text-sm mt-1"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"font-semibold text-gray-700",children:"Vigencia:"}),e.jsx(d,{type:"text",name:"vigencia",className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(m,{name:"vigencia",component:"div",className:"text-red-600 text-sm mt-1"})]}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(p,{variant:"default",onClick:()=>c(!1),className:"mr-2",children:"Cancelar"}),e.jsx(p,{type:"submit",style:{backgroundColor:"#000B7E"},className:"text-white hover:opacity-80",disabled:s,children:s?"Guardando...":"Guardar"})]})]})})]})]})},Js=Ee;export{Js as default};
