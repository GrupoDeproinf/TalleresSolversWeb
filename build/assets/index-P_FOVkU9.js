import{r as o,j as e,a7 as ne,a8 as F,a9 as j,aa as le,ae as ce,af as E,ag as de}from"./index-50rgKX9S.js";import{P as me}from"./index-zp3PEYV3.js";import{T as R}from"./index-X3G8Yg8B.js";import{u as ue,f as k,g as pe,a as xe,b as ge}from"./index-CcDhNinj.js";import{i as he,l as fe,m as be}from"./index.esm-BzTP7NzC.js";import{z as je}from"./index-Joeg65xT.js";import{B as p}from"./Button-xRLYDkxn.js";import{t as n,N as l}from"./toast-X0ZD5_pK.js";import"./Alert-DFL_TsrK.js";import"./index-_GS3LEUB.js";import"./Badge-R0b3axTj.js";import"./Calendar-3cZ-sm7M.js";import"./Card-vqKpG-UA.js";import"./index-vTv-toOv.js";import"./index-v66BEvdr.js";import"./Dialog-Z-1LJbm8.js";import{D as O}from"./Drawer-o2AIGSQ4.js";import"./index-VPX79BQ8.js";import"./FormItem-tcv8UMxq.js";import"./Input--puSdvxq.js";import"./index-65H9VEwm.js";import"./index-fF9tkD1K.js";import"./index-9MtaU57X.js";import"./Progress-xcEIB3tJ.js";import"./index-P-hQk050.js";import"./RangeCalendar-X9TLkpWI.js";import"./ScrollBar-KngqjvYa.js";import"./index-eWNt1lJC.js";import"./Select-CxnAYESn.js";import"./Skeleton-A_nRjx-l.js";import"./index-sn-72NfC.js";import{S as ve}from"./Switcher-vH3as29K.js";import"./index-vTIpNX8M.js";import"./Tag-BtOgoHK3.js";import"./index-dQpvJhnL.js";import"./index-r8pI1v1_.js";import"./Tooltip-GIYbDsiP.js";import"./Upload-J1c4aH1-.js";import{c as ye,a as v,g as _}from"./index.esm-1NCRVz3q.js";import{F as Ne,a as we,b as d,E as m}from"./formik.esm-Y7Bmnko2.js";import{O as Ce,D as Se}from"./index.esm-CTp4r0U4.js";import"./context-S2-woICp.js";import"./useTimeout-wgPWIlQI.js";import"./CloseButton-NICPh_Cl.js";import"./StatusIcon-HZtVKaUR.js";import"./chainedFunction-ltcSYACe.js";import"./motion-QExVqk61.js";import"./useMergeRef-Rt_Crb27.js";import"./useControllableState-DOzhx4PK.js";import"./cloneDeep-5XeEZjui.js";import"./_getAllKeys-1s2zq0dU.js";import"./_MapCache-2XbJC0-4.js";import"./Views-A7x8nqpb.js";import"./_baseIsEqual-2B9JDPab.js";import"./get-werKe3PL.js";import"./toString-6lQZz3FR.js";import"./floating-ui.react-bRmrURkd.js";import"./floating-ui.dom-0rLBacrf.js";import"./TimeInput-yjgONFtu.js";import"./useUniqueId-ShSZumYL.js";import"./useDidUpdate-12688dYZ.js";import"./index-E7L2uv60.js";import"./index-q4uYtSHq.js";import"./useRootClose-wO-shYqT.js";import"./isNil-tsmo4mGH.js";import"./index-oREErx12.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./mapCloneElement-A5hCM1vC.js";import"./index.esm-opZQsgq7.js";import"./index.esm-oiqqRY0R.js";const De=()=>{const[M,T]=o.useState([]),[P,H]=o.useState([]),[I,x]=o.useState([]);o.useState(!1);const[y,$]=o.useState("nombre"),[g,q]=o.useState(""),[r,h]=o.useState(null),[B,f]=o.useState(!1),u=async()=>{const s=ne(F(j,"Planes")),a=await le(s),t=[];a.forEach(i=>{const ie=i.data();t.push({...ie,uid:i.id})}),T(t)};o.useEffect(()=>{u()},[]);const z=async()=>{await u(),n.push(e.jsx(l,{title:"Datos actualizados",children:"La tabla ha sido actualizada con éxito."}))},[V,c]=o.useState(!1),[Fe,K]=o.useState({nombre:"",descripcion:"",cantidad_servicios:0,monto:"",status:"",vigencia:"",uid:"",id:""}),L=s=>{h(s),f(!0)},A=ye().shape({nombre:v().required("El nombre es obligatorio").min(3,"El nombre debe tener al menos 3 caracteres"),descripcion:v().required("La descripción es obligatoria").min(5,"La descripción debe tener al menos 5 caracteres"),cantidad_servicios:_().typeError("Debe ingresar un número en la cantidad de servicios").required("La cantidad de servicios es obligatoria").integer("Debe ser un número entero").positive("Debe ser un número positivo"),monto:_().typeError("Debe ingresar un número en el monto").required("El monto es obligatorio").positive("Debe ser un monto positivo"),vigencia:v().required("La vigencia es obligatoria").matches(/^\d+$/,"La vigencia debe ser un número válido")}),G=async s=>{try{const a=F(j,"Planes"),t=await ce(a,{nombre:s.nombre,descripcion:s.descripcion,cantidad_servicios:s.cantidad_servicios,monto:s.monto,status:"Activo",vigencia:s.vigencia,uid:""});await E(t,{uid:t.id}),n.push(e.jsx(l,{title:"Éxito",children:"Plan creado con éxito."})),c(!1),u()}catch(a){if(a instanceof je.ZodError){const t=a.errors.map(i=>i.message).join(", ");n.push(e.jsx(l,{title:"Error",children:t}))}else console.error("Error creando plan:",a),n.push(e.jsx(l,{title:"Error",children:"Hubo un error al crear el plan."}))}},Y=s=>{const a=s.target.value;q(a),x([{id:y,value:a}])},Z=s=>{const a=s.target.value;$(a),g!==""&&x([{id:a,value:g}])},J=async()=>{if(r)try{const s=de(j,"Planes",r.uid);await E(s,{nombre:r.nombre,descripcion:r.descripcion,cantidad_servicios:r.cantidad_servicios,monto:r.monto,status:r.status,vigencia:r.vigencia}),n.push(e.jsx(l,{title:"Éxito",children:"Plan actualizado con éxito."})),f(!1),u()}catch(s){console.error("Error actualizando el plan:",s),n.push(e.jsx(l,{title:"Error",children:"Hubo un error al actualizar el plan."}))}},Q=[{header:"Nombre",accessorKey:"nombre",cell:({getValue:s})=>s(),filterFn:"includesString",footer:s=>s.column.id},{header:"Descripcion",accessorKey:"descripcion",filterFn:"includesString"},{header:"Cantidad de Servicios",accessorKey:"cantidad_servicios",filterFn:"includesString"},{header:"Monto",accessorKey:"monto",filterFn:"includesString",cell:({row:s})=>`$${parseFloat(s.original.monto).toFixed(2)}`},{header:"Vigencia",accessorKey:"vigencia",filterFn:"includesString"},{header:"Estado",accessorKey:"status",cell:({row:s})=>{const a=s.getValue("status");let t,i;switch(a){case"Activo":t=e.jsx(be,{className:"text-green-500 mr-1"}),i="text-green-500";break;case"Inactivo":t=e.jsx(fe,{className:"text-red-500 mr-1"}),i="text-red-500";break}return e.jsxs("div",{className:`flex items-center ${i}`,children:[t,e.jsx("span",{children:a})]})}},{header:" ",cell:({row:s})=>{const a=s.original;return e.jsx("div",{className:"gap-2",children:e.jsx("button",{onClick:()=>L(a),className:"text-blue-900",children:e.jsx(he,{})})})}}],{Tr:N,Th:U,Td:W,THead:X,TBody:ee,Sorter:Ee}=R,se=s=>{console.log("Drawer cerrado",s),f(!1),c(!1),h(null),K({nombre:"",descripcion:"",cantidad_servicios:0,monto:"",vigencia:"",id:"",uid:""})},w=ue({data:M,columns:Q,state:{sorting:P,columnFilters:I},onSortingChange:H,onColumnFiltersChange:x,getCoreRowModel:pe(),getSortedRowModel:xe(),getFilteredRowModel:ge()}),[C,ae]=o.useState(1),b=6;o.useState(!1);const S=w.getRowModel().rows,re=S.length,te=s=>{console.log("onPaginationChange",s),ae(s)},D=(C-1)*b,oe=D+b;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsxs("h1",{className:"mb-6 flex justify-start items-center space-x-4",children:[" ",e.jsx("span",{className:"text-[#000B7E]",children:"Planes"}),e.jsx("button",{className:"p-2  bg-slate-100 hover:bg-slate-200 active:bg-slate-300 transition-all duration-200 shadow-md transform hover:scale-105 rounded-md",onClick:z,children:e.jsx(Ce,{className:"w-5 h-5 text-gray-700 hover:text-blue-500 transition-colors duration-200"})})]}),e.jsx("div",{className:"flex justify-end",children:e.jsxs("div",{className:"flex items-center",children:[e.jsxs("div",{className:"relative w-32",children:[" ",e.jsxs("select",{className:"h-10 w-full py-2 px-4 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500",onChange:Z,value:y,children:[e.jsx("option",{value:"",disabled:!0,children:"Seleccionar columna..."}),e.jsx("option",{value:"nombre",children:"Nombre"})]})]}),e.jsxs("div",{className:"relative w-80 ml-4",children:[e.jsx("input",{type:"text",placeholder:"Buscar...",className:"w-full py-2 px-4 pl-10 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 h-10",value:g,onChange:Y}),e.jsx(Se,{className:"absolute left-3 top-5 transform -translate-y-1/2 text-gray-500 w-5 h-5"})]}),e.jsx(p,{className:"w-40 ml-4 text-white hover:opacity-80",style:{backgroundColor:"#000B7E"},onClick:()=>c(!0),children:"Crear Plan"})]})})]}),e.jsxs("div",{className:"p-3 rounded-lg shadow",children:[e.jsxs(R,{className:"w-full rounded-lg",children:[e.jsx(X,{children:w.getHeaderGroups().map(s=>e.jsx(N,{children:s.headers.map(a=>e.jsx(U,{colSpan:a.colSpan,children:a.isPlaceholder?null:e.jsx("div",{className:a.column.getCanSort()?"cursor-pointer select-none":"",onClick:a.column.getToggleSortingHandler(),children:k(a.column.columnDef.header,a.getContext())})},a.id))},s.id))}),e.jsx(ee,{children:S.slice(D,oe).map(s=>e.jsx(N,{children:s.getVisibleCells().map(a=>e.jsx(W,{children:k(a.column.columnDef.cell,a.getContext())},a.id))},s.id))})]}),e.jsx(me,{onChange:te,currentPage:C,totalRows:re,rowsPerPage:b})]}),e.jsxs(O,{isOpen:B,onClose:se,className:"rounded-md shadow",children:[e.jsxs("div",{className:"grid grid-cols-2",children:[e.jsx("h2",{className:"flex mb-4 text-xl font-bold",children:"Ver Plan"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ve,{defaultChecked:(r==null?void 0:r.status)==="Activo",onChange:s=>h(a=>({...a??{descripcion:"",nombre:"",cantidad_servicios:0,monto:"",uid:"",vigencia:"",id:"",status:""},status:s?"Activo":"Inactivo"})),color:(r==null?void 0:r.status)==="Activo"?"green-500":"red-500"}),e.jsx("span",{className:"ml-2 text-gray-700",children:r==null?void 0:r.status})," "]})]}),e.jsxs("div",{className:"flex flex-col space-y-6",children:[" ",e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Nombre:"}),e.jsx("input",{type:"text",value:(r==null?void 0:r.nombre)||"",readOnly:!0,className:"mt-1 p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Descripcion:"}),e.jsx("input",{type:"text",value:(r==null?void 0:r.descripcion)||"",readOnly:!0,className:"mt-1 p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Cantidad de Servicios:"}),e.jsx("input",{type:"text",value:(r==null?void 0:r.cantidad_servicios)||"",readOnly:!0,className:"mt-1 p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Monto:"}),e.jsx("input",{type:"text",value:(r==null?void 0:r.monto)||"",readOnly:!0,className:"mt-1 p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Vigencia:"}),e.jsx("input",{type:"text",value:(r==null?void 0:r.vigencia)||"",readOnly:!0,className:"mt-1 p-3 border border-gray-300 rounded-lg bg-gray-100 cursor-not-allowed"})]})]}),e.jsx("div",{className:"text-center mt-6 ",children:e.jsx(p,{onClick:J,style:{backgroundColor:"#000B7E"},className:"text-white hover:opacity-80",children:"Guardar Cambios"})})]}),e.jsxs(O,{isOpen:V,onClose:()=>c(!1),className:"rounded-md shadow",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Crear Plan"}),e.jsx(Ne,{initialValues:{nombre:"",descripcion:"",cantidad_servicios:"",monto:"",vigencia:""},validationSchema:A,onSubmit:(s,{setSubmitting:a})=>{G(s),a(!1)},children:({isSubmitting:s,values:a})=>e.jsxs(we,{className:"flex flex-col space-y-6",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"font-semibold text-gray-700",children:"Nombre:"}),e.jsx(d,{type:"text",name:"nombre",className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(m,{name:"nombre",component:"div",className:"text-red-600 text-sm mt-1"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"font-semibold text-gray-700",children:"Descripción:"}),e.jsx(d,{as:"textarea",name:"descripcion",className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 resize-none overflow-hidden",rows:1,style:{maxHeight:"150px",overflowY:"auto"},onInput:t=>{const i=t.target;i.style.height="auto",i.style.height=`${i.scrollHeight}px`}}),e.jsx(m,{name:"descripcion",component:"div",className:"text-red-600 text-sm mt-1"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"font-semibold text-gray-700",children:"Cantidad de Servicios:"}),e.jsx(d,{type:"text",name:"cantidad_servicios",className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(m,{name:"cantidad_servicios",component:"div",className:"text-red-600 text-sm mt-1"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"font-semibold text-gray-700",children:"Monto:"}),e.jsx(d,{type:"text",name:"monto",className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(m,{name:"monto",component:"div",className:"text-red-600 text-sm mt-1"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("label",{className:"font-semibold text-gray-700",children:"Vigencia:"}),e.jsx(d,{type:"text",name:"vigencia",className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx(m,{name:"vigencia",component:"div",className:"text-red-600 text-sm mt-1"})]}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(p,{variant:"default",onClick:()=>c(!1),className:"mr-2",children:"Cancelar"}),e.jsx(p,{type:"submit",style:{backgroundColor:"#000B7E"},className:"text-white hover:opacity-80",disabled:s,children:s?"Guardando...":"Guardar"})]})]})})]})]})},Ys=De;export{Ys as default};
