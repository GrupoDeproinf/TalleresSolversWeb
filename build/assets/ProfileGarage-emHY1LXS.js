import{r as d,j as e,a8 as Z,a9 as S,aa as ae,ag as U,ap as co,b3 as la,ak as ye,al as $e,am as Be,an as oe,af as ue,ab as qe,a7 as ze,aj as Ie,a4 as ca,u as da,ai as ma,ar as Io,as as ua}from"./index-MXeuXt6D.js";import{C as ga,a as pa}from"./Views-YIa05gYP.js";import{S as xa}from"./Switcher-jupakP-N.js";import{C as Fo}from"./Card-K535tOj0.js";import{A as To}from"./index-gcSXoXqt.js";import{B as me}from"./Button-vr5nYjWh.js";import{C as fa}from"./ConfirmDialog-z1ysSyZM.js";import{h as Fe,z as ha,B as ba,G as ja,H as Na,I as ya,j as he,m as Ee,i as so,k as ee,l as be,e as va}from"./index.esm-Nne6VUru.js";import{T as wa}from"./Tag-xxTg2NNj.js";import{ap as _a,aq as to,ar as Do}from"./index.esm-QY0V8pz3.js";import{T as Oe}from"./index-hfXV9fO5.js";import"./Alert-TZ-VZidS.js";import"./Badge-yQ6udJ_T.js";import"./Calendar-qBWql_h2.js";import{C as Ca}from"./index-A-vhGk8S.js";import"./index-UByl8NDq.js";import{D as Oo}from"./Dialog-S0YfG3Gb.js";import{D as Ao}from"./Drawer-Ud9te2qe.js";import"./index-IAgYmEvq.js";import"./FormItem-i-Nl3kiy.js";import{I as ke}from"./Input-uNTP3iIk.js";import"./index-ZEG6gjIo.js";import"./index-AC7SbLMO.js";import"./index-6uQDq8Ym.js";import{N as y,t as v}from"./toast-Mj015XK3.js";import{P as Ro}from"./index-chQSm2gV.js";import"./Progress-ZlXx6ARU.js";import"./index-FKkUphMm.js";import"./RangeCalendar-sew3oY7x.js";import"./ScrollBar-EP3syZoV.js";import"./index-YXqNGSRw.js";import{d as Sa}from"./Select-s7e6Ru-i.js";import"./Skeleton-S87nkzI7.js";import"./index-BWCVcINH.js";import{T as Lo}from"./index-_XG3ckIa.js";import"./index-frQVmIcJ.js";import"./index-IPhtjimZ.js";import"./Tooltip-tunHCYEK.js";import"./Upload-IC2tQ0gV.js";import{u as ro,f as je,g as io,a as no,b as lo}from"./index-7diYv2qq.js";import{R as Ea}from"./index.esm-To-iSgYG.js";import{M as ka}from"./index.esm-6I0qnMcK.js";import{S as Ia}from"./index.esm-6diTVsk8.js";import{F as Mo,a as $o,b as M,E as $}from"./formik.esm-xfkBnxQo.js";import{c as Ne,g as Ae,h as Me,a as A}from"./index.esm-lfbDiZYH.js";import{G as Bo,M as qo}from"./esm-hiwqFQ2f.js";import"./useMergeRef-Rt_Crb27.js";import"./context-CyHO4l0y.js";import"./useTimeout-QM-VW6Mi.js";import"./CloseButton-sG-0PXCm.js";import"./StatusIcon-wxjo1xjy.js";import"./motion-WWGuudfi.js";import"./useControllableState-7_HVbbfe.js";import"./cloneDeep-1B8iZWEq.js";import"./_getAllKeys-yH2MZQHD.js";import"./_MapCache-Oklr7ghg.js";import"./_baseIsEqual-x1lYwAPu.js";import"./get-U6lz_elL.js";import"./toString-8HxFeJdf.js";import"./floating-ui.react-diTN8vIO.js";import"./floating-ui.dom-0rLBacrf.js";import"./TimeInput-f4ktkK_2.js";import"./useUniqueId--sVGvA9b.js";import"./useDidUpdate-bKv-yapo.js";import"./index-CUw7Uavs.js";import"./index-hI2o6F97.js";import"./useRootClose-Si2nDrUI.js";import"./isNil-srQng29e.js";import"./index-TkOf27ZX.js";import"./chainedFunction-ltcSYACe.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./mapCloneElement-Rg-HxfTw.js";import"./index.esm-tXvc1PCn.js";import"./index.esm-AtofWilS.js";const Po=[{codigo:"0102",nombre:"BANCO DE VENEZUELA"},{codigo:"0156",nombre:"100% BANCO"},{codigo:"0172",nombre:"BANCAMIGA BANCO MICROFINANCIERO C A"},{codigo:"0114",nombre:"BANCARIBE"},{codigo:"0171",nombre:"BANCO ACTIVO"},{codigo:"0166",nombre:"BANCO AGRICOLA DE VENEZUELA"},{codigo:"0175",nombre:"BANCO BICENTENARIO DEL PUEBLO"},{codigo:"0128",nombre:"BANCO CARONI"},{codigo:"0163",nombre:"BANCO DEL TESORO"},{codigo:"0115",nombre:"BANCO EXTERIOR"},{codigo:"0151",nombre:"BANCO FONDO COMUN"},{codigo:"0173",nombre:"BANCO INTERNACIONAL DE DESARROLLO"},{codigo:"0105",nombre:"BANCO MERCANTIL"},{codigo:"0191",nombre:"BANCO NACIONAL DE CREDITO"},{codigo:"0138",nombre:"BANCO PLAZA"},{codigo:"0137",nombre:"BANCO SOFITASA"},{codigo:"0104",nombre:"BANCO VENEZOLANO DE CREDITO"},{codigo:"0168",nombre:"BANCRECER"},{codigo:"0134",nombre:"BANESCO"},{codigo:"0177",nombre:"BANFANB"},{codigo:"0146",nombre:"BANGENTE"},{codigo:"0174",nombre:"BANPLUS"},{codigo:"0108",nombre:"BBVA PROVINCIAL"},{codigo:"0157",nombre:"DELSUR BANCO UNIVERSAL"},{codigo:"0169",nombre:"MI BANCO"},{codigo:"0178",nombre:"N58 BANCO DIGITAL BANCO MICROFINANCIERO S A"}],Fa=({subscriptionId:r,talleruid:C})=>{const[i,T]=d.useState("Efectivo"),[E,K]=d.useState([]),[ge,k]=d.useState(!1),[H,Y]=d.useState(!1),[ve,G]=d.useState(!1),[D,B]=d.useState(!1);d.useEffect(()=>{(async()=>{const m=Z(S,"MetodosPago"),R=(await ae(m)).docs.map(N=>N.data());K(R.filter(N=>N.status))})()},[]),d.useEffect(()=>{(async()=>{if(C)try{const m=U(S,"Usuarios",C),u=await co(m);if(u.exists()){const N=u.data().subscripcion_actual;N&&N.pago_reportado===!0&&G(!0)}}catch(m){console.error("Error al verificar si ya se reportó el pago:",m)}})()},[C]);const g=n=>{T(n)},se=()=>{ve?B(!0):Y(!0)},te=Ne().shape({monto:Ae().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),fechaPago:Me().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),we=Ne().shape({monto:Ae().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),numReferencia:A().required("El número de referencia es obligatorio"),bancoDestino:A().required("Selecciona un banco de destino"),bancoOrigen:A().required("Selecciona un banco de origen"),fechaPago:Me().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),f=Ne().shape({monto:Ae().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),numReferencia:A().required("El número de referencia es obligatorio"),telefono:A().required("El teléfono es obligatorio").matches(/^[1-9]\d*$/,"El teléfono no puede comenzar con 0 y debe contener solo números"),bancoDestino:A().required("Selecciona un banco de destino"),bancoOrigen:A().required("Selecciona un banco de origen"),fechaPago:Me().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),x=Ne().shape({monto:Ae().required("El monto es obligatorio").positive("El monto debe ser positivo").min(1,"El monto debe ser mayor a cero"),correo:A().email("El correo no es válido").required("El correo Zelle es obligatorio"),fechaPago:Me().max(new Date,"La fecha no puede ser futura").required("La fecha es obligatoria")}),j=Ne().shape({...i==="Efectivo"&&te.fields,...i==="Transferencia"&&we.fields,...i==="Pago Móvil"&&f.fields,...i==="Zelle"&&x.fields}),w={metodoPago:"",monto:"",numReferencia:"",telefono:"",correo:"",cedula:"",bancoOrigen:"",bancoDestino:"",fechaPago:"",newLogoFile:null},s=async(n,m)=>{try{const u=Z(S,"Subscripciones"),R=await ae(u),N=new Date(n.fechaPago),q=`${N.getFullYear()}-${String(N.getMonth()+1).padStart(2,"0")}-${String(N.getDate()).padStart(2,"0")}`;for(const re of R.docs){const ie=re.data(),L=ie.comprobante_pago;if(L&&L.fechaPago){const ne=L.fechaPago.toDate();if(`${ne.getFullYear()}-${String(ne.getMonth()+1).padStart(2,"0")}-${String(ne.getDate()).padStart(2,"0")}`===q&&L.monto===parseFloat(n.monto)&&ie.taller_uid===C){if((m==="Pago Móvil"||m==="Transferencia")&&L.numReferencia===n.numReferencia)return{isDuplicate:!0,message:`Ya existe un pago con el número de referencia ${n.numReferencia} en la fecha ${q} para este taller`};if(m==="Zelle"&&L.correo===n.correo)return{isDuplicate:!0,message:`Ya existe un pago con el correo ${n.correo} en la fecha ${q} para este taller`};if(m==="Efectivo")return{isDuplicate:!0,message:`Ya existe un pago en efectivo por el monto $${n.monto} en la fecha ${q} para este taller`}}}}return{isDuplicate:!1,message:""}}catch(u){return console.error("Error al validar duplicidad:",u),{isDuplicate:!1,message:""}}},h=async n=>{if(!r){console.error("Error: subscriptionId no está definido");return}k(!0);try{const m=await s(n,i);if(m.isDuplicate){v.push(e.jsx(y,{title:"Error",type:"danger",children:m.message})),k(!1);return}let u="";if(n.newLogoFile&&i&&C){const re=la(),ie=new Date().toISOString(),L=`${i}_${C}_${ie}.jpg`,ne=n.newLogoFile,V=ye(re,`paymentcommitment/${L}`),Ue=await $e(V,ne);u=await Be(Ue.ref)}const R=n.fechaPago?oe.fromDate(new Date(n.fechaPago)):null,N={metodo:i,monto:n.monto,fechaPago:R,comprobante:u};i==="Transferencia"&&(N.numReferencia=n.numReferencia??"",N.cedula=n.cedula??"",N.bancoOrigen=n.bancoOrigen??"",N.bancoDestino=n.bancoDestino??""),i==="Pago Móvil"&&(N.cedula=n.cedula,N.telefono=n.telefono,N.bancoOrigen=n.bancoOrigen,N.bancoDestino=n.bancoDestino),i==="Zelle"&&(N.correo=n.correo??"",N.numReferencia=n.numReferencia),console.log(N);const q=U(S,"Subscripciones",r);if(await ue(q,{comprobante_pago:N}),C){const re=U(S,"Usuarios",C);await ue(re,{"subscripcion_actual.pago_reportado":!0}),G(!0)}console.log("Pago registrado exitosamente"),v.push(e.jsx(y,{title:"Éxito",type:"success",children:"Se ha registrado el pago correctamente."}))}catch(m){console.error("Error al registrar el pago:",m),v.push(e.jsx(y,{title:"Error",children:"Ocurrió un problema al registrar el pago."}))}finally{k(!1),Y(!1)}},c=E.find(n=>n.tipo_pago===i);return e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:se,className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Reportar Pago"}),e.jsx(Oo,{isOpen:D,onClose:()=>B(!1),children:e.jsxs("div",{className:"p-6",children:[e.jsx("h4",{className:"text-lg font-semibold mb-4",children:"Pago Ya Reportado"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Ya se ha reportado un pago para esta suscripción. No se puede reportar otro pago."}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{onClick:()=>B(!1),className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Entendido"})})]})}),e.jsx(Ao,{isOpen:H,onClose:()=>Y(!1),title:"Registrar Pago",children:e.jsx(Mo,{initialValues:w,onSubmit:h,validationSchema:j,validateOnBlur:!0,validateOnChange:!1,children:({setFieldValue:n,values:m})=>e.jsxs($o,{className:"flex flex-col gap-4",children:[e.jsx("h4",{className:"font-semibold text-lg",children:"Selecciona el Método de Pago"}),e.jsx("div",{className:"grid grid-cols-2 gap-4 mb-4",children:E==null?void 0:E.map(u=>e.jsx("button",{type:"button",onClick:()=>g(u.tipo_pago),className:`text-sm py-2 px-4 rounded-md ${i===u.tipo_pago?"bg-[#1d1e56] text-white":"bg-gray-200"}`,children:u.tipo_pago},u.tipo_pago))}),i!=="Efectivo"&&c&&e.jsxs("div",{className:"bg-gray-100 p-4 rounded-lg mb-4",children:[e.jsx("h5",{className:"font-semibold text-lg",children:"Detalles de la Empresa"}),c.email&&e.jsxs("p",{children:[e.jsx("strong",{children:"Email:"})," ",c.email]}),c.num_ref&&e.jsxs("p",{children:[e.jsx("strong",{children:"Número de Referencia:"})," ",c.num_ref]}),c.banco&&e.jsxs("p",{children:[e.jsx("strong",{children:"Banco:"})," ",c.banco]}),c.cedula_rif&&e.jsxs("p",{children:[e.jsx("strong",{children:"Cédula/RIF:"})," ",c.cedula_rif]}),c.cuenta&&e.jsxs("p",{children:[e.jsx("strong",{children:"Cuenta:"})," ",c.cuenta]}),c.status_pago!==void 0&&e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",c.status_pago?"Activo":"Inactivo"]}),c.tipo_cuenta&&e.jsxs("p",{children:[e.jsx("strong",{children:"Tipo de Cuenta:"})," ",c.tipo_cuenta]}),c.telefono&&e.jsxs("p",{children:[e.jsx("strong",{children:"Teléfono:"})," ",c.telefono]}),c.titular&&e.jsxs("p",{children:[e.jsx("strong",{children:"Titular:"})," ",c.titular]})]}),e.jsx(M,{id:"monto",name:"monto",as:ke,placeholder:"Ingresa el monto en $"}),e.jsx($,{name:"monto",component:"div",className:"text-red-500"}),e.jsx(M,{id:"fechaPago",name:"fechaPago",as:ke,type:"date",placeholder:"Fecha de pago"}),e.jsx($,{name:"fechaPago",component:"div",className:"text-red-500"}),i==="Pago Móvil"&&e.jsxs(e.Fragment,{children:[e.jsx(M,{id:"telefono",name:"telefono",as:ke,placeholder:"Teléfono",onKeyDown:u=>{u.currentTarget.value===""&&u.key==="0"&&u.preventDefault()},onChange:u=>{const R=u.target.value.replace(/^0+/,"");n("telefono",R)}}),e.jsx($,{name:"telefono",component:"div",className:"text-red-500"})]}),i==="Zelle"&&e.jsx(M,{id:"correo",name:"correo",as:ke,placeholder:"Correo Zelle"}),["Transferencia","Pago Móvil"].includes(i)&&e.jsxs(e.Fragment,{children:[e.jsx(M,{id:"numReferencia",name:"numReferencia",as:ke,placeholder:"Número de referencia"}),e.jsx($,{name:"numReferencia",component:"div",className:"text-red-500"})]}),["Transferencia","Pago Móvil"].includes(i)&&e.jsxs(e.Fragment,{children:[e.jsxs(M,{id:"bancoDestino",as:"select",name:"bancoDestino",className:"p-2 rounded-md border border-slate-300",children:[e.jsx("option",{value:"",children:"Selecciona Banco de Destino"}),Po.map(u=>e.jsx("option",{value:u.nombre,children:u.nombre},u.codigo))]}),e.jsx($,{name:"bancoDestino",component:"div",className:"text-red-500"}),e.jsxs(M,{id:"bancoOrigen",as:"select",name:"bancoOrigen",className:"p-2 rounded-md border border-slate-300",children:[e.jsx("option",{value:"",children:"Selecciona Banco de Origen"}),Po.map(u=>e.jsx("option",{value:u.nombre,children:u.nombre},u.codigo))]}),e.jsx($,{name:"bancoOrigen",component:"div",className:"text-red-500"})]}),["Transferencia","Pago Móvil","Zelle"].includes(i)&&e.jsx(e.Fragment,{children:e.jsx("div",{className:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10 gap-2",children:e.jsxs("div",{className:"text-center",children:[m.newLogoFile?e.jsx("img",{src:URL.createObjectURL(m.newLogoFile),alt:"Logo",className:"w-32 h-32 object-cover rounded-md"}):e.jsx(Fe,{className:"text-gray-500 text-center text-3xl"}),e.jsxs("div",{className:"mt-2",children:[e.jsx("label",{htmlFor:"fileInput",className:"text-sm font-medium text-blue-600 cursor-pointer",children:"Subir Comprobante de Pago"}),e.jsx("input",{id:"fileInput",name:"newLogoFile",type:"file",className:"hidden",accept:"image/*",onChange:u=>{u.target.files&&u.target.files[0]&&n("newLogoFile",u.target.files[0])}})]})]})})}),e.jsx("button",{type:"submit",className:"w-full py-2 mt-4 bg-blue-900 rounded-md hover:bg-blue-700 text-white",children:"Registrar Pago"})]})})})]})},Ta=({markers:r,center:C})=>{const[i,T]=d.useState([]);return d.useEffect(()=>{T(r)},[r]),e.jsx("div",{style:{height:"50%",width:"100%"},children:e.jsx(Bo,{center:C,zoom:10,mapContainerStyle:{height:"400px",width:"100%",marginTop:"10px"},children:i.map((E,K)=>e.jsx(qo,{position:{lat:E.lat,lng:E.lng}},K))})})},Da=({initialLocation:r,onLocationChange:C})=>{const[i,T]=d.useState(null),[E]=d.useState(17);d.useEffect(()=>{r&&r.lat&&r.lng&&T(r)},[r]);const K=k=>{if(!k.latLng)return;const H={lat:k.latLng.lat(),lng:k.latLng.lng()};T(H),C(H)},ge=k=>{if(k.latLng){const H={lat:k.latLng.lat(),lng:k.latLng.lng()};T(H),C(H)}};return e.jsx("div",{style:{height:"450px",width:"100%"},children:e.jsx(Bo,{center:i||{lat:0,lng:0},zoom:E,mapContainerStyle:{height:"400px",width:"100%",marginTop:"10px"},onClick:K,children:i&&e.jsx(qo,{position:i,draggable:!0,onDragEnd:ge})})})},Ra=Ne().shape({nombre_servicio:A().required("El nombre del servicio es requerido"),descripcion:A().required("La descripción es requerida"),uid_categoria:A().required("La categoría es requerida"),precio:A().required("El precio es requerido"),garantia:A().required("La garantía es requerida"),typeService:A().required("El tipo de servicio es requerido")}),La=({isOpen:r,onClose:C,service:i,onServiceUpdated:T})=>{const[E,K]=d.useState([]),[ge,k]=d.useState([]),[H,Y]=d.useState([]),[ve,G]=d.useState(!1),[D,B]=d.useState(null),[g,se]=d.useState(!1);d.useEffect(()=>{(async()=>{var j;if(!(!r||!i)){G(!0);try{const w=ze(Z(S,"Categorias"),qe("estatus","==",!0)),h=(await ae(w)).docs.map(m=>({id:m.id,...m.data()}));K(h);const c=await co(U(S,"talleres","talleres"));c.exists()&&Y(c.data().talleres||[]);const n={nombre_servicio:(i==null?void 0:i.nombre_servicio)||"",descripcion:(i==null?void 0:i.descripcion)||"",uid_categoria:(i==null?void 0:i.uid_categoria)||"",nombre_categoria:(i==null?void 0:i.nombre_categoria)||"",service_image:(i==null?void 0:i.service_image)||(i==null?void 0:i.imagenes)||[],service_image_files:[],uid_taller:(i==null?void 0:i.uid_taller)||"",taller:(i==null?void 0:i.taller)||"",precio:((j=i==null?void 0:i.precio)==null?void 0:j.toString())||"",garantia:(i==null?void 0:i.garantia)||"",typeService:(i==null?void 0:i.typeService)||"local",subcategoria:(i==null?void 0:i.subcategoria)||[]};B(n),i!=null&&i.uid_categoria&&await te(i.uid_categoria)}catch(w){console.error("Error loading data:",w),v.push(e.jsx(y,{title:"Error",children:"Error al cargar los datos"}))}finally{G(!1)}}})()},[r,i]),d.useEffect(()=>{D!=null&&D.uid_categoria&&E.length>0&&te(D.uid_categoria)},[D==null?void 0:D.uid_categoria,E.length]);const te=async x=>{if(!x){k([]);return}try{const j=ze(Z(S,"Categorias",x,"Subcategorias"),qe("estatus","==",!0)),s=(await ae(j)).docs.map(h=>({id:h.id,...h.data()}));k(s)}catch(j){console.error("Error loading subcategories:",j),k([])}},we=async(x,j)=>{const w=[];for(let s=0;s<x.length;s++){const h=x[s],c=Date.now(),n=`${j}_${c}_${s}.jpg`,m=ye(Ie,`service_images/${n}`);try{await $e(m,h);const u=await Be(m);w.push(u)}catch(u){throw console.error("Error uploading image:",u),new Error(`Error al subir la imagen ${s+1}`)}}return w},f=async x=>{try{if(!(i!=null&&i.uid_servicio)){v.push(e.jsx(y,{title:"Error",children:"No se pudo identificar el servicio a editar"}));return}se(!0);let j=[...x.service_image||[]];if(x.service_image_files&&x.service_image_files.length>0)try{const s=await we(x.service_image_files,i.uid_servicio);j=[...j.filter(c=>!c.startsWith("blob:")),...s]}catch(s){console.error("Error uploading images:",s),v.push(e.jsx(y,{title:"Error",children:"Error al subir las imágenes"})),se(!1);return}else j=j.filter(s=>!s.startsWith("blob:"));const w=U(S,"Servicios",i.uid_servicio);await ue(w,{nombre_servicio:x.nombre_servicio,descripcion:x.descripcion,uid_categoria:x.uid_categoria,nombre_categoria:x.nombre_categoria,precio:x.precio,garantia:x.garantia,typeService:x.typeService,subcategoria:x.subcategoria,service_image:j,uid_taller:i.uid_taller,taller:i.taller,updatedAt:new Date}),v.push(e.jsx(y,{title:"Éxito",children:"Servicio actualizado correctamente"})),T==null||T(),C()}catch(j){console.error("Error updating service:",j),v.push(e.jsx(y,{title:"Error",children:"No se pudo actualizar el servicio"}))}finally{se(!1)}};return!i||!D?null:e.jsxs(Ao,{isOpen:r,onClose:C,className:"rounded-md shadow w-full max-w-2xl",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Editar Servicio"}),ve&&e.jsx("div",{className:"flex justify-center items-center py-4",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}),e.jsx(Mo,{initialValues:D,validationSchema:Ra,onSubmit:f,enableReinitialize:!0,children:({values:x,handleChange:j,setFieldValue:w,errors:s,touched:h})=>e.jsxs($o,{className:"flex flex-col space-y-6",children:[e.jsx("div",{className:"mt-2 flex flex-col items-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10",children:e.jsxs("div",{className:"text-center",children:[Array.isArray(x.service_image)&&x.service_image.length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-4",children:x.service_image.map((c,n)=>e.jsxs("div",{className:"relative",children:[e.jsx("img",{src:c,alt:`Imagen del servicio ${n+1}`,className:"h-32 w-full object-cover rounded-md"}),e.jsx("button",{type:"button",onClick:()=>{const m=x.service_image.filter((u,R)=>R!==n);w("service_image",m)},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full w-6 h-6 flex items-center justify-center text-xs hover:bg-red-600",children:"×"})]},n))}):e.jsx(Fe,{className:"mx-auto h-12 w-12 text-gray-300","aria-hidden":"true"}),e.jsx("div",{className:"mt-4 flex flex-col text-sm leading-6 text-gray-600 justify-center",children:e.jsxs("label",{htmlFor:"images-upload",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500 flex justify-center items-center",children:[e.jsx("span",{children:"Agregar otra imagen"}),e.jsx("input",{id:"images-upload",name:"images-upload",type:"file",accept:"image/*",multiple:!0,className:"sr-only",onChange:c=>{const n=Array.from(c.target.files||[]),m=n.map(u=>URL.createObjectURL(u));w("service_image",[...x.service_image||[],...m]),w("service_image_files",[...x.service_image_files||[],...n])}})]})})]})}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Nombre Servicio:"}),e.jsx(M,{type:"text",name:"nombre_servicio",value:x.nombre_servicio,onChange:j,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx($,{name:"nombre_servicio",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("div",{className:"flex flex-col space-y-4",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Tipo de Servicio:"}),e.jsxs("div",{className:"flex items-center space-x-10",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(M,{type:"radio",name:"typeService",value:"local",className:"form-radio"}),e.jsx("span",{children:"En el Local"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx(M,{type:"radio",name:"typeService",value:"domicilio",className:"form-radio"}),e.jsx("span",{children:"A Domicilio"})]})]}),e.jsx($,{name:"typeService",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Categoría:"}),e.jsxs(M,{as:"select",name:"uid_categoria",value:x.uid_categoria,onChange:c=>{const n=c.target.value,m=E.find(u=>u.id===n);w("uid_categoria",n),w("nombre_categoria",(m==null?void 0:m.nombre)||""),w("subcategoria",[]),te(n)},className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"",children:"Seleccione una categoría"}),E.map(c=>e.jsx("option",{value:c.id,children:c.nombre},c.id))]}),e.jsx($,{name:"uid_categoria",component:"div",className:"text-red-600 text-sm"})]}),e.jsx("label",{className:"font-semibold text-gray-700",children:"Subcategorías:"}),e.jsx(Sa,{isMulti:!0,placeholder:"Selecciona subcategorías",noOptionsMessage:()=>"No hay Subcategorías disponibles",options:x.uid_categoria?ge.map(c=>({value:c.id,label:c.nombre})):[],value:Array.isArray(x.subcategoria)?x.subcategoria.map(c=>({value:c.uid_subcategoria||c.id,label:c.nombre_subcategoria||c.nombre})):[],onChange:c=>w("subcategoria",c.map(n=>({uid_subcategoria:n.value,nombre_subcategoria:n.label}))),className:"mt-1"}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Descripción:"}),e.jsx(M,{as:"textarea",name:"descripcion",value:x.descripcion,onChange:j,rows:1,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 resize-none overflow-hidden",style:{maxHeight:"150px",overflowY:"auto"},onInput:c=>{c.target.style.height="auto",c.target.style.height=`${c.target.scrollHeight}px`}}),e.jsx($,{name:"descripcion",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Precio:"}),e.jsx(M,{type:"text",name:"precio",value:x.precio,onChange:j,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx($,{name:"precio",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Garantía:"}),e.jsx(M,{type:"text",name:"garantia",value:x.garantia,onChange:j,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200"}),e.jsx($,{name:"garantia",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(me,{variant:"default",onClick:C,className:"mr-2",disabled:g,children:"Cancelar"}),e.jsx(me,{type:"submit",style:{backgroundColor:"#000B7E"},className:"text-white hover:opacity-80",disabled:g,children:g?e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Guardando..."]}):"Guardar"})]})]})})]})},it=()=>{var yo,vo,wo,_o,Co;const[r,C]=d.useState(null),[i,T]=d.useState(!1);d.useState(null);const[E,K]=d.useState([]),[ge,k]=d.useState([]),[H,Y]=d.useState(!0);d.useState(!1);const[ve,G]=d.useState(!1),[D,B]=d.useState(!1),[g,se]=d.useState(null),[te,we]=d.useState(null),[f,x]=d.useState({fecha_fin:oe,fecha_inicio:oe,nombre:"",cantidad_servicios:0,monto:0,status:"",vigencia:"",uid:"",fechaCreacion:oe.fromDate(new Date)}),[j,w]=d.useState([]),[s,h]=d.useState({image_perfil:"",nombre:"",email:"",phone:"",rif:"",status:"",Direccion:"",ubicacion:{lat:0,lng:0},LinkFacebook:"",LinkTiktok:"",LinkInstagram:"",estado:"",whatsapp:"",newLogoFile:null,rifIdFiscal:"",permisoOperacion:"",logotipoNegocio:"",fotoFrenteTaller:"",fotoInternaTaller:"",rifIdFiscal_file:null,permisoOperacion_file:null,logotipoNegocio_file:null,fotoFrenteTaller_file:null,fotoInternaTaller_file:null});d.useState(null);const[c,n]=d.useState({pagoMovil:!1,transferencia:!1,puntoVenta:!1,zinli:!1,efectivo:!1,zelle:!1,tarjetaCreditoN:!1,tarjetaCreditoI:!1}),m=location.pathname.substring(location.pathname.lastIndexOf("/")+1),u=ca(),R=da(o=>o.auth.user.authority),N=R==null?void 0:R.includes("Admin"),q=async()=>{Y(!0);try{const o=U(S,"Usuarios",m),a=(await co(o)).data()||null;se(a);const p=(a==null?void 0:a.metodos_pago)||{};n(_=>({..._,...p}));const b=(a==null?void 0:a.subscripcion_actual)||null;T(!!b);const z=ze(Z(S,"Subscripciones"),qe("taller_uid","==",m)),ce=(await ae(z)).docs.map(_=>{const l=_.data();return{uid:_.id,nombre:l.nombre||"",monto:l.monto||"0",vigencia:l.vigencia||"",status:l.status||"",cantidad_servicios:l.cantidad_servicios||0,fecha_fin:l.fecha_fin||"no hay fecha",fecha_inicio:l.fecha_inicio||"no hay fecha",taller_uid:l.taller_uid||"",fechaCreacion:oe.fromDate(new Date)}}),Xe=ze(Z(S,"Servicios"),qe("uid_taller","==",m)),eo=(await ae(Xe)).docs.map(_=>{const l=_.data();return{uid_servicio:_.id,nombre_servicio:(l==null?void 0:l.nombre_servicio)||"",descripcion:(l==null?void 0:l.descripcion)||"",precio:(l==null?void 0:l.precio)||"0",estatus:l==null?void 0:l.estatus,taller:(l==null?void 0:l.taller)||"",puntuacion:(l==null?void 0:l.puntuacion)||"0",uid_taller:(l==null?void 0:l.uid_taller)||"",uid_categoria:(l==null?void 0:l.uid_categoria)||"",nombre_categoria:(l==null?void 0:l.nombre_categoria)||"",subcategoria:(l==null?void 0:l.subcategoria)||[],garantia:(l==null?void 0:l.garantia)||"",typeService:(l==null?void 0:l.typeService)||"local",service_image:(l==null?void 0:l.service_image)||(l==null?void 0:l.imagenes)||[]}}),oo=(await ae(Z(S,"Planes"))).docs.map(_=>({uid:_.id,nombre:_.data().nombre||"",descripcion:_.data().descripcion||"",monto:_.data().monto||0,status:_.data().status||"",vigencia:_.data().vigencia||"",cantidad_servicios:_.data().cantidad_servicios||0}));C(a),K(eo),k(oo),x(b),w(ce);const Pe=b==null?void 0:b.fecha_fin;if(Pe){const _=re(Pe);console.log("aqui la vigencia w",_),we(_)}h({nombre:(a==null?void 0:a.nombre)??"",image_perfil:(a==null?void 0:a.image_perfil)??"",email:(a==null?void 0:a.email)??"",phone:(a==null?void 0:a.phone)??"",rif:(a==null?void 0:a.rif)??"",status:(a==null?void 0:a.status)??"",Direccion:(a==null?void 0:a.Direccion)??"",LinkFacebook:(a==null?void 0:a.LinkFacebook)??"",LinkInstagram:(a==null?void 0:a.LinkInstagram)??"",LinkTiktok:(a==null?void 0:a.LinkTiktok)??"",whatsapp:(a==null?void 0:a.whatsapp)??"",estado:(a==null?void 0:a.estado)??"",ubicacion:a!=null&&a.ubicacion?{lat:a.ubicacion.lat,lng:a.ubicacion.lng}:{lat:0,lng:0},newLogoFile:(a==null?void 0:a.newLogoFile)??null,rifIdFiscal:(a==null?void 0:a.rifIdFiscal)??"",permisoOperacion:(a==null?void 0:a.permisoOperacion)??"",logotipoNegocio:(a==null?void 0:a.logotipoNegocio)??"",fotoFrenteTaller:(a==null?void 0:a.fotoFrenteTaller)??"",fotoInternaTaller:(a==null?void 0:a.fotoInternaTaller)??"",rifIdFiscal_file:null,permisoOperacion_file:null,logotipoNegocio_file:null,fotoFrenteTaller_file:null,fotoInternaTaller_file:null})}catch(o){console.error("Error al obtener los datos del cliente:",o),v.push(e.jsx(y,{title:"Error",children:"Ocurrio un error al cargar los datos del cliente."}))}finally{Y(!1)}};d.useEffect(()=>{q()},[]);const re=o=>{const t=Math.floor(Date.now()/1e3),p=o.seconds-t;return Math.ceil(p/(60*60*24))},ie=o=>{const t=new Date(o.seconds*1e3),a=String(t.getDate()).padStart(2,"0"),p=String(t.getMonth()+1).padStart(2,"0"),b=t.getFullYear();return`${a}/${p}/${b}`},L=o=>{if(!o)return"Documento existente";try{const t=decodeURIComponent(o),a=t.match(/\/documents\/[^\/]+\/([^?]+)/)||t.match(/documents%2F[^%]+%2F([^?%]+)/);if(a&&a[1]){const P=a[1];if(P.includes("."))return P}const p=t.split("/"),z=p[p.length-1].split("?")[0];return z&&z.includes(".")?z:"Documento existente"}catch(t){return console.error("Error extrayendo nombre del archivo:",t),"Documento existente"}},ne=async o=>{try{const t=U(S,"Usuarios",m),a=U(Z(S,"Subscripciones"));await ma(a,{uid:a.id,nombre:o.nombre,monto:o.monto,vigencia:o.vigencia,cantidad_servicios:o.cantidad_servicios,status:"Por Aprobar",taller_uid:m,fechaCreacion:oe.fromDate(new Date)});const p=new Date,b=new Date(p);b.setMonth(b.getMonth()+1),await ue(t,{subscripcion_actual:{uid:a.id,nombre:o.nombre,monto:o.monto,vigencia:o.vigencia,cantidad_servicios:o.cantidad_servicios,status:"Por Aprobar",fecha_inicio:oe.fromDate(p),fecha_fin:oe.fromDate(b)}}),T(!0),await q(),mo(),console.log("Subscripción actualizada y guardada en Subscripciones."),v.push(e.jsx(y,{title:"Éxito",type:"success",children:"Se ha subscrito correctamente a este plan."}))}catch(t){console.error("Error al guardar la subscripción:",t),v.push(e.jsx(y,{title:"Error",children:"Ocurrió un error al subscribirse a este plan. Inténtalo nuevamente."}))}},V=({title:o,value:t})=>e.jsxs("div",{children:[e.jsx("span",{children:o}),e.jsx("p",{className:"text-gray-700 dark:text-gray-200 font-semibold",children:t})]}),Ue=(o,t)=>{De(a=>{const p=a.filter(b=>b.id!==o);return t!==""&&p.push({id:o,value:t}),p})},le=o=>{const{name:t,value:a}=o.target;h(p=>({...p,[t]:a}))},[pe,zo]=d.useState({facebook:"",instagram:"",tiktok:"",whatsapp:""}),Uo=(o,t)=>({facebook:/^(https?:\/\/)?(www\.)?facebook\.com\/.+$/,instagram:/^(https?:\/\/)?(www\.)?instagram\.com\/.+$/,tiktok:/^(https?:\/\/)?(www\.)?tiktok\.com\/.+$/})[t].test(o)?"":`La URL ingresada no es válida para ${t}.`,Ke=(o,t)=>{const{value:a}=o.target;h(b=>({...b,[`Link${t.charAt(0).toUpperCase()+t.slice(1)}`]:a}));const p=Uo(a,t);zo(b=>({...b,[t]:p}))},Ko=async()=>{var o;if(!s.nombre||s.nombre.trim()===""){v.push(e.jsx(y,{title:"Error",children:"El nombre no puede estar vacío."}));return}if(!s.phone||!/^[1-9]\d*$/.test(s.phone)){v.push(e.jsx(y,{title:"Error",children:"El teléfono debe contener solo números y no puede comenzar con 0."}));return}if(s.whatsapp&&!/^[1-9]\d*$/.test(s.whatsapp)){v.push(e.jsx(y,{title:"Error",children:"El WhatsApp debe contener solo números y no puede comenzar con 0."}));return}if(!s.rif||!/^[JVEGCP]-\d+$/.test(s.rif)){v.push(e.jsx(y,{title:"Error",children:"El RIF debe estar en un formato válido (Ejemplo: J-12345678)."}));return}if(!s.Direccion||s.Direccion.trim()===""){v.push(e.jsx(y,{title:"Error",children:"La Direccion no puede estar vacía."}));return}if(!s.status){v.push(e.jsx(y,{title:"Error",children:"Debes seleccionar un estatus."}));return}if(!s.estado){v.push(e.jsx(y,{title:"Error",children:"Debes seleccionar un estado."}));return}try{const t=Z(S,"Usuarios"),a=await ae(t);if(a.docs.some(I=>I.data().rif===s.rif&&I.id!==m)){v.push(e.jsx(y,{title:"Error",children:"El RIF ya está registrado. Por favor, verifica e intenta con otro."}));return}if(a.docs.some(I=>I.data().phone===s.phone&&I.id!==m)){v.push(e.jsx(y,{title:"Error",children:"El teléfono ya está registrado. Por favor, verifica e intenta con otro."}));return}let z=s.image_perfil;if(s.newLogoFile){const F=(o=decodeURIComponent(s.image_perfil).split("/").pop())==null?void 0:o.split("?")[0],O=`${m}_`,Ce=F==null?void 0:F.match(/_(\d+)\.jpg$/),fe=Ce?parseInt(Ce[1],10):0,X=`${O}${fe+1}.jpg`,ao=ye(Ie,`profileImages/${F}`);try{await Io(ao)}catch(ko){console.error("Error al eliminar la imagen anterior:",ko)}const Se=ye(Ie,`profileImages/${X}`);await $e(Se,s.newLogoFile),z=await Be(Se)}const P=async(I,F)=>{try{const O=I.split("/"),fe=O[O.length-1].split("?")[0],X=ye(Ie,`documents/${m}/${fe}`);await Io(X),console.log(`Documento ${F} eliminado del storage`)}catch(O){console.error(`Error eliminando documento ${F} del storage:`,O)}},ce=async(I,F,O,Ce=!1)=>{var fe;if(Ce&&O)return await P(O,F),null;if(!I)return O||null;try{O&&await P(O,F);const X=(fe=I.name.split(".").pop())==null?void 0:fe.toLowerCase();if(!X)return console.warn(`No se pudo obtener la extensión del archivo: ${F}`),O||null;const ao=`${F}.${X}`,Se=ye(Ie,`documents/${m}/${ao}`);return await $e(Se,I),await Be(Se)}catch(X){return console.error(`Error subiendo ${F}:`,X),O||null}},Xe=!s.rifIdFiscal_file&&!s.rifIdFiscal&&!!(g!=null&&g.rifIdFiscal),So=!s.permisoOperacion_file&&!s.permisoOperacion&&!!(g!=null&&g.permisoOperacion),eo=!s.logotipoNegocio_file&&!s.logotipoNegocio&&!!(g!=null&&g.logotipoNegocio),Eo=!s.fotoFrenteTaller_file&&!s.fotoFrenteTaller&&!!(g!=null&&g.fotoFrenteTaller),oo=!s.fotoInternaTaller_file&&!s.fotoInternaTaller&&!!(g!=null&&g.fotoInternaTaller),Pe=[ce(s.rifIdFiscal_file||null,"rifIdFiscal",s.rifIdFiscal||(g==null?void 0:g.rifIdFiscal)||void 0,Xe),ce(s.permisoOperacion_file||null,"permisoOperacion",s.permisoOperacion||(g==null?void 0:g.permisoOperacion)||void 0,So),ce(s.logotipoNegocio_file||null,"logotipoNegocio",s.logotipoNegocio||(g==null?void 0:g.logotipoNegocio)||void 0,eo),ce(s.fotoFrenteTaller_file||null,"fotoFrenteTaller",s.fotoFrenteTaller||(g==null?void 0:g.fotoFrenteTaller)||void 0,Eo),ce(s.fotoInternaTaller_file||null,"fotoInternaTaller",s.fotoInternaTaller||(g==null?void 0:g.fotoInternaTaller)||void 0,oo)],_=await Promise.all(Pe),l={};["rifIdFiscal","permisoOperacion","logotipoNegocio","fotoFrenteTaller","fotoInternaTaller"].forEach((I,F)=>{_[F]!==void 0&&(l[I]=_[F])});const na=U(S,"Usuarios",m),de={...s,image_perfil:z,...l};if(delete de.newLogoFile,delete de.rifIdFiscal_file,delete de.permisoOperacion_file,delete de.logotipoNegocio_file,delete de.fotoFrenteTaller_file,delete de.fotoInternaTaller_file,await ue(na,de),C({...s,image_perfil:z}),B(!1),q(),console.log("Datos actualizados correctamente",s),console.log("Datos originales",g),(s==null?void 0:s.status)!==(g==null?void 0:g.status)){console.log("Cambio de estado kelfsklflksflks");try{await ua.post("https://apisolvers.solversapp.com/api/usuarios/sendNotification",{token:g==null?void 0:g.token,title:"Cambio de estatus",body:"Hola, su usuario ha cambiado de estado "+(s==null?void 0:s.status)+". Cierre sesión y vuelva a ingresar por favor.",secretCode:"Cambio de estado"})}catch(I){console.error("Error al enviar notificación:",I)}}v.push(e.jsx(y,{title:"Éxito",type:"success",children:"Datos de Usuario actualizados correctamente."}))}catch(t){console.error("Error al actualizar los datos:",t),v.push(e.jsx(y,{title:"Error",children:"Ocurrió un error al actualizar los datos del usuario. Inténtalo nuevamente."}))}},Go=async()=>{try{const o=U(S,"Usuarios",m);await ue(o,{metodos_pago:c}),v.push(e.jsx(y,{title:"Éxito",type:"success",children:"Métodos de pago actualizados correctamente."}))}catch(o){console.error("Error al guardar los métodos de pago:",o),v.push(e.jsx(y,{title:"Error",children:"Ocurrió un error al actualizar los métodos de pago. Inténtalo nuevamente."}))}},Ho=[{name:"Pago móvil",icon:e.jsx(ka,{}),dbKey:"pagoMovil"},{name:"Transferencias bancarias",icon:e.jsx(Ea,{}),dbKey:"transferencia"},{name:"Punto de venta",icon:e.jsx(to,{}),dbKey:"puntoVenta"},{name:"Zinli",icon:e.jsx(Do,{}),dbKey:"zinli"},{name:"Efectivo",icon:e.jsx(Do,{}),dbKey:"efectivo"},{name:"Zelle",icon:e.jsx(Ia,{}),dbKey:"zelle"},{name:"Tarjetas de crédito nacional",icon:e.jsx(to,{}),dbKey:"tarjetaCreditoN"},{name:"Tarjetas de crédito internacional",icon:e.jsx(to,{}),dbKey:"tarjetaCreditoI"}],mo=()=>G(!1),Vo=()=>B(!0),[Te,De]=d.useState([]),[Ge,He]=d.useState([]),{TabNav:Ve,TabList:Zo,TabContent:Ze}=Lo,Yo=[{header:"Nombre del Servicio",accessorKey:"nombre_servicio"},{header:"Precio",accessorKey:"precio",cell:({row:o})=>`$${parseFloat(o.original.precio).toFixed(2)}`},{header:"Estatus",accessorKey:"estatus",cell:({row:o})=>{const[t,a]=d.useState(o.original.estatus??!1),p=async b=>{a(b);const z=E.map(P=>P.uid_servicio===o.original.uid_servicio?{...P,estatus:b}:P);K(z);try{const P=U(S,"Servicios",o.original.uid_servicio);await ue(P,{estatus:b}),console.log("Estado del servicio actualizado")}catch(P){console.error("Error al actualizar el estado del servicio:",P)}};return e.jsx("div",{children:e.jsx(xa,{checked:t,onChange:()=>p(!t)})})}},{header:"Acciones",id:"actions",cell:({row:o})=>e.jsx("div",{className:"",children:e.jsx(me,{size:"sm",variant:"solid",onClick:()=>ta(o.original),className:"text-blue-900 hover:bg-blue-700",children:e.jsx(va,{})})})}],Wo=[{header:"Nombre del Plan",accessorKey:"nombre"},{header:"Monto",accessorKey:"monto"},{header:"Descripcion",accessorKey:"descripcion"},{header:"Cantidad de servicios",accessorKey:"cantidad_servicios"}],Qo=[{header:"Nombre del Plan",accessorKey:"nombre"},{header:"Monto",accessorKey:"monto"},{header:"vigencia",accessorKey:"vigencia"},{header:"Fecha de vencimiento",accessorKey:"fecha_fin",cell:({row:o})=>`${ie(o.original.fecha_fin)}`}],{Tr:xe,Th:Re,Td:Le,THead:Ye,TBody:We,Sorter:Pa}=Oe,Qe=ro({data:E,columns:Yo,state:{sorting:Ge,columnFilters:Te},onSortingChange:He,onColumnFiltersChange:De,getCoreRowModel:io(),getSortedRowModel:no(),getFilteredRowModel:lo()}),uo=ro({data:ge,columns:Wo,state:{sorting:Ge,columnFilters:Te},onSortingChange:He,onColumnFiltersChange:De,getCoreRowModel:io(),getSortedRowModel:no(),getFilteredRowModel:lo()}),go=ro({data:j,columns:Qo,state:{sorting:Ge,columnFilters:Te},onSortingChange:He,onColumnFiltersChange:De,getCoreRowModel:io(),getSortedRowModel:no(),getFilteredRowModel:lo()}),[W,Jo]=d.useState(1),Q=6,po=Qe.getRowModel().rows.length,xo=o=>{console.log("onPaginationChange",o),Jo(o)},[Xo,ea]=d.useState(!1),[oa,fo]=d.useState(!1),[aa,ho]=d.useState(null),[sa,bo]=d.useState(!1),[J,jo]=d.useState(null),Je=()=>{ea(o=>!o)},_e=(o,t,a)=>{jo({url:o,name:t,type:a}),bo(!0)},No=()=>{bo(!1),jo(null)},ta=o=>{ho(o),fo(!0)},ra=()=>{fo(!1),ho(null)},ia=()=>{q()};return e.jsxs(ga,{className:"min-h-screen overflow-y-auto pb-8",children:[N&&e.jsx("div",{className:"flex items-center",children:e.jsxs("button",{onClick:()=>u(`${pa}/garages`),className:"flex items-center text-blue-900 mb-3 ml-2 px-4 py-2 bg-blue-100 rounded-lg hover:bg-blue-200 transition duration-200",children:[e.jsx(ha,{className:"mr-2"}),e.jsx("span",{children:"Volver"})]})}),e.jsxs("div",{className:"flex flex-col xl:flex-row gap-4 pb-8",children:[e.jsxs(Fo,{children:[e.jsx("div",{className:"mt-4 flex justify-end",children:e.jsx("button",{className:"bg-[#1d1e56] rounded-md p-2 hover:bg-[#1E3a8a] text-white",onClick:Vo,children:"Editar"})}),e.jsxs("div",{className:"flex flex-col xl:justify-between min-w-[260px] h-full 2xl:min-w-[360px] mx-auto",children:[e.jsxs("div",{className:"flex xl:flex-col items-center gap-4",children:[e.jsx(To,{size:90,shape:"circle",src:(r==null?void 0:r.image_perfil)||"/img/logo/logo-light-streamline.png",className:"p-2 bg-white shadow-lg"}),e.jsx("h4",{className:"font-bold",children:(r==null?void 0:r.nombre)||"Nombre no disponible"})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 xl:grid-cols-1 gap-y-7 gap-x-4 mt-8",children:[e.jsx(V,{title:"Correo electronico",value:(r==null?void 0:r.email)||"Correo no disponible"}),e.jsx(V,{title:"Numero de telefono",value:(r==null?void 0:r.phone)||"Telefono no disponible"}),e.jsx(V,{title:"Rif",value:(r==null?void 0:r.rif)||"Rif no disponible"}),e.jsx(V,{title:"Estado",value:(r==null?void 0:r.estado)||"Estado no disponible"}),e.jsx(V,{title:"Estatus",value:(r==null?void 0:r.status)||"Estatus no disponible"}),e.jsx(V,{title:"Direccion",value:(r==null?void 0:r.Direccion)||"Direccion no disponible"}),r!=null&&r.ubicacion?e.jsx(Ta,{center:{lat:r.ubicacion.lat,lng:r.ubicacion.lng},markers:[{lat:r.ubicacion.lat,lng:r.ubicacion.lng}]}):"Ubicación no disponible",e.jsxs("div",{className:"mb-7",children:[e.jsx("span",{children:"Redes Sociales"}),e.jsx("div",{className:"flex mt-4 gap-2",children:r!=null&&r.LinkFacebook||r!=null&&r.LinkInstagram||r!=null&&r.whatsapp||r!=null&&r.LinkTiktok?e.jsxs(e.Fragment,{children:[r.LinkFacebook&&e.jsx("a",{href:r.LinkFacebook,target:"_blank",rel:"noopener noreferrer",title:r.LinkFacebook,children:e.jsx(me,{shape:"circle",size:"sm",icon:e.jsx(ba,{className:"text-[#1773ea]"})})}),r.LinkInstagram&&e.jsx("a",{href:r.LinkInstagram,target:"_blank",rel:"noopener noreferrer",title:r.LinkInstagram,children:e.jsx(me,{shape:"circle",size:"sm",icon:e.jsx(ja,{className:"text-[#E1306C]"})})}),r.LinkTiktok&&e.jsx("a",{href:r.LinkTiktok,target:"_blank",rel:"noopener noreferrer",title:r.LinkTiktok,children:e.jsx(me,{shape:"circle",size:"sm",icon:e.jsx(Na,{className:"text-black"})})}),r.whatsapp&&e.jsx("a",{href:`https://wa.me/${r.whatsapp}?text=${encodeURIComponent("Hola, quiero más información sobre el servicio")}`,target:"_blank",rel:"noopener noreferrer",title:r.whatsapp,children:e.jsx(me,{shape:"circle",size:"sm",icon:e.jsx(ya,{className:"text-[#25d366]"})})})]}):e.jsx("p",{className:"text-gray-500",children:"No hay redes sociales disponibles"})})]})]})]})]}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs(Lo,{defaultValue:"tab1",children:[e.jsxs(Zo,{children:[e.jsx(Ve,{value:"tab1",children:"Planes"}),e.jsx(Ve,{value:"tab2",children:"Servicios"}),e.jsx(Ve,{value:"tab3",children:"Documentos"})]}),e.jsx("div",{className:"w-full",children:e.jsx(Ze,{value:"tab1",children:e.jsxs("div",{className:"mb-8 mt-4",children:[e.jsx("h6",{className:"mb-4",children:"Subscripción"}),e.jsx(Fo,{bordered:!0,className:"mb-4",children:i?e.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between gap-4 p-4 border rounded-lg shadow-md bg-white",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(To,{className:"bg-transparent",shape:"circle",icon:e.jsx(_a,{className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:(f==null?void 0:f.nombre)||"Cargando..."}),e.jsx(wa,{className:`rounded-md border-0 mx-2 ${(f==null?void 0:f.status)==="Aprobado"?"bg-green-100 text-green-400":(f==null?void 0:f.status)==="Vencido"?"bg-red-100 text-red-400":"bg-yellow-100 text-yellow-400"}`,children:(f==null?void 0:f.status)||"Pendiente"})]}),e.jsxs("div",{className:"grid grid-cols-4",children:[e.jsxs("p",{className:"text-xs text-gray-500",children:["Vigencia:"," ",(f==null?void 0:f.vigencia)??"---"," ","días"]}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Monto mensual:"," ",e.jsxs("span",{className:"font-bold text-gray-800",children:["$",(f==null?void 0:f.monto)??"---"]})]}),(f==null?void 0:f.status)==="Aprobado"&&e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-xs ml-2 text-gray-600",children:[te??"---"," ","días restantes"]}),e.jsxs("p",{className:"text-xs ml-2 text-gray-600",children:["Fecha de vencimiento:"," ",e.jsx("span",{className:"text-xs text-gray-600",children:f.fecha_fin?ie(f.fecha_fin):"Fecha no disponible"})]})]})]})]})]}),(f==null?void 0:f.status)==="Vencido"&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{onClick:()=>G(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition duration-200",children:"Elegir Plan"})}),(f==null?void 0:f.status)==="Aprobado"&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx("button",{onClick:()=>G(!0),className:"bg-blue-900 rounded-md p-2 text-white hover:bg-blue-700",children:"Renovar Pago"})}),(f==null?void 0:f.status)==="Por Aprobar"&&e.jsx("div",{className:"flex justify-end mt-2",children:e.jsx(Fa,{talleruid:m,subscriptionId:(yo=j[0])==null?void 0:yo.uid})})]}):e.jsxs("div",{className:"flex justify-end",children:[e.jsx("p",{className:"text-xs mr-64 mt-3",children:"Puede visualizar y suscribirse a un plan para su taller..."}),e.jsx("button",{onClick:()=>G(!0),className:"bg-blue-500 text-white px-4 py-2 rounded-md hover:bg-blue-600 transition duration-200",children:"Ver Planes"})]})}),e.jsx("div",{children:e.jsxs("div",{className:"p-4 rounded-lg shadow",children:[e.jsx("h6",{className:"mb-6 flex justify-start mt-4",children:"Historial de Subscripciones"}),e.jsxs(Oe,{className:"w-full rounded-lg",children:[e.jsx(Ye,{children:go.getHeaderGroups().map(o=>e.jsx(xe,{children:o.headers.map(t=>e.jsx(Re,{colSpan:t.colSpan,children:t.isPlaceholder?null:e.jsx("div",{className:t.column.getCanSort()?"cursor-pointer select-none":"",onClick:t.column.getToggleSortingHandler(),children:je(t.column.columnDef.header,t.getContext())})},t.id))},o.id))}),e.jsx(We,{children:go.getRowModel().rows.slice((W-1)*Q,W*Q).map(o=>e.jsx(xe,{children:o.getVisibleCells().map(t=>e.jsx(Le,{children:je(t.column.columnDef.cell,t.getContext())},t.id))},o.id))})]}),e.jsx(Ro,{onChange:xo,currentPage:W,totalRows:po,rowsPerPage:Q})]})}),e.jsx("div",{className:"border-t border-gray-300 my-4"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4 p-4",children:Ho.map(o=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ca,{checked:c[o.dbKey]||!1,onChange:t=>{n(a=>({...a,[o.dbKey]:t}))}}),e.jsx("span",{children:o.icon}),e.jsx("span",{children:o.name})]},o.name))}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{onClick:Go,className:"px-4 py-2 bg-[#1d1e56] text-white rounded-md hover:bg-blue-900 focus:outline-none",children:"Guardar"})})]})})}),e.jsx(Ze,{value:"tab2",children:e.jsx("div",{className:"w-full h-full",children:e.jsxs("div",{className:"p-4 rounded-lg",children:[e.jsx("h6",{className:"mb-6 flex justify-start mt-4",children:"Lista de Servicios"}),e.jsxs(Oe,{className:"w-full rounded-lg",children:[e.jsx(Ye,{children:Qe.getHeaderGroups().map(o=>e.jsx(xe,{children:o.headers.map(t=>e.jsx(Re,{colSpan:t.colSpan,children:t.isPlaceholder?null:e.jsx("div",{className:t.column.getCanSort()?"cursor-pointer select-none":"",onClick:t.column.getToggleSortingHandler(),children:je(t.column.columnDef.header,t.getContext())})},t.id))},o.id))}),e.jsx(We,{children:Qe.getRowModel().rows.slice((W-1)*Q,W*Q).map(o=>e.jsx(xe,{children:o.getVisibleCells().map(t=>e.jsx(Le,{children:je(t.column.columnDef.cell,t.getContext())},t.id))},o.id))})]}),e.jsx(Ro,{onChange:xo,currentPage:W,totalRows:po,rowsPerPage:Q})]})})}),e.jsx(Ze,{value:"tab3",children:e.jsxs("div",{className:"w-full h-full p-4",children:[e.jsx("h6",{className:"mb-6 flex justify-start mt-4",children:"Documentos del Taller"}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[(r==null?void 0:r.rifIdFiscal)&&e.jsxs("div",{className:"cursor-pointer group relative overflow-hidden rounded-lg border-2 border-gray-200 hover:border-blue-500 transition-all duration-200 shadow-md hover:shadow-lg",onClick:()=>_e(r.rifIdFiscal,"RIF ID Fiscal",r.rifIdFiscal.includes(".pdf")?"pdf":"image"),children:[e.jsx("div",{className:"aspect-video bg-gray-100 flex items-center justify-center",children:r.rifIdFiscal.includes(".pdf")?e.jsxs("div",{className:"text-center",children:[e.jsx(he,{className:"w-16 h-16 text-red-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"RIF ID Fiscal"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF"})]}):e.jsx("img",{src:r.rifIdFiscal,alt:"RIF ID Fiscal",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",onError:o=>{o.target.style.display="none"}})}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 flex items-center justify-center",children:e.jsx(Ee,{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200 w-8 h-8"})})]}),(r==null?void 0:r.permisoOperacion)&&e.jsxs("div",{className:"cursor-pointer group relative overflow-hidden rounded-lg border-2 border-gray-200 hover:border-blue-500 transition-all duration-200 shadow-md hover:shadow-lg",onClick:()=>_e(r.permisoOperacion,"Permiso de Operación",r.permisoOperacion.includes(".pdf")?"pdf":"image"),children:[e.jsx("div",{className:"aspect-video bg-gray-100 flex items-center justify-center",children:r.permisoOperacion.includes(".pdf")?e.jsxs("div",{className:"text-center",children:[e.jsx(he,{className:"w-16 h-16 text-red-500 mx-auto mb-2"}),e.jsx("p",{className:"text-sm font-semibold text-gray-700",children:"Permiso de Operación"}),e.jsx("p",{className:"text-xs text-gray-500",children:"PDF"})]}):e.jsx("img",{src:r.permisoOperacion,alt:"Permiso de Operación",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",onError:o=>{o.target.style.display="none"}})}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 flex items-center justify-center",children:e.jsx(Ee,{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200 w-8 h-8"})})]}),(r==null?void 0:r.logotipoNegocio)&&e.jsxs("div",{className:"cursor-pointer group relative overflow-hidden rounded-lg border-2 border-gray-200 hover:border-blue-500 transition-all duration-200 shadow-md hover:shadow-lg",onClick:()=>_e(r.logotipoNegocio,"Logotipo Negocio","image"),children:[e.jsx("div",{className:"aspect-video bg-gray-100 flex items-center justify-center",children:e.jsx("img",{src:r.logotipoNegocio,alt:"Logotipo Negocio",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",onError:o=>{o.target.style.display="none"}})}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 flex items-center justify-center",children:e.jsx(Ee,{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200 w-8 h-8"})})]}),(r==null?void 0:r.fotoFrenteTaller)&&e.jsxs("div",{className:"cursor-pointer group relative overflow-hidden rounded-lg border-2 border-gray-200 hover:border-blue-500 transition-all duration-200 shadow-md hover:shadow-lg",onClick:()=>_e(r.fotoFrenteTaller,"Foto Frente Taller","image"),children:[e.jsx("div",{className:"aspect-video bg-gray-100 flex items-center justify-center",children:e.jsx("img",{src:r.fotoFrenteTaller,alt:"Foto Frente Taller",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",onError:o=>{o.target.style.display="none"}})}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 flex items-center justify-center",children:e.jsx(Ee,{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200 w-8 h-8"})})]}),(r==null?void 0:r.fotoInternaTaller)&&e.jsxs("div",{className:"cursor-pointer group relative overflow-hidden rounded-lg border-2 border-gray-200 hover:border-blue-500 transition-all duration-200 shadow-md hover:shadow-lg",onClick:()=>_e(r.fotoInternaTaller,"Foto Interna Taller","image"),children:[e.jsx("div",{className:"aspect-video bg-gray-100 flex items-center justify-center",children:e.jsx("img",{src:r.fotoInternaTaller,alt:"Foto Interna Taller",className:"w-full h-full object-cover group-hover:scale-105 transition-transform duration-200",onError:o=>{o.target.style.display="none"}})}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-10 transition-all duration-200 flex items-center justify-center",children:e.jsx(Ee,{className:"text-white opacity-0 group-hover:opacity-100 transition-opacity duration-200 w-8 h-8"})})]})]}),!(r!=null&&r.rifIdFiscal)&&!(r!=null&&r.permisoOperacion)&&!(r!=null&&r.logotipoNegocio)&&!(r!=null&&r.fotoFrenteTaller)&&!(r!=null&&r.fotoInternaTaller)&&e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(so,{className:"w-16 h-16 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-semibold",children:"No hay documentos disponibles"}),e.jsx("p",{className:"text-sm",children:"Los documentos aparecerán aquí una vez que se suban"})]})]})})]})})]}),e.jsx(Oo,{width:1e3,isOpen:ve,onClose:mo,children:e.jsxs("div",{className:"table-responsive",children:[e.jsx("h2",{className:"mb-4",children:"Planes de Subscripción"}),e.jsx("div",{className:"p-2 rounded-lg shadow",children:e.jsxs(Oe,{className:"w-full rounded-lg",children:[e.jsx(Ye,{children:uo.getHeaderGroups().map(o=>e.jsxs(xe,{children:[o.headers.map(t=>{var a,p;return e.jsx(Re,{colSpan:t.colSpan,children:t.isPlaceholder?null:e.jsxs("div",{className:t.column.getCanSort()?"cursor-pointer select-none":"",onClick:t.column.getToggleSortingHandler(),children:[je(t.column.columnDef.header,t.getContext()),t.column.getCanFilter()?e.jsx("input",{type:"text",value:((p=(a=Te.find(b=>b.id===t.id))==null?void 0:a.value)==null?void 0:p.toString())||"",onChange:b=>Ue(t.id,b.target.value),placeholder:"Buscar",className:"mt-2 p-1 border rounded",onClick:b=>b.stopPropagation()}):null]})},t.id)}),e.jsx(Re,{children:"Acción"})," "]},o.id))}),e.jsx(We,{children:uo.getRowModel().rows.slice((W-1)*Q,W*Q).map(o=>e.jsxs(xe,{children:[o.getVisibleCells().map(t=>e.jsx(Le,{children:je(t.column.columnDef.cell,t.getContext())},t.id)),e.jsx(Le,{children:e.jsx("button",{className:"bg-[#1d1e56] text-white px-4 py-2 rounded",onClick:()=>ne(o.original),children:"Suscribirse"})})]},o.id))})]})})]})}),D&&e.jsx(fa,{isOpen:D,title:"Editar Taller",confirmButtonColor:"blue-600",onClose:()=>B(!1),onRequestClose:()=>B(!1),onCancel:()=>B(!1),onConfirm:Ko,children:e.jsxs("div",{className:"max-h-[450px] overflow-y-auto",children:[e.jsx("div",{className:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10 gap-2",children:e.jsxs("div",{className:"text-center",children:[!s.image_perfil&&!s.newLogoFile?e.jsx(Fe,{className:"mx-auto h-12 w-12 text-gray-300","aria-hidden":"true"}):e.jsxs("div",{children:[e.jsx("img",{src:s.newLogoFile?URL.createObjectURL(s.newLogoFile):s.image_perfil,alt:"Preview Logo",className:"mx-auto h-32 w-32 object-cover"}),e.jsx("button",{onClick:()=>h(o=>({...o,newLogoFile:null,image_perfil:""})),className:"mt-2 text-red-500 hover:text-red-700",children:"Quitar Logo"})]}),e.jsx("div",{className:"mt-4 flex text-sm leading-6 text-gray-600 justify-center",children:e.jsxs("label",{htmlFor:"logo-upload",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500 flex justify-center items-center",children:[e.jsx("span",{children:s.newLogoFile?"Cambiar Logo":"Seleccionar Logo"}),e.jsx("input",{id:"logo-upload",name:"logo-upload",type:"file",accept:"image/*",className:"sr-only",onChange:o=>{var a;const t=(a=o.target.files)==null?void 0:a[0];h(p=>({...p,newLogoFile:t||null}))}})]})})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Nombre"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Nombre",name:"nombre",value:s.nombre,onChange:le})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Correo Electrónico"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Correo Electrónico",disabled:!0,name:"email",value:s.email,onChange:le})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Teléfono"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"Teléfono",name:"phone",value:s.phone,onChange:le,onKeyDown:o=>{o.currentTarget.value===""&&o.key==="0"&&o.preventDefault()},onInput:o=>{const t=o.target,a=t.value.replace(/^0+/,"");a!==t.value&&h(p=>({...p,phone:a}))}})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"WhatsApp"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"WhatsApp",name:"whatsapp",value:s.whatsapp,onChange:le,onKeyDown:o=>{o.currentTarget.value===""&&o.key==="0"&&o.preventDefault()},onInput:o=>{const t=o.target,a=t.value.replace(/^0+/,"");a!==t.value&&h(p=>({...p,whatsapp:a}))}})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"RIF:"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsxs("select",{value:((vo=s.rif)==null?void 0:vo.split("-")[0])||"J",onChange:o=>h(t=>{var a;return{...t,rif:`${o.target.value}-${((a=t==null?void 0:t.rif)==null?void 0:a.split("-")[1])||""}`}}),className:"mx-2 p-3 border border-gray-300 rounded-l-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"J",children:"J-"}),e.jsx("option",{value:"V",children:"V-"}),e.jsx("option",{value:"E",children:"E-"}),e.jsx("option",{value:"C",children:"C-"}),e.jsx("option",{value:"G",children:"G-"}),e.jsx("option",{value:"P",children:"P-"})]}),e.jsx("input",{disabled:!0,type:"text",value:((wo=s.rif)==null?void 0:wo.split("-")[1])||"",onChange:o=>h(t=>{var a;return{...t,rif:`${((a=t==null?void 0:t.rif)==null?void 0:a.split("-")[0])||"J"}-${o.target.value}`}}),className:"p-3 border border-gray-300 rounded-r-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 mx-2 w-full"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Estado:"}),e.jsxs("select",{name:"estado",value:s.estado,onChange:le,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"",children:"Seleccione un Estado"}),["Amazonas","Anzoátegui","Apure","Aragua","Barinas","Bolívar","Carabobo","Cojedes","Delta Amacuro","Distrito Capital","Falcón","Guárico","Lara","La Guaira","Mérida","Miranda","Monagas","Nueva Esparta","Portuguesa","Sucre","Táchira","Trujillo","Yaracuy","Zulia"].map(o=>e.jsx("option",{value:o,children:o},o))]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Direccion"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"",name:"Direccion",value:s.Direccion,onChange:le})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Mapa"}),e.jsx("button",{type:"button",className:"w-full mt-1 p-3 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring focus:ring-blue-300",onClick:Je,children:"Abrir Mapa"})]}),Xo&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 w-full max-w-3xl",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-800",children:"Editar ubicación"}),e.jsx("button",{className:"text-gray-600 hover:text-gray-800 focus:outline-none",onClick:Je,children:"✖"})]}),e.jsx(Da,{initialLocation:{lat:s.ubicacion.lat,lng:s.ubicacion.lng},onLocationChange:o=>h(t=>({...t,ubicacion:o}))}),e.jsx("div",{className:"flex justify-end mt-4",children:e.jsx("button",{type:"button",className:"px-4 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 focus:outline-none focus:ring focus:ring-blue-300",onClick:Je,children:"Guardar"})})]})}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Estatus"}),e.jsxs("select",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",name:"status",value:s.status,onChange:le,children:[e.jsx("option",{value:"Aprobado",children:"Aprobado"}),e.jsx("option",{value:"Pendiente",children:"Pendiente"}),e.jsx("option",{value:"Rechazado",children:"Rechazado"}),e.jsx("option",{value:"En espera por aprobación",children:"En espera por aprobación"})]})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Facebook"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de Facebook",name:"LinkFacebook",value:s.LinkFacebook,onChange:o=>Ke(o,"facebook")}),pe.facebook&&e.jsx("span",{className:"text-red-500 text-sm",children:pe.facebook})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"Instagram"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de Instagram",name:"LinkInstagram",value:s.LinkInstagram,onChange:o=>Ke(o,"instagram")}),pe.instagram&&e.jsx("span",{className:"text-red-500 text-sm",children:pe.instagram})]}),e.jsxs("label",{className:"block",children:[e.jsx("span",{className:"text-gray-700 font-semibold",children:"TikTok"}),e.jsx("input",{className:"w-full mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring focus:ring-blue-200",placeholder:"URL de TikTok",name:"LinkTiktok",value:s.LinkTiktok,onChange:o=>Ke(o,"tiktok")}),pe.tiktok&&e.jsx("span",{className:"text-red-500 text-sm",children:pe.tiktok})]})]}),e.jsxs("div",{className:"border-t pt-4 mt-4 col-span-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Documentos (Opcional)"}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold text-gray-700 mb-2",children:"RIF ID Fiscal:"}),!s.rifIdFiscal_file&&!s.rifIdFiscal?e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,.pdf",id:"rifIdFiscal-upload",className:"sr-only",onChange:o=>{var a;const t=(a=o.target.files)==null?void 0:a[0];t&&h(p=>({...p,rifIdFiscal_file:t}))}}),e.jsx("label",{htmlFor:"rifIdFiscal-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pt-2",children:[e.jsx(so,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-blue-600 hover:text-blue-700",children:"Click para subir"})," o arrastra aquí"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Imágenes o PDF"})]})})]}):e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.rifIdFiscal_file?s.rifIdFiscal_file.type.includes("pdf")?e.jsx(he,{className:"w-6 h-6 text-red-500"}):e.jsx(ee,{className:"w-6 h-6 text-blue-500"}):(_o=s.rifIdFiscal)!=null&&_o.includes(".pdf")?e.jsx(he,{className:"w-6 h-6 text-red-500"}):e.jsx(ee,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.rifIdFiscal_file?s.rifIdFiscal_file.name:L(s.rifIdFiscal)}),s.rifIdFiscal_file&&e.jsxs("p",{className:"text-xs text-gray-500",children:[(s.rifIdFiscal_file.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>h(o=>({...o,rifIdFiscal_file:null,rifIdFiscal:""})),className:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(be,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold text-gray-700 mb-2",children:"Permisos de Operación:"}),!s.permisoOperacion_file&&!s.permisoOperacion?e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,.pdf",id:"permisoOperacion-upload",className:"sr-only",onChange:o=>{var a;const t=(a=o.target.files)==null?void 0:a[0];t&&h(p=>({...p,permisoOperacion_file:t}))}}),e.jsx("label",{htmlFor:"permisoOperacion-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pt-2",children:[e.jsx(so,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-blue-600 hover:text-blue-700",children:"Click para subir"})," o arrastra aquí"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Imágenes o PDF"})]})})]}):e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[s.permisoOperacion_file?s.permisoOperacion_file.type.includes("pdf")?e.jsx(he,{className:"w-6 h-6 text-red-500"}):e.jsx(ee,{className:"w-6 h-6 text-blue-500"}):(Co=s.permisoOperacion)!=null&&Co.includes(".pdf")?e.jsx(he,{className:"w-6 h-6 text-red-500"}):e.jsx(ee,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.permisoOperacion_file?s.permisoOperacion_file.name:L(s.permisoOperacion)}),s.permisoOperacion_file&&e.jsxs("p",{className:"text-xs text-gray-500",children:[(s.permisoOperacion_file.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>h(o=>({...o,permisoOperacion_file:null,permisoOperacion:""})),className:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(be,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold text-gray-700 mb-2",children:"Logotipo Negocio:"}),!s.logotipoNegocio_file&&!s.logotipoNegocio?e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",id:"logotipoNegocio-upload",className:"sr-only",onChange:o=>{var a;const t=(a=o.target.files)==null?void 0:a[0];t&&h(p=>({...p,logotipoNegocio_file:t}))}}),e.jsx("label",{htmlFor:"logotipoNegocio-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pt-2",children:[e.jsx(ee,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-blue-600 hover:text-blue-700",children:"Click para subir"})," o arrastra aquí"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Solo imágenes"})]})})]}):e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(ee,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.logotipoNegocio_file?s.logotipoNegocio_file.name:L(s.logotipoNegocio)}),s.logotipoNegocio_file&&e.jsxs("p",{className:"text-xs text-gray-500",children:[(s.logotipoNegocio_file.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>h(o=>({...o,logotipoNegocio_file:null,logotipoNegocio:""})),className:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(be,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold text-gray-700 mb-2",children:"Foto Frente Taller:"}),!s.fotoFrenteTaller_file&&!s.fotoFrenteTaller?e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",id:"fotoFrenteTaller-upload",className:"sr-only",onChange:o=>{var a;const t=(a=o.target.files)==null?void 0:a[0];t&&h(p=>({...p,fotoFrenteTaller_file:t}))}}),e.jsx("label",{htmlFor:"fotoFrenteTaller-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pt-2",children:[e.jsx(Fe,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-blue-600 hover:text-blue-700",children:"Click para subir"})," o arrastra aquí"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Solo imágenes"})]})})]}):e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(ee,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.fotoFrenteTaller_file?s.fotoFrenteTaller_file.name:L(s.fotoFrenteTaller)}),s.fotoFrenteTaller_file&&e.jsxs("p",{className:"text-xs text-gray-500",children:[(s.fotoFrenteTaller_file.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>h(o=>({...o,fotoFrenteTaller_file:null,fotoFrenteTaller:""})),className:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(be,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold text-gray-700 mb-2",children:"Foto Interna Taller:"}),!s.fotoInternaTaller_file&&!s.fotoInternaTaller?e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",id:"fotoInternaTaller-upload",className:"sr-only",onChange:o=>{var a;const t=(a=o.target.files)==null?void 0:a[0];t&&h(p=>({...p,fotoInternaTaller_file:t}))}}),e.jsx("label",{htmlFor:"fotoInternaTaller-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pt-2",children:[e.jsx(Fe,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-blue-600 hover:text-blue-700",children:"Click para subir"})," o arrastra aquí"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Solo imágenes"})]})})]}):e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(ee,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:s.fotoInternaTaller_file?s.fotoInternaTaller_file.name:L(s.fotoInternaTaller)}),s.fotoInternaTaller_file&&e.jsxs("p",{className:"text-xs text-gray-500",children:[(s.fotoInternaTaller_file.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>h(o=>({...o,fotoInternaTaller_file:null,fotoInternaTaller:""})),className:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(be,{className:"w-5 h-5"})})]})]})]})]})}),e.jsx(La,{isOpen:oa,onClose:ra,service:aa,onServiceUpdated:ia}),sa&&J&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50",onClick:No,children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl max-w-6xl w-full mx-4 max-h-[90vh] overflow-hidden flex flex-col",onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:J.name}),e.jsx("button",{onClick:No,className:"text-gray-500 hover:text-gray-700 focus:outline-none transition-colors",children:e.jsx(be,{className:"w-6 h-6"})})]}),e.jsx("div",{className:"flex-1 overflow-auto p-4 bg-gray-100 flex items-center justify-center",children:J.type==="pdf"?e.jsx("iframe",{src:J.url,className:"w-full h-full min-h-[600px] border-0",title:J.name}):e.jsx("img",{src:J.url,alt:J.name,className:"max-w-full max-h-[70vh] object-contain rounded-lg shadow-lg",onError:o=>{const t=o.target;t.style.display="none";const a=document.createElement("div");a.className="text-center text-gray-500 p-8",a.innerHTML=`
                                            <FaFilePdf class="w-16 h-16 mx-auto mb-4 text-gray-400" />
                                            <p class="text-lg font-semibold">Error al cargar la imagen</p>
                                            <p class="text-sm">No se pudo mostrar el documento</p>
                                        `;const p=t.parentElement;p&&p.appendChild(a)}})}),e.jsx("div",{className:"p-4 border-t bg-gray-50 flex justify-end",children:e.jsx("a",{href:J.url,target:"_blank",rel:"noopener noreferrer",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors",children:"Abrir en nueva pestaña"})})]})})]})};export{it as default};
