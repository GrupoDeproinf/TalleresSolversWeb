import{a0 as q,a1 as H,b4 as L,a2 as Y,a3 as V,r as m,a as x,j as s,au as _,a4 as I,L as G,a5 as J}from"./index-KQFNJtc4.js";import{f as Q,g as U}from"./SalesService-ztkjKMIV.js";import{A as W}from"./AdaptableCard-KBCkay_F.js";import{B as X}from"./Badge-bjXHJ45y.js";import{T as N}from"./Tooltip-rFfMZWAg.js";import{D as Z}from"./DataTable-IfRC6vSg.js";import{ag as ee,R as k,D as te,aC as se}from"./index.esm-jb16UrWF.js";import{N as ae}from"./react-number-format.es-EL_z9X5o.js";import{u as v}from"./useThemeClass-MKHQSpAX.js";import{c as b}from"./cloneDeep-CjJ0LPh2.js";import{B as M}from"./Button--D0tRVmb.js";import{I as oe}from"./Input-7K7l2bPW.js";import{d as re}from"./debounce-5rQpXXJ3.js";import{t as le,N as ne}from"./toast-Ut9FvtUP.js";import{C as ie}from"./ConfirmDialog-DobhleTJ.js";import"./ApiService-etMEz65z.js";import"./Card-xLnaagij.js";import"./index.esm-ODZ_1Gk0.js";import"./floating-ui.react-gVU2UEvr.js";import"./floating-ui.dom-0rLBacrf.js";import"./index-xIA8Eb8D.js";import"./motion-4MnqOKZu.js";import"./index-HK5HFBCm.js";import"./index.esm-ern5TROG.js";import"./index-z54QVuOa.js";import"./Select-eIzXoRWu.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./Views-aA243lDZ.js";import"./get-EkBL7rjB.js";import"./_MapCache-0VrhD5q7.js";import"./toString-46epAutM.js";import"./context-U4uJiOlk.js";import"./index-PATcdrSP.js";import"./_getAllKeys-XkXg1sqn.js";import"./_baseIsEqual--CyDiGti.js";import"./TableRowSkeleton-L_oqfN6h.js";import"./Skeleton-WushIjJD.js";import"./index-fZLjKFPj.js";import"./isNil-L5c80eVR.js";import"./useTimeout-G2Qm5THD.js";import"./CloseButton-BKu3Sc69.js";import"./StatusIcon-ssNMhrIR.js";import"./chainedFunction-ltcSYACe.js";import"./index-AzPWxrgC.js";import"./useMergeRef-Rt_Crb27.js";import"./Dialog-gPRHHHeh.js";import"./index-0dSQWtvB.js";import"./index-lFfMMwZ5.js";const A="salesOrderList",g=q(A+"/getOrders",async t=>(await Q(t)).data),T=async t=>(await U(t)).data,ce={loading:!1,orderList:[],tableData:{total:0,pageIndex:1,pageSize:10,query:"",sort:{order:"",key:""}},selectedRows:[],selectedRow:"",deleteMode:""},B=H({name:`${A}/state`,initialState:ce,reducers:{setOrderList:(t,e)=>{t.orderList=e.payload},setTableData:(t,e)=>{t.tableData=e.payload},setSelectedRows:(t,e)=>{t.selectedRows=e.payload},setSelectedRow:(t,e)=>{t.selectedRow=e.payload},addRowItem:(t,{payload:e})=>{const r=L(t);r.selectedRows.includes(e)||(t.selectedRows=[...r.selectedRows,...e])},removeRowItem:(t,{payload:e})=>{const r=L(t);r.selectedRows.includes(e)&&(t.selectedRows=r.selectedRows.filter(l=>l!==e))},setDeleteMode:(t,e)=>{t.deleteMode=e.payload}},extraReducers:t=>{t.addCase(g.fulfilled,(e,r)=>{e.orderList=r.payload.data,e.tableData.total=r.payload.total,e.loading=!1}).addCase(g.pending,e=>{e.loading=!0})}}),{setOrderList:wt,setTableData:w,setSelectedRows:j,setSelectedRow:O,addRowItem:de,removeRowItem:me,setDeleteMode:C}=B.actions,pe=B.reducer,ue=Y({data:pe}),p=V,R={0:{label:"Paid",dotClass:"bg-emerald-500",textClass:"text-emerald-500"},1:{label:"Pending",dotClass:"bg-amber-500",textClass:"text-amber-500"},2:{label:"Failed",dotClass:"bg-red-500",textClass:"text-red-500"}},he=({paymentMehod:t,className:e})=>{switch(t){case"visa":return s.jsx("img",{className:e,src:"/img/others/img-8.png",alt:t});case"master":return s.jsx("img",{className:e,src:"/img/others/img-9.png",alt:t});case"paypal":return s.jsx("img",{className:e,src:"/img/others/img-10.png",alt:t});default:return s.jsx(s.Fragment,{})}},ge=({row:t})=>{const{textTheme:e}=v(),r=I(),l=m.useCallback(()=>{r(`/app/sales/order-details/${t.id}`)},[r,t]);return s.jsxs("span",{className:`cursor-pointer select-none font-semibold hover:${e}`,onClick:l,children:["#",t.id]})},xe=({row:t})=>{const e=x(),{textTheme:r}=v(),l=I(),d=()=>{e(C("single")),e(O([t.id]))},c=m.useCallback(()=>{l(`/app/sales/order-details/${t.id}`)},[l,t]);return s.jsxs("div",{className:"flex justify-end text-lg",children:[s.jsx(N,{title:"View",children:s.jsx("span",{className:`cursor-pointer p-2 hover:${r}`,onClick:c,children:s.jsx(ee,{})})}),s.jsx(N,{title:"Delete",children:s.jsx("span",{className:"cursor-pointer p-2 hover:text-red-500",onClick:d,children:s.jsx(k,{})})})]})},fe=()=>{const t=m.useRef(null),e=x(),{pageIndex:r,pageSize:l,sort:d,query:c,total:u}=p(a=>a.salesOrderList.data.tableData),i=p(a=>a.salesOrderList.data.loading),n=p(a=>a.salesOrderList.data.orderList),f=m.useCallback(()=>{e(g({pageIndex:r,pageSize:l,sort:d,query:c}))},[e,r,l,d,c]);m.useEffect(()=>{e(j([])),f()},[e,f,r,l,d]),m.useEffect(()=>{var a;t&&((a=t.current)==null||a.resetSelected())},[n]);const h=m.useMemo(()=>({pageIndex:r,pageSize:l,sort:d,query:c,total:u}),[r,l,d,c,u]),E=m.useMemo(()=>[{header:"Order",accessorKey:"id",cell:a=>s.jsx(ge,{row:a.row.original})},{header:"Date",accessorKey:"date",cell:a=>{const o=a.row.original;return s.jsx("span",{children:_.unix(o.date).format("DD/MM/YYYY")})}},{header:"Customer",accessorKey:"customer"},{header:"Status",accessorKey:"status",cell:a=>{const{status:o}=a.row.original;return s.jsxs("div",{className:"flex items-center",children:[s.jsx(X,{className:R[o].dotClass}),s.jsx("span",{className:`ml-2 rtl:mr-2 capitalize font-semibold ${R[o].textClass}`,children:R[o].label})]})}},{header:"Payment Method",accessorKey:"paymentMehod",cell:a=>{const{paymentMehod:o,paymentIdendifier:D}=a.row.original;return s.jsxs("span",{className:"flex items-center",children:[s.jsx(he,{className:"max-h-[20px]",paymentMehod:o}),s.jsx("span",{className:"ltr:ml-2 rtl:mr-2",children:D})]})}},{header:"Total",accessorKey:"totalAmount",cell:a=>{const{totalAmount:o}=a.row.original;return s.jsx(ae,{displayType:"text",value:(Math.round(o*100)/100).toFixed(2),prefix:"$",thousandSeparator:!0})}},{header:"",id:"action",cell:a=>s.jsx(xe,{row:a.row.original})}],[]),z=a=>{const o=b(h);o.pageIndex=a,e(w(o))},$=a=>{const o=b(h);o.pageSize=Number(a),o.pageIndex=1,e(w(o))},F=a=>{const o=b(h);o.sort=a,e(w(o))},K=(a,o)=>{e(a?de([o.id]):me(o.id))},P=m.useCallback((a,o)=>{if(a){const D=o.map(y=>y.original),S=[];D.forEach(y=>{S.push(y.id)}),e(j(S))}else e(j([]))},[e]);return s.jsx(Z,{ref:t,selectable:!0,columns:E,data:n,loading:i,pagingData:{total:h.total,pageIndex:h.pageIndex,pageSize:h.pageSize},onPaginationChange:z,onSelectChange:$,onSort:F,onCheckBoxChange:K,onIndeterminateCheckBoxChange:P})},be=()=>{const t=x(),e=m.useRef(null),r=p(i=>i.salesOrderList.data.tableData),l=re(d,500);function d(i){const n=b(r);n.query=i,n.pageIndex=1,typeof i=="string"&&i.length>1&&c(n),typeof i=="string"&&i.length===0&&c(n)}const c=i=>{t(w(i)),t(g(i))},u=i=>{l(i.target.value)};return s.jsx(oe,{ref:e,className:"lg:w-52",size:"sm",placeholder:"Search",prefix:s.jsx(te,{className:"text-lg"}),onChange:u})},we=()=>{const t=x(),e=()=>{t(C("batch"))};return s.jsx(M,{variant:"solid",color:"red-600",size:"sm",icon:s.jsx(k,{}),onClick:e,children:"Batch Delete"})},je=()=>{const t=p(e=>e.salesOrderList.data.selectedRows);return s.jsxs("div",{className:"flex flex-col lg:flex-row lg:items-center gap-4",children:[t.length>0&&s.jsx(we,{}),s.jsx(G,{download:!0,to:"/data/order-list.csv",target:"_blank",children:s.jsx(M,{block:!0,size:"sm",icon:s.jsx(se,{}),children:"Export"})}),s.jsx(be,{})]})},Ce=()=>{const t=x(),e=p(n=>n.salesOrderList.data.selectedRows),r=p(n=>n.salesOrderList.data.selectedRow),l=p(n=>n.salesOrderList.data.deleteMode),d=p(n=>n.salesOrderList.data.tableData),c=()=>{t(C("")),l==="single"&&t(O([]))},u=async()=>{if(t(C("")),l==="single"){const n=await T({id:r});i(n),t(O([]))}if(l==="batch"){const n=await T({id:e});i(n,e.length),t(j([]))}},i=(n,f=0)=>{n&&(t(g(d)),le.push(s.jsxs(ne,{title:"Successfuly Deleted",type:"success",duration:2500,children:[l==="single"&&"Order ",l==="batch"&&`${f} orders `,"successfuly deleted"]}),{placement:"top-center"}))};return s.jsx(ie,{isOpen:l==="single"||l==="batch",type:"danger",title:"Delete product",confirmButtonColor:"red-600",onClose:c,onRequestClose:c,onCancel:c,onConfirm:u,children:s.jsx("p",{children:"Are you sure you want to delete this order? All record related to this order will be deleted as well. This action cannot be undone."})})};J("salesOrderList",ue);const De=()=>s.jsxs(W,{className:"h-full",bodyClass:"h-full",children:[s.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[s.jsx("h3",{className:"mb-4 lg:mb-0",children:"Orders"}),s.jsx(je,{})]}),s.jsx(fe,{}),s.jsx(Ce,{})]}),jt=De;export{jt as default};
