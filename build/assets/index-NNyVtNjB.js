import{a0 as T,a1 as q,a2 as I,a3 as O,a as b,r as u,j as e,L as V,c as H,n as $,a5 as z}from"./index-KQFNJtc4.js";import{B as h}from"./Button--D0tRVmb.js";import{I as f}from"./Input-7K7l2bPW.js";import{T as P}from"./Tooltip-rFfMZWAg.js";import{D as G,E as B,F as R,G as Z,I as J,J as K,K as U,L as _}from"./index.esm-jb16UrWF.js";import{b as Q,c as W,d as X}from"./ProjectService-xvuuYmCK.js";import{d as Y}from"./debounce-5rQpXXJ3.js";import{C as ee}from"./Card-xLnaagij.js";import{I as se,P as te,M as ae,L as re}from"./ListItem-nm1hMUE6.js";import{D as oe}from"./Dialog-gPRHHHeh.js";import{F as ie,a as C}from"./FormItem-2JfN42Fx.js";import{S as ne,c as ce}from"./Select-eIzXoRWu.js";import{A as M}from"./index-AzPWxrgC.js";import{h as le}from"./index-wkEyn3aS.js";import{C as de}from"./index-PATcdrSP.js";import{F as me,a as pe,b as L}from"./formik.esm-By06f7yH.js";import{c as ue}from"./cloneDeep-CjJ0LPh2.js";import{c as je,a as A,b as xe,d as he}from"./index.esm-7qOHjUbL.js";import{C as ge}from"./Views-aA243lDZ.js";import"./context-U4uJiOlk.js";import"./isNil-L5c80eVR.js";import"./get-EkBL7rjB.js";import"./_MapCache-0VrhD5q7.js";import"./toString-46epAutM.js";import"./index.esm-ODZ_1Gk0.js";import"./floating-ui.react-gVU2UEvr.js";import"./floating-ui.dom-0rLBacrf.js";import"./index-xIA8Eb8D.js";import"./motion-4MnqOKZu.js";import"./ApiService-etMEz65z.js";import"./index-Y2M8gtIX.js";import"./useRootClose-b6oqxtll.js";import"./useUniqueId-xJrexGbP.js";import"./chainedFunction-ltcSYACe.js";import"./index-SHUMIt5Z.js";import"./EllipsisButton-ecrSX0C7.js";import"./index.esm-EcMqkhqU.js";import"./UsersAvatarGroup-RQSJMom9.js";import"./useTwColorByName-JPbI6Itk.js";import"./Progress-o3XQZPt7.js";import"./index-0dSQWtvB.js";import"./index-lFfMMwZ5.js";import"./CloseButton-BKu3Sc69.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./useMergeRef-Rt_Crb27.js";import"./useControllableState-3J1B9mvc.js";import"./useDidUpdate-b_FKj8P3.js";import"./useTimeout-G2Qm5THD.js";import"./_getAllKeys-XkXg1sqn.js";import"./_baseIsEqual--CyDiGti.js";const w="projectList",y=T(w+"/getList",async t=>(await Q(t)).data),D=T(w+"/getMembers",async()=>(await W()).data.allMembers.map(a=>({value:a.id,label:a.name,img:a.img}))),E=T(w+"/putProject",async t=>(await X(t)).data),fe={loading:!1,projectList:[],allMembers:[],view:"grid",query:{sort:"asc",search:""},newProjectDialog:!1},F=q({name:`${w}/state`,initialState:fe,reducers:{toggleView:(t,s)=>{t.view=s.payload},toggleSort:(t,s)=>{t.query.sort=s.payload},setSearch:(t,s)=>{t.query.search=s.payload},toggleNewProjectDialog:(t,s)=>{t.newProjectDialog=s.payload}},extraReducers:t=>{t.addCase(y.fulfilled,(s,a)=>{s.projectList=a.payload,s.loading=!1}).addCase(y.pending,s=>{s.loading=!0}).addCase(D.fulfilled,(s,a)=>{s.allMembers=a.payload}).addCase(E.fulfilled,(s,a)=>{s.projectList=a.payload})}}),{toggleView:be,toggleSort:we,toggleNewProjectDialog:S,setSearch:Ne}=F.actions,ke=F.reducer,ve=I({data:ke}),j=O,Ce=()=>{const t=b(),s=u.useRef(null),a=j(r=>r.projectList.data.view),{sort:o}=j(r=>r.projectList.data.query),p=()=>{t(be(a==="grid"?"list":"grid"))},n=()=>{t(we(o==="asc"?"desc":"asc"))},i=()=>{t(S(!0))},c=Y(l,500);function l(r){t(Ne(r))}const x=r=>{c(r.target.value)};return e.jsxs("div",{className:"lg:flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"mb-4 lg:mb-0",children:"Project List"}),e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-1",children:[e.jsx(f,{ref:s,size:"sm",placeholder:"Search",prefix:e.jsx(G,{className:"text-lg"}),onChange:x}),e.jsx(P,{title:a==="grid"?"List view":"Grid view",children:e.jsx(h,{className:"hidden md:flex",variant:"plain",size:"sm",icon:a==="grid"?e.jsx(B,{}):e.jsx(R,{}),onClick:()=>p()})}),e.jsx(P,{title:`Sort: ${o==="asc"?"A-Z":"Z-A"}`,children:e.jsx(h,{className:"hidden md:flex",variant:"plain",size:"sm",icon:o==="asc"?e.jsx(Z,{}):e.jsx(J,{}),onClick:n})}),e.jsx(h,{size:"sm",variant:"twoTone",icon:e.jsx(K,{}),onClick:i,children:"New Project"})]})]})},Le=({data:t})=>{const{name:s,totalTask:a,completedTask:o,progression:p,desc:n,member:i}=t;return e.jsx(ee,{bodyClass:"h-full",children:e.jsxs("div",{className:"flex flex-col justify-between h-full",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx(V,{to:"/app/scrum-board",children:e.jsx("h6",{children:s})}),e.jsx(se,{})]}),e.jsx("p",{className:"mt-4",children:n}),e.jsxs("div",{className:"mt-3",children:[e.jsx(te,{progression:p}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[e.jsx(ae,{members:i}),e.jsx("div",{className:"flex items-center rounded-full font-semibold text-xs",children:e.jsxs("div",{className:"flex items-center px-2 py-1 border border-gray-300 rounded-full",children:[e.jsx(U,{className:"text-base"}),e.jsxs("span",{className:"ml-1 rtl:mr-1 whitespace-nowrap",children:[o," / ",a]})]})})]})]})]})})},ye=()=>{const t=b(),s=j(i=>i.projectList.data.loading),a=j(i=>i.projectList.data.projectList),o=j(i=>i.projectList.data.view),{sort:p,search:n}=j(i=>i.projectList.data.query);return u.useEffect(()=>{t(y({sort:p,search:n}))},[t,p,n]),e.jsxs("div",{className:H("mt-6 h-full flex flex-col",s&&"justify-center"),children:[s&&e.jsx("div",{className:"flex justify-center",children:e.jsx($,{size:40})}),o==="grid"&&a.length>0&&!s&&e.jsx("div",{className:"grid md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:a.map(i=>e.jsx(Le,{data:i},i.id))}),o==="list"&&a.length>0&&!s&&a.map(i=>e.jsx(re,{data:i},i.id))]})},Te=({onAddNewTask:t})=>{const[s,a]=u.useState(!1),[o,p]=u.useState([]),n=u.useRef(null);u.useEffect(()=>{var r;s&&((r=n==null?void 0:n.current)==null||r.focus())},[s]);const i=u.useMemo(()=>{let r=0;const d=o.length;return o.forEach(m=>{m.checked&&(r=r+1)}),{completedTask:r,totalTask:d}},[o]);u.useEffect(()=>{t(i)},[o]);const c=()=>{a(!0)},l=()=>{var d;const r={label:(d=n==null?void 0:n.current)==null?void 0:d.value,checked:!1};p(m=>[...m,r]),a(!1)},x=(r,d)=>{p(m=>[...m.map((g,k)=>(d===k&&(g.checked=r),g))])};return e.jsxs("div",{className:"mb-7",children:[o.length>0&&e.jsx("div",{className:"flex flex-col mb-5",children:o.map((r,d)=>e.jsx(de,{defaultChecked:r.checked,onChange:m=>x(m,d),children:r.label},d))}),s?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(f,{ref:n,placeholder:"Add new task"}),e.jsx(h,{type:"button",onClick:l,children:"Add"})]}):e.jsx(h,{block:!0,className:"border-dashed",onClick:c,children:"Create new task"})]})},{MultiValueLabel:Se}=ce,{useUniqueId:Pe}=le,Ae=({innerProps:t,label:s,data:a,isSelected:o})=>e.jsxs("div",{className:`flex items-center justify-between p-2 ${o?"bg-gray-100 dark:bg-gray-500":"hover:bg-gray-50 dark:hover:bg-gray-600"}`,...t,children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(M,{shape:"circle",size:20,src:a.img}),e.jsx("span",{className:"ml-2 rtl:mr-2",children:s})]}),o&&e.jsx(_,{className:"text-emerald-500 text-xl"})]}),Me=({children:t,...s})=>{const{img:a}=s.data;return e.jsx(Se,{...s,children:e.jsxs("div",{className:"inline-flex items-center",children:[e.jsx(M,{className:"mr-2 rtl:ml-2",shape:"circle",size:15,src:a}),t]})})},De=je().shape({title:A().min(3,"Too Short!").required("Title required"),content:A().required("Title required"),assignees:xe().min(1,"Assignee required"),rememberMe:he()}),Ee=()=>{const t=b(),s=j(c=>c.projectList.data.allMembers),a=Pe("project-"),[o,p]=u.useState({});u.useEffect(()=>{t(D())},[t]);const n=c=>{p(c)},i=(c,l)=>{l(!0);const{title:x,content:r,assignees:d}=c,{totalTask:m,completedTask:N}=o,g=ue(d).map(v=>(v.name=v.label,v)),k={id:a,name:x,desc:r,totalTask:m,completedTask:N,progression:N/m*100||0,member:g};t(E(k)),t(S(!1))};return e.jsx(me,{initialValues:{title:"",content:"",assignees:[]},validationSchema:De,onSubmit:(c,{setSubmitting:l})=>{i(c,l)},children:({touched:c,errors:l,values:x})=>e.jsx(pe,{children:e.jsxs(ie,{children:[e.jsx(C,{label:"Title",invalid:l.title&&c.title,errorMessage:l.title,children:e.jsx(L,{type:"text",autoComplete:"off",name:"title",placeholder:"Enter title",component:f})}),e.jsx(C,{label:"Assignees",invalid:l.assignees&&c.assignees,errorMessage:l.assignees,children:e.jsx(L,{name:"assignees",children:({field:r,form:d})=>e.jsx(ne,{isMulti:!0,className:"min-w-[120px]",components:{Option:Ae,MultiValueLabel:Me},field:r,form:d,options:s,value:x.assignees,onChange:m=>{d.setFieldValue(r.name,m)}})})}),e.jsx(C,{label:"Content",invalid:l.content&&c.content,errorMessage:l.content,children:e.jsx(L,{textArea:!0,type:"text",autoComplete:"off",name:"content",placeholder:"Enter content",component:f})}),e.jsx(Te,{onAddNewTask:n}),e.jsx(h,{block:!0,variant:"solid",type:"submit",children:"Submit"})]})})})},Fe=()=>{const t=b(),s=j(o=>o.projectList.data.newProjectDialog),a=()=>{t(S(!1))};return e.jsxs(oe,{isOpen:s,onClose:a,onRequestClose:a,children:[e.jsx("h4",{children:"Add new project"}),e.jsx("div",{className:"mt-4",children:e.jsx(Ee,{})})]})};z("projectList",ve);const qe=()=>e.jsxs(ge,{className:"h-full",children:[e.jsx(Ce,{}),e.jsx(ye,{}),e.jsx(Fe,{})]}),Fs=qe;export{Fs as default};
