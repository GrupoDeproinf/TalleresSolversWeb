import{r as n,j as e,a4 as pt,a7 as B,a8 as ie,a9 as M,aa as z,ab as W,ac as ft,ad as ut,ag as ne,ai as gt,aj as he,ak as be,al as je,am as Ne,af as V}from"./index-0JW14Cl4.js";import{P as ht}from"./index-b0erAvUs.js";import{T as ye}from"./index-a8YK1BSZ.js";import{u as bt,f as we,g as jt,a as Nt,b as yt}from"./index-q-FCLJof.js";import{h as ce,i as ve,j as Ce,k as R,l as U,m as wt,f as De,n as Ee,o as Te,p as Fe,q as Se}from"./index.esm-WNi23VL7.js";import{B as E}from"./Button-D58LGLsw.js";import{D as _e}from"./Dialog-PNbmhsuG.js";import{t as m,N as x}from"./toast-BZUDBRx8.js";import{D as vt}from"./Drawer-cacAKkB7.js";import"./Alert-WGdpNIev.js";import{A as Ct}from"./index-jFqavRgw.js";import"./Badge-ci3jENQ_.js";import"./Calendar-NZF8cyZ8.js";import"./Card-TuPZ2v2_.js";import"./index-VCcEXhlG.js";import"./index-0EpNqkF8.js";import"./index-TeXUR02l.js";import"./FormItem-aMZDCmbO.js";import"./Input-mvUTiocb.js";import"./index-f0lBNEsm.js";import"./index-0giiyGbd.js";import"./index-mai8cBh3.js";import"./Progress-rjrW8WVo.js";import"./index-phxxI0mK.js";import"./RangeCalendar-T33GG2dJ.js";import"./ScrollBar-iFlxYOtX.js";import"./index-bqDPFWnc.js";import"./Select-Lio6vz6X.js";import"./Skeleton-72D-q3Kg.js";import"./index-LutvQtfN.js";import"./Switcher-wa_oD5IZ.js";import"./index-3zjrJiu6.js";import"./Tag-FFFqS8TW.js";import"./index-FiIxSSJg.js";import"./index-RH6RtrUA.js";import"./Tooltip-7ixFulgX.js";import"./Upload-60e6Z-HR.js";import{O as Dt,D as Et}from"./index.esm-YV82YYEg.js";import{G as Tt}from"./index.esm-WovxVzJB.js";import{c as Ft,a as T,f as St,e as de}from"./index.esm-dq2Mrn92.js";import{F as _t,a as kt,b as D,E as f}from"./formik.esm-Y35JEICj.js";import{G as It,M as Rt}from"./esm-c6XMgUKz.js";import{u as me,w as Pt}from"./xlsx-b-y62sF7.js";import"./context-AxDKAhEU.js";import"./index-pO4z0aep.js";import"./index-Jck-JtMN.js";import"./CloseButton-MFjMnfDD.js";import"./motion-AtCGOUgk.js";import"./useTimeout-1ZYN8nxV.js";import"./StatusIcon-AFB-bwed.js";import"./chainedFunction-ltcSYACe.js";import"./useMergeRef-Rt_Crb27.js";import"./useControllableState-0kz-DI5s.js";import"./cloneDeep-s6G8qFQF.js";import"./_getAllKeys-xDBjIaWt.js";import"./_MapCache-5vzp6XNL.js";import"./Views-ArJd3jpj.js";import"./_baseIsEqual-z3kvFbSD.js";import"./get-9ErrADOi.js";import"./toString-E2JY-uAt.js";import"./floating-ui.react-wwZWrrrF.js";import"./floating-ui.dom-0rLBacrf.js";import"./TimeInput-8bXBKx6z.js";import"./useUniqueId-dRdzrVMw.js";import"./useDidUpdate-72apsg4I.js";import"./useRootClose-887SIejw.js";import"./isNil-KJxS5irh.js";import"./index-VwLHg0MV.js";import"./toConsumableArray-YYxflNc8.js";import"./objectWithoutPropertiesLoose-pdUxmcoj.js";import"./setPrototypeOf-ahVgEFUp.js";import"./mapCloneElement-A4UKmhr7.js";import"./index.esm-kYnGXkxy.js";import"./index.esm-AHs6zK81.js";const Lt=P=>{const{data:b,save:Y}=P,[Z]=n.useState({lat:10.47915,lng:-66.90618}),[X]=n.useState(10),ee=async L=>{if(!L.latLng)return;const F={lat:L.latLng.lat(),lng:L.latLng.lng()};console.log(F),Y({latiLng:F,zoom:17})};return e.jsx("div",{style:{height:"450px",width:"100%"},children:e.jsx(It,{center:b?b.latiLng:Z,zoom:b?b.zoom:X,mapContainerStyle:{height:"400px",width:"100%",marginTop:"10px"},onClick:ee,children:b&&e.jsx(Rt,{position:b.latiLng})})})},At=()=>{const[P,b]=n.useState(null),[Y,Z]=n.useState([]),[X,ee]=n.useState([{id:"createdAt",desc:!0}]),[L,F]=n.useState(!1),[K,ke]=n.useState("nombre"),[S,xe]=n.useState(""),[Ie,G]=n.useState([]),[v,H]=n.useState(null);n.useState(!1);const[Re,te]=n.useState(!1),[_,Pe]=n.useState(!1),[u,Le]=n.useState(""),[g,Ae]=n.useState(""),A=async()=>{const t=B(ie(M,"Usuarios")),s=await z(t),r=[];s.forEach(a=>{const o=a.data();o.typeUser==="Taller"&&(_||o.status!=="Eliminado")&&r.push({...o,id:a.id})}),Z(r)},Oe=pt();n.useEffect(()=>{A()},[_]);const $e=async()=>{await A(),m.push(e.jsx(x,{title:"Datos actualizados",children:"La tabla ha sido actualizada con éxito."}))},qe=()=>{const t=["nombre","rif","estado","email","phone","status","Direccion","createdAt"],s={nombre:"Nombre del Taller",rif:"RIF",estado:"Estado",email:"Correo Electrónico",phone:"Número Telefónico",status:"Estado de Aprobación",Direccion:"Dirección",createdAt:"Fecha de Creación"},a=Q.getRowModel().rows.map(d=>d.original).map(d=>{const i={};return t.forEach(y=>{let h=d[y];const I=s[y]||y;if(y==="createdAt"&&h){let j;typeof h=="number"?j=h:typeof h=="object"&&h.seconds?j=h.seconds*1e3:typeof h=="string"?j=new Date(h).getTime():j=0,j>0&&(h=new Date(j).toLocaleDateString("es-ES"))}i[I]=h??""}),i.Certificador=d.certificador_nombre??"",i});if(a.length===0){m.push(e.jsx(x,{title:"Sin datos para exportar",children:"No hay talleres disponibles para exportar con los filtros aplicados."}));return}let o="talleres";if(S&&(o+=`_filtro_${K}_${S}`),u||g){const d=u?new Date(u).toLocaleDateString("es-ES").replace(/\//g,"-"):"",i=g?new Date(g).toLocaleDateString("es-ES").replace(/\//g,"-"):"";o+=`_fecha_${d}_${i}`}_&&(o+="_incluye_eliminados"),o+=".xlsx";const l=me.json_to_sheet(a),c=me.book_new();me.book_append_sheet(c,l,"Talleres"),Pt(c,o),m.push(e.jsxs(x,{title:"Exportación exitosa",children:["El archivo Excel se ha descargado correctamente con ",a.length," registros."]})),te(!1)},Be=()=>{te(!0)},se=()=>{te(!1)},[Me,J]=n.useState(!1),[pe,k]=n.useState(!1),[ze,Ue]=n.useState({nombre:"",email:"",rif:"",phone:"",uid:"",typeUser:"Taller",image_perfil:"",image_file:"",status:"Aprobado",Direccion:"",ubicacion:"",id:"",password:"",estado:""}),Ke=t=>{H(t),F(!0)},Ge=Ft().shape({nombre:T().min(3,"El nombre debe tener al menos 3 caracteres").required("El nombre es obligatorio"),email:T().email("Debe ser un email válido").required("El correo electrónico es obligatorio").test("termina-en-com",'El email debe terminar en ".com"',t=>(t==null?void 0:t.endsWith(".com"))??!1),rif:T().matches(/^[V,E,C,G,J,P]-\d{7,10}$/,"tener entre 7 y 10 dígitos").required("El rif es obligatoria"),phone:T().matches(/^[1-9]\d{10}$/,"El teléfono debe tener 11 dígitos y no puede comenzar con 0").required("El teléfono es obligatorio"),password:T().required("Por favor ingrese una contraseña").min(6,"La contraseña debe tener al menos 6 caracteres"),confirmPassword:T().oneOf([St("password")],"Las contraseñas no coinciden").required("Por favor confirme su contraseña"),estado:T().required("El estado es obligatorio"),rifIdFiscal_file:de().required("El RIF ID Fiscal es obligatorio"),fotoFrenteTaller_file:de().required("La foto del frente del taller es obligatoria"),fotoInternaTaller_file:de().required("La foto interna del taller es obligatoria")});n.useState(!1);const He=async(t,s)=>{if(t.password!==t.confirmPassword){m.push(e.jsx(x,{title:"Error",children:"Las contraseñas no coinciden. Por favor, verifica los campos."}));return}k(!0);try{const r=ie(M,"Usuarios"),a=t.email.toLowerCase(),o=B(r,W("email","==",a));if(!(await z(o)).empty){k(!1),m.push(e.jsx(x,{title:"Error",children:"¡El correo electrónico ya está registrado!"}));return}const c=B(r,W("rif","==",t.rif));if(!(await z(c)).empty){k(!1),m.push(e.jsx(x,{title:"Error",children:"¡El RIF ya está registrado!"}));return}const i=B(r,W("phone","==",t.phone));if(!(await z(i)).empty){k(!1),m.push(e.jsx(x,{title:"Error",children:"¡El número de teléfono ya está registrado!"}));return}const I=(await ut(ft,a,t.password)).user,j=ne(r,I.uid),mt=Date.now(),xt={uid:I.uid,nombre:t.nombre,email:a,rif:t.rif,phone:t.phone,typeUser:"Taller",status:"Aprobado",Direccion:t.Direccion,ubicacion:s===null?"":s.latiLng,estado:t.estado,image_perfil:"",createdAt:mt};await gt(j,xt),J(!1),b(null),k(!1),m.push(e.jsx(x,{title:"Éxito",children:"Taller creado exitosamente. Los documentos se están subiendo en segundo plano."})),A();const O=async(N,p)=>{var w;if(!N)return null;try{const C=(w=N.name.split(".").pop())==null?void 0:w.toLowerCase();if(!C)return console.warn(`No se pudo obtener la extensión del archivo: ${p}`),null;const $=`${p}.${C}`,q=be(he,`documents/${I.uid}/${$}`);return await je(q,N),await Ne(q)}catch(C){return console.error(`Error subiendo ${p}:`,C),null}};t.image_file&&(async()=>{var N;try{const p=(N=t.image_file.name.split(".").pop())==null?void 0:N.toLowerCase();if(p&&["png","jpg","jpeg","webp"].includes(p)){const w=`${I.uid}_1.${p}`,C=be(he,`profileImages/${w}`);await je(C,t.image_file);const $=await Ne(C);await V(j,{image_perfil:$})}}catch(p){console.error("Error subiendo logo:",p)}})(),(async()=>{try{const N=[O(t.rifIdFiscal_file,"rifIdFiscal"),O(t.permisoOperacion_file,"permisoOperacion"),O(t.logotipoNegocio_file,"logotipoNegocio"),O(t.fotoFrenteTaller_file,"fotoFrenteTaller"),O(t.fotoInternaTaller_file,"fotoInternaTaller")],p=await Promise.all(N),w={};["rifIdFiscal","permisoOperacion","logotipoNegocio","fotoFrenteTaller","fotoInternaTaller"].forEach(($,q)=>{p[q]&&(w[$]=p[q])}),Object.keys(w).length>0&&(await V(j,w),console.log("Documentos actualizados en Firestore:",w),A())}catch(N){console.error("Error subiendo documentos:",N)}})()}catch(r){console.error("Error creando el taller:",r),k(!1);let a="Hubo un error al crear el Taller.";r.code==="auth/email-already-in-use"?a="El correo electrónico ya está en uso.":r.code==="auth/weak-password"?a="La contraseña es muy débil.":r.message&&(a=r.message),m.push(e.jsx(x,{title:"Error",children:a}))}},Je=t=>{const s=t.target.value;xe(s);const r=[];if(s&&r.push({id:K,value:s}),u||g){const a={from:u||"",to:g||""};r.push({id:"createdAt",value:JSON.stringify(a)})}G(r)},Qe=t=>{const s=t.target.value;ke(s),xe(""),!u&&!g?G([]):Ye(u,g)},We=t=>{const s=t.target.value;if(Le(s),s&&g&&new Date(s)>new Date(g)){m.push(e.jsx(x,{title:"Error de validación",children:'La fecha "Desde" no puede ser mayor que la fecha "Hasta".'}));return}ae(s,g,S)},Ve=t=>{const s=t.target.value;if(Ae(s),s&&u&&new Date(s)<new Date(u)){m.push(e.jsx(x,{title:"Error de validación",children:'La fecha "Hasta" no puede ser menor que la fecha "Desde".'}));return}ae(u,s,S)},ae=(t,s,r)=>{const a=[];if(r&&a.push({id:K,value:r}),t||s){const o={from:t||"",to:s||""};a.push({id:"createdAt",value:JSON.stringify(o)})}G(a)},Ye=(t,s)=>{ae(t,s,S)},Ze=t=>{console.log("Drawer cerrado",t),J(!1),b(null),Ue({nombre:"",email:"",rif:"",phone:"",id:"",Direccion:"",uid:"",estado:"",password:"",image_perfil:""}),H(null)},Xe=t=>t?t.split(" ").filter(Boolean).map(r=>typeof r=="string"&&r.length>0?r[0].toUpperCase():"").join(""):"",re=t=>{if(!t)return 0;const s=t.split("-");if(s.length!==3)return 0;const r=parseInt(s[0],10),a=parseInt(s[1],10)-1,o=parseInt(s[2],10);return new Date(o,a,r).getTime()},et=t=>{if(!t)return!1;const s=re(t),r=new Date;return r.setHours(0,0,0,0),s<r.getTime()},tt=[{header:"Nombre",accessorKey:"nombre",cell:({getValue:t,row:s})=>{const r=s.original.image_perfil;return e.jsxs("div",{className:"flex items-center",children:[r?e.jsx("img",{src:r,alt:"Logo",className:"h-10 w-10 object-cover rounded-full mr-4"}):e.jsxs("div",{className:"h-10 w-10 bg-gray-200 rounded flex items-center justify-center mr-2",children:[e.jsx(Tt,{className:"h-6 w-6 text-gray-400","aria-hidden":"true"})," "]}),t()," "]})},filterFn:"includesString",footer:t=>t.column.id},{header:"RIF",accessorKey:"rif"},{header:"Estado",accessorKey:"estado"},{header:"Certificador",accessorKey:"certificador_nombre"},{header:"Email",accessorKey:"email",filterFn:(t,s,r)=>{const a=t.getValue(s);return(a==null?void 0:a.toLowerCase().includes(r.toLowerCase()))||!1}},{header:"Numero Telefonico",accessorKey:"phone",cell:({row:t})=>{const s=t.original.nombre;return e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ct,{className:"mr-2 w-8 h-8 flex items-center justify-center rounded-full",style:{backgroundColor:"#887677"},children:e.jsx("span",{className:"text-white font-bold",children:Xe(s)})}),t.original.phone," "]})}},{header:"Status",accessorKey:"status",cell:({row:t})=>{const s=t.getValue("status");let r,a;switch(s){case"Aprobado":r=e.jsx(Se,{className:"text-green-500 mr-1"}),a="text-green-500";break;case"Rechazado":r=e.jsx(Fe,{className:"text-red-500 mr-1"}),a="text-red-500";break;case"Pendiente":r=e.jsx(Te,{className:"text-yellow-500 mr-1"}),a="text-yellow-500";break;case"En espera por aprobación":r=e.jsx(Ee,{className:"text-blue-500 mr-1"}),a="text-blue-500";break;case"Eliminado":r=e.jsx(De,{className:"text-gray-500 mr-1"}),a="text-gray-500";break;default:r=null}return e.jsxs("div",{className:`flex items-center ${a}`,children:[r,e.jsx("span",{children:s})]})}},{header:"Estado Subscripción",accessorKey:"subscripcion_actual",cell:({row:t})=>{const s=t.original.subscripcion_actual;if(!s)return e.jsx("div",{className:"flex items-center text-gray-400",children:e.jsx("span",{children:"Sin suscripción"})});const r=s.status||"Sin estado",a=s.nombre||"";let o,l;switch(r){case"Aprobado":o=e.jsx(Se,{className:"text-green-500 mr-1"}),l="text-green-500";break;case"Rechazado":o=e.jsx(Fe,{className:"text-red-500 mr-1"}),l="text-red-500";break;case"Pendiente":o=e.jsx(Te,{className:"text-yellow-500 mr-1"}),l="text-yellow-500";break;default:o=e.jsx(Ee,{className:"text-gray-500 mr-1"}),l="text-gray-500"}return e.jsxs("div",{className:`flex items-center ${l}`,children:[o,e.jsx("span",{children:a?`${a} - ${r}`:r})]})}},{header:"Fecha de Creación",accessorKey:"createdAt",cell:({getValue:t})=>{const s=t();if(!s)return"N/A";let r;if(typeof s=="number")r=s;else if(typeof s=="object"&&s.seconds)r=s.seconds*1e3;else if(typeof s=="string")r=new Date(s).getTime();else return"N/A";return new Date(r).toLocaleDateString("es-ES")},sortingFn:(t,s,r)=>{const a=t.getValue(r),o=s.getValue(r),l=i=>i?typeof i=="number"?i:typeof i=="object"&&i.seconds?i.seconds*1e3:typeof i=="string"?new Date(i).getTime():0:0,c=l(a);return l(o)-c},filterFn:(t,s,r)=>{if(!r)return!0;try{const a=JSON.parse(r),o=t.getValue(s);if(console.log("Row timestamp:",o,"Type:",typeof o),console.log("Date range filter:",a),!o)return!1;let l;if(typeof o=="number")l=o;else if(typeof o=="object"&&o.seconds)l=o.seconds*1e3;else if(typeof o=="string")l=new Date(o).getTime();else return console.log("Unknown timestamp format:",o),!1;const c=a.from?new Date(a.from+"T00:00:00"):null,d=a.to?new Date(a.to+"T23:59:59.999"):null;if(c&&!d){const i=c.getTime();return console.log("Filtering from:",i,"Row:",l,"Result:",l>=i),l>=i}if(!c&&d){const i=d.getTime();return console.log("Filtering to:",i,"Row:",l,"Result:",l<=i),console.log("To date formatted:",d.toISOString(),"Row date formatted:",new Date(l).toISOString()),l<=i}if(c&&d){const i=c.getTime(),y=d.getTime();return console.log("Filtering range:",i,"to",y,"Row:",l,"Result:",l>=i&&l<=y),l>=i&&l<=y}return!0}catch(a){return console.error("Error parsing date range filter:",a),!0}}},{header:"Fecha de Visita",accessorKey:"scheduled_visit",cell:({getValue:t})=>t()||"N/A",sortingFn:(t,s,r)=>{const a=t.getValue(r),o=s.getValue(r);if(!a&&o)return 1;if(a&&!o)return-1;if(!a&&!o)return 0;const l=re(a),c=re(o);return l-c},filterFn:"includesString",footer:t=>t.column.id},{header:" ",cell:({row:t})=>{const s=t.original,r=s.status==="Eliminado";return e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>Oe(`/profilegarage/${s.uid}`),className:`${r?"text-gray-400 cursor-not-allowed":"text-blue-900"}`,disabled:r,title:r?"Taller eliminado":"Ver perfil",children:e.jsx(wt,{})}),!r&&e.jsx("button",{onClick:()=>Ke(s),className:"text-red-700",title:"Eliminar taller",children:e.jsx(De,{})})]})}}],{Tr:fe,Th:st,Td:at,THead:rt,TBody:ot,Sorter:Ot}=ye,oe=t=>{console.log("onDialogClose",t),F(!1),H(null)},lt=async()=>{if(v){console.log("Eliminando a:",v);try{const t=ne(M,"Usuarios",v.uid);await V(t,{status:"Eliminado"});const s=ie(M,"Servicios"),r=B(s,W("uid_taller","==",v.uid)),a=await z(r),o=a.docs.map(async c=>{await V(ne(M,"Servicios",c.id),{estatus:!1})});await Promise.all(o);const l=e.jsxs(x,{title:"Éxito",children:["Taller ",v.nombre," eliminado con éxito. Se actualizaron ",a.docs.length," servicios relacionados."]});m.push(l),A()}catch(t){console.error("Error eliminando el taller:",t);const s=e.jsx(x,{title:"Error",children:"Hubo un error eliminando el taller."});m.push(s)}finally{F(!1),H(null)}}},Q=bt({data:Y,columns:tt,state:{sorting:X,columnFilters:Ie},onSortingChange:ee,onColumnFiltersChange:G,getCoreRowModel:jt(),getSortedRowModel:Nt(),getFilteredRowModel:yt()}),[ue,it]=n.useState(1),le=6,nt=Q.getRowModel().rows.length,ct=t=>{console.log("onPaginationChange",t),it(t)},ge=(ue-1)*le,dt=ge+le;return e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("h1",{className:"flex justify-start items-center space-x-4",children:[e.jsx("span",{className:"text-[#000B7E] text-2xl font-bold",children:"Talleres"}),e.jsx("button",{className:"p-2 bg-slate-100 hover:bg-slate-200 active:bg-slate-300 transition-all duration-200 shadow-md transform hover:scale-105 rounded-md",onClick:$e,children:e.jsx(Dt,{className:"w-5 h-5 text-gray-700 hover:text-blue-500 transition-colors duration-200"})})]})}),e.jsxs("div",{className:"flex flex-wrap gap-3 items-start justify-end",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsx("input",{type:"date",placeholder:"Desde",className:"w-36 py-2 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 h-10 text-sm",value:u,onChange:We}),e.jsx("label",{className:"text-xs text-gray-500 mt-1",children:"Desde"})]}),e.jsxs("div",{className:"flex flex-col",children:[e.jsx("input",{type:"date",placeholder:"Hasta",className:"w-36 py-2 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 h-10 text-sm",value:g,onChange:Ve}),e.jsx("label",{className:"text-xs text-gray-500 mt-1",children:"Hasta"})]})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs("label",{className:"flex items-center cursor-pointer whitespace-nowrap",children:[e.jsx("input",{type:"checkbox",checked:_,onChange:t=>{Pe(t.target.checked)},className:"sr-only"}),e.jsx("div",{className:`relative inline-flex h-6 w-11 items-center rounded-full transition-colors ${_?"bg-blue-600":"bg-gray-300"}`,children:e.jsx("span",{className:`inline-block h-4 w-4 transform rounded-full bg-white transition-transform ${_?"translate-x-6":"translate-x-1"}`})}),e.jsx("span",{className:"ml-2 text-sm text-gray-700",children:"Mostrar eliminados"})]})}),e.jsxs("select",{className:"h-10 w-32 py-2 px-3 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",onChange:Qe,value:K,children:[e.jsx("option",{value:"",disabled:!0,children:"Seleccionar columna..."}),e.jsx("option",{value:"nombre",children:"Nombre"}),e.jsx("option",{value:"rif",children:"Rif"}),e.jsx("option",{value:"email",children:"Email"}),e.jsx("option",{value:"status",children:"Estado"})]}),e.jsxs("div",{className:"relative w-64",children:[e.jsx("input",{type:"text",placeholder:"Buscar...",className:"w-full py-2 px-4 pl-10 border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 h-10",value:S,onChange:Je}),e.jsx(Et,{className:"absolute left-3 top-5 transform -translate-y-1/2 text-gray-500 w-5 h-5"})]}),e.jsx(E,{className:"w-36 text-white hover:opacity-80 text-sm",style:{backgroundColor:"#000B7E"},onClick:()=>J(!0),children:"Crear Taller"}),e.jsx("button",{style:{backgroundColor:"#10B981"},className:"w-36 h-10 px-3 text-white rounded-md shadow-md hover:bg-green-600 active:bg-green-700 transition duration-200 hover:opacity-80 text-sm",onClick:Be,children:"Exportar a Excel"})]})]}),e.jsxs("div",{className:"p-3 rounded-lg shadow",children:[e.jsxs(ye,{className:"w-full rounded-lg",children:[e.jsx(rt,{children:Q.getHeaderGroups().map(t=>e.jsx(fe,{children:t.headers.map(s=>e.jsx(st,{colSpan:s.colSpan,children:s.isPlaceholder?null:e.jsx("div",{className:s.column.getCanSort()?"cursor-pointer select-none":"",onClick:s.column.getToggleSortingHandler(),children:we(s.column.columnDef.header,s.getContext())})},s.id))},t.id))}),e.jsx(ot,{children:Q.getRowModel().rows.slice(ge,dt).map(t=>{const s=t.original.status==="Eliminado",r=et(t.original.scheduled_visit);let a="";return s?a="opacity-50 bg-gray-50":r&&(a="bg-red-100 hover:bg-red-200"),e.jsx(fe,{className:a,children:t.getVisibleCells().map(o=>{let l="";return s?l="line-through text-gray-500":r&&(l="text-red-900 font-medium"),e.jsx(at,{className:l,children:we(o.column.columnDef.cell,o.getContext())},o.id)})},t.id)})})]}),e.jsx(ht,{onChange:ct,currentPage:ue,totalRows:nt,rowsPerPage:le})]}),e.jsxs(_e,{isOpen:L,onClose:oe,onRequestClose:oe,children:[e.jsx("h5",{className:"mb-4",children:"Confirmar Eliminación"}),e.jsxs("p",{children:["¿Estás seguro de que deseas marcar como eliminado al taller"," ",v==null?void 0:v.nombre,"? Esta acción también desactivará todos los servicios asociados."]}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(E,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:oe,children:"Cancelar"}),e.jsx(E,{style:{backgroundColor:"#B91C1C"},className:"text-white hover:opacity-80",onClick:lt,children:"Eliminar"})]})]}),e.jsxs(_e,{isOpen:Re,onClose:se,onRequestClose:se,children:[e.jsx("h5",{className:"mb-4",children:"Confirmar Exportación"}),e.jsx("p",{children:"¿Estás seguro de que deseas exportar todos los talleres a Excel?"}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(E,{className:"ltr:mr-2 rtl:ml-2",variant:"plain",onClick:se,children:"Cancelar"}),e.jsx(E,{style:{backgroundColor:"#10B981"},className:"text-white hover:opacity-80",onClick:qe,children:"Exportar"})]})]}),e.jsxs(vt,{isOpen:Me,onClose:Ze,className:"rounded-md shadow",children:[e.jsx("h2",{className:"mb-4 text-xl font-bold",children:"Crear Taller"}),e.jsx(_t,{initialValues:{nombre:"",email:"",rif:"J-",phone:"",Direccion:"",ubicacion:"",password:"",image_perfil:"",estado:"",image_file:null,rifIdFiscal_file:null,permisoOperacion_file:null,logotipoNegocio_file:null,fotoFrenteTaller_file:null,fotoInternaTaller_file:null},validationSchema:Ge,onSubmit:(t,{setSubmitting:s})=>{He(t,P),s(!1),console.log(P),console.log(ze)},children:({values:t,setFieldValue:s,isSubmitting:r})=>e.jsx(kt,{children:e.jsxs("div",{className:"flex flex-col space-y-6",children:[e.jsx("div",{className:"mt-2 flex justify-center rounded-lg border border-dashed border-gray-900/25 px-6 py-10",children:e.jsxs("div",{className:"text-center",children:[t.image_perfil?e.jsx("img",{src:t.image_perfil,alt:"Preview Logo",className:"mx-auto h-32 w-32 object-cover"}):e.jsx(ce,{className:"mx-auto h-12 w-12 text-gray-300","aria-hidden":"true"}),e.jsx("div",{className:"mt-4 flex text-sm leading-6 text-gray-600 justify-center",children:e.jsxs("label",{htmlFor:"logo-upload",className:"relative cursor-pointer rounded-md bg-white font-semibold text-indigo-600 focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 hover:text-indigo-500 flex justify-center items-center",children:[e.jsx("span",{children:t.image_perfil?"Cambiar Logo":"Seleccionar Logo"}),e.jsx("input",{id:"logo-upload",name:"logo-upload",type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",className:"sr-only",onChange:a=>{var l;const o=(l=a.target.files)==null?void 0:l[0];if(o){const c=new FileReader;c.onloadend=()=>{s("image_perfil",c.result),s("image_file",o)},c.readAsDataURL(o)}}})]})})]})}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Nombre Taller:"}),e.jsx(D,{type:"text",name:"nombre",className:"mt-1 p-3 border border-gray-300 rounded-lg"}),e.jsx(f,{name:"nombre",component:"div",className:"text-red-500"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Email:"}),e.jsx(D,{type:"email",name:"email",className:"mt-1 p-3 border border-gray-300 rounded-lg"}),e.jsx(f,{name:"email",component:"div",className:"text-red-500"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"RIF:"}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsxs("select",{name:"rifPrefix",value:t.rif.split("-")[0]||"J",onChange:a=>{const o=`${a.target.value}-${t.rif.split("-")[1]||""}`;s("rif",o)},className:"mx-2 p-3 border border-gray-300 rounded-l-lg",children:[e.jsx("option",{value:"V",children:"V-"}),e.jsx("option",{value:"E",children:"E-"}),e.jsx("option",{value:"C",children:"C-"}),e.jsx("option",{value:"G",children:"G-"}),e.jsx("option",{value:"J",children:"J-"}),e.jsx("option",{value:"P",children:"P-"})]}),e.jsx(D,{type:"text",name:"rif",value:t.rif.split("-")[1]||"",onChange:a=>{const o=`${t.rif.split("-")[0]||"J"}-${a.target.value}`;s("rif",o)},className:"mx-2 p-3 border border-gray-300 rounded-l-lg"})]}),e.jsx(f,{name:"rif",component:"div",className:"text-red-500"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Estado:"}),e.jsxs(D,{as:"select",name:"estado",value:t.estado,className:"mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200",children:[e.jsx("option",{value:"",children:"Seleccione un Estado"}),["Amazonas","Anzoátegui","Apure","Aragua","Barinas","Bolívar","Carabobo","Cojedes","Delta Amacuro","Distrito Capital","Falcón","Guárico","Lara","La Guaira","Mérida","Miranda","Monagas","Nueva Esparta","Portuguesa","Sucre","Táchira","Trujillo","Yaracuy","Zulia"].map(a=>e.jsx("option",{value:a,children:a},a))]}),e.jsx(f,{name:"estado",component:"div",className:"text-red-600 text-sm"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Teléfono:"}),e.jsx(D,{type:"text",name:"phone",placeholder:"Ejem (4142611966)",className:"mt-1 p-3 border border-gray-300 rounded-lg",onKeyDown:a=>{if(a.currentTarget.value===""&&a.key==="0"){a.preventDefault();return}["Backspace","Delete","Tab","Escape","Enter","ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].includes(a.key)||/[0-9]/.test(a.key)||a.preventDefault()},onChange:a=>{const o=a.target.value.replace(/^0+/,"").replace(/[^0-9]/g,"");s("phone",o)}}),e.jsx(f,{name:"phone",component:"div",className:"text-red-500"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Dirección:"}),e.jsx(D,{type:"text",name:"Direccion",placeholder:"Indique su direccion",className:"mt-1 p-3 border border-gray-300 rounded-lg"}),e.jsx(f,{name:"Direccion",component:"div",className:"text-red-500"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Ubicación:"}),e.jsx("div",{className:"flex items-center mt-1 border border-gray-300 rounded-lg focus-within:ring-2 focus-within:ring-blue-500",children:e.jsx(Lt,{data:P,save:b})}),e.jsx(f,{name:"ubicacion",component:"div",className:"text-red-500 text-sm mt-1"})]}),e.jsxs("div",{className:"border-t pt-4 mt-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-700 mb-4",children:"Documentos"}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block font-semibold text-gray-700 mb-2",children:["RIF ID Fiscal: ",e.jsx("span",{className:"text-red-500",children:"*"})]}),t.rifIdFiscal_file?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.rifIdFiscal_file.type.includes("pdf")?e.jsx(Ce,{className:"w-6 h-6 text-red-500"}):e.jsx(R,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.rifIdFiscal_file.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(t.rifIdFiscal_file.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>s("rifIdFiscal_file",null),className:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(U,{className:"w-5 h-5"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,.pdf",id:"rifIdFiscal-upload",className:"sr-only",onChange:a=>{var l;const o=(l=a.target.files)==null?void 0:l[0];o&&s("rifIdFiscal_file",o)}}),e.jsx("label",{htmlFor:"rifIdFiscal-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pt-2",children:[e.jsx(ve,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-blue-600 hover:text-blue-700",children:"Click para subir"})," o arrastra aquí"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Imágenes o PDF"})]})})]}),e.jsx(f,{name:"rifIdFiscal_file",component:"div",className:"text-red-500 text-sm mt-1"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold text-gray-700 mb-2",children:"Permisos de Operación:"}),t.permisoOperacion_file?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[t.permisoOperacion_file.type.includes("pdf")?e.jsx(Ce,{className:"w-6 h-6 text-red-500"}):e.jsx(R,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.permisoOperacion_file.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(t.permisoOperacion_file.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>s("permisoOperacion_file",null),className:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(U,{className:"w-5 h-5"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp,.pdf",id:"permisoOperacion-upload",className:"sr-only",onChange:a=>{var l;const o=(l=a.target.files)==null?void 0:l[0];o&&s("permisoOperacion_file",o)}}),e.jsx("label",{htmlFor:"permisoOperacion-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pt-2",children:[e.jsx(ve,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-blue-600 hover:text-blue-700",children:"Click para subir"})," o arrastra aquí"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Imágenes o PDF"})]})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block font-semibold text-gray-700 mb-2",children:"Logotipo Negocio:"}),t.logotipoNegocio_file?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(R,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.logotipoNegocio_file.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(t.logotipoNegocio_file.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>s("logotipoNegocio_file",null),className:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(U,{className:"w-5 h-5"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",id:"logotipoNegocio-upload",className:"sr-only",onChange:a=>{var l;const o=(l=a.target.files)==null?void 0:l[0];o&&s("logotipoNegocio_file",o)}}),e.jsx("label",{htmlFor:"logotipoNegocio-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pt-2",children:[e.jsx(R,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-blue-600 hover:text-blue-700",children:"Click para subir"})," o arrastra aquí"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Solo imágenes"})]})})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block font-semibold text-gray-700 mb-2",children:["Foto Frente Taller: ",e.jsx("span",{className:"text-red-500",children:"*"})]}),t.fotoFrenteTaller_file?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(R,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.fotoFrenteTaller_file.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(t.fotoFrenteTaller_file.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>s("fotoFrenteTaller_file",null),className:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(U,{className:"w-5 h-5"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",id:"fotoFrenteTaller-upload",className:"sr-only",onChange:a=>{var l;const o=(l=a.target.files)==null?void 0:l[0];o&&s("fotoFrenteTaller_file",o)}}),e.jsx("label",{htmlFor:"fotoFrenteTaller-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pt-2",children:[e.jsx(ce,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-blue-600 hover:text-blue-700",children:"Click para subir"})," o arrastra aquí"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Solo imágenes"})]})})]}),e.jsx(f,{name:"fotoFrenteTaller_file",component:"div",className:"text-red-500 text-sm mt-1"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsxs("label",{className:"block font-semibold text-gray-700 mb-2",children:["Foto Interna Taller: ",e.jsx("span",{className:"text-red-500",children:"*"})]}),t.fotoInternaTaller_file?e.jsxs("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 flex-1",children:[e.jsx(R,{className:"w-6 h-6 text-blue-500"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900 truncate",children:t.fotoInternaTaller_file.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[(t.fotoInternaTaller_file.size/1024).toFixed(2)," KB"]})]})]}),e.jsx("button",{type:"button",onClick:()=>s("fotoInternaTaller_file",null),className:"ml-2 p-1 text-red-500 hover:text-red-700 hover:bg-red-50 rounded transition-colors",children:e.jsx(U,{className:"w-5 h-5"})})]}):e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"file",accept:"image/jpeg,image/jpg,image/png,image/webp",id:"fotoInternaTaller-upload",className:"sr-only",onChange:a=>{var l;const o=(l=a.target.files)==null?void 0:l[0];o&&s("fotoInternaTaller_file",o)}}),e.jsx("label",{htmlFor:"fotoInternaTaller-upload",className:"flex flex-col items-center justify-center w-full h-24 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:bg-gray-50 hover:border-blue-400 transition-colors duration-200",children:e.jsxs("div",{className:"flex flex-col items-center justify-center pt-2",children:[e.jsx(ce,{className:"w-8 h-8 text-gray-400 mb-2"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("span",{className:"font-semibold text-blue-600 hover:text-blue-700",children:"Click para subir"})," o arrastra aquí"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Solo imágenes"})]})})]}),e.jsx(f,{name:"fotoInternaTaller_file",component:"div",className:"text-red-500 text-sm mt-1"})]})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Contraseña:"}),e.jsx(D,{type:"password",name:"password",className:"mt-1 p-3 border border-gray-300 rounded-lg"}),e.jsx(f,{name:"password",component:"div",className:"text-red-500"})]}),e.jsxs("label",{className:"flex flex-col",children:[e.jsx("span",{className:"font-semibold text-gray-700",children:"Confirmar Contraseña:"}),e.jsx(D,{type:"password",name:"confirmPassword",className:"mt-1 p-3 border border-gray-300 rounded-lg"}),e.jsx(f,{name:"confirmPassword",component:"div",className:"text-red-500"})]}),e.jsxs("div",{className:"text-right mt-6",children:[e.jsx(E,{variant:"default",onClick:()=>{J(!1)},className:"mr-2",children:"Cancelar"}),e.jsx(E,{type:"submit",disabled:pe,style:{backgroundColor:"#000B7E"},className:"text-white hover:opacity-80 disabled:opacity-50 disabled:cursor-not-allowed",children:pe?e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsxs("svg",{className:"animate-spin h-4 w-4 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creando..."]}):"Crear Taller"})]})]})})})]})]})},la=At;export{la as default};
